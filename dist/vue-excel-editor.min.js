var VueExcelComponent=function(e,t,o,i){'use strict';var a=Math.min,l=Math.abs,n=Math.round,r=Math.max,d=Math.floor;function u(e){return void 0===e||null===e}function A(e){return void 0!==e&&null!==e}function h(e){return!0===e}function f(e){return!1===e}function m(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e||"boolean"==typeof e}function g(e){return null!==e&&"object"==typeof e}function v(e){return ja.call(e).slice(8,-1)}function y(e){return"[object Object]"===ja.call(e)}function b(e){return"[object RegExp]"===ja.call(e)}function C(e){var t=parseFloat(e+"");return 0<=t&&d(t)===t&&isFinite(e)}function w(e){return A(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function x(e){return null==e?"":Array.isArray(e)||y(e)&&e.toString===ja?JSON.stringify(e,null,2):e+""}function k(e){var t=parseFloat(e);return isNaN(t)?e:t}function E(e,t){for(var o=Object.create(null),a=e.split(","),l=0;l<a.length;l++)o[a[l]]=!0;return t?function(e){return o[e.toLowerCase()]}:function(e){return o[e]}}function S(e,t){if(e.length){var o=e.indexOf(t);if(-1<o)return e.splice(o,1)}}function B(e,t){return Ga.call(e,t)}function T(e){var t=Object.create(null);return function(o){var i=t[o];return i||(t[o]=e(o))}}function _(e,t){t=t||0;for(var o=e.length-t,a=Array(o);o--;)a[o]=e[o+t];return a}function $(e,t){for(var o in t)e[o]=t[o];return e}function P(e){for(var t={},o=0;o<e.length;o++)e[o]&&$(t,e[o]);return t}function D(){}function F(e,t){if(e===t)return!0;var o=g(e),i=g(t);if(o&&i)try{var a=Array.isArray(e),l=Array.isArray(t);if(a&&l)return e.length===t.length&&e.every(function(o,e){return F(o,t[e])});if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(!a&&!l){var n=Object.keys(e),s=Object.keys(t);return n.length===s.length&&n.every(function(o){return F(e[o],t[o])})}return!1}catch(t){return!1}else return!(o||i)&&e+""===t+""}function z(e,t){for(var o=0;o<e.length;o++)if(F(e[o],t))return o;return-1}function L(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}function M(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function V(e,t,o,i){Object.defineProperty(e,t,{value:o,enumerable:!!i,writable:!0,configurable:!0})}function R(e){if(!nl.test(e)){var t=e.split(".");return function(e){for(var o=0;o<t.length;o++){if(!e)return;e=e[t[o]]}return e}}}function O(e){return"function"==typeof e&&/native code/.test(e.toString())}function I(e){Vl.push(e),Ml.target=e}function N(){Vl.pop(),Ml.target=Vl[Vl.length-1]}function H(e){return new Rl(void 0,void 0,void 0,e+"")}function U(e){var t=new Rl(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}function W(e){Wl=e}function Y(e,t){e.__proto__=t}function q(e,t,o){for(var a=0,n=o.length,l;a<n;a++)l=o[a],V(e,l,t[l])}function K(e,t){if(g(e)&&!(e instanceof Rl)){var o;return B(e,"__ob__")&&e.__ob__ instanceof Yl?o=e.__ob__:Wl&&!xl()&&(Array.isArray(e)||y(e))&&Object.isExtensible(e)&&!e._isVue&&(o=new Yl(e)),t&&o&&o.vmCount++,o}}function j(e,t,o,i,a){var l=new Ml,n=Object.getOwnPropertyDescriptor(e,t);if(!(n&&!1===n.configurable)){var s=n&&n.get,r=n&&n.set;(!s||r)&&2===arguments.length&&(o=e[t]);var d=!a&&K(o);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=s?s.call(e):o;return Ml.target&&(l.depend(),d&&(d.dep.depend(),Array.isArray(t)&&G(t))),t},set:function(t){var n=s?s.call(e):o;t!==n&&(t===t||n===n)&&("production"!==process.env.NODE_ENV&&i&&i(),s&&!r||(r?r.call(e,t):o=t,d=!a&&K(t),l.notify()))}})}}function X(e,t,o){if("production"!==process.env.NODE_ENV&&(u(e)||m(e))&&Tl("Cannot set reactive property on undefined, null, or primitive value: "+e),Array.isArray(e)&&C(t))return e.length=r(e.length,t),e.splice(t,1,o),o;if(t in e&&!(t in Object.prototype))return e[t]=o,o;var i=e.__ob__;return e._isVue||i&&i.vmCount?("production"!==process.env.NODE_ENV&&Tl("Avoid adding reactive properties to a Vue instance or its root $data at runtime - declare it upfront in the data option."),o):i?(j(i.value,t,o),i.dep.notify(),o):(e[t]=o,o)}function Q(e,t){if("production"!==process.env.NODE_ENV&&(u(e)||m(e))&&Tl("Cannot delete reactive property on undefined, null, or primitive value: "+e),Array.isArray(e)&&C(t))return void e.splice(t,1);var o=e.__ob__;return e._isVue||o&&o.vmCount?void("production"!==process.env.NODE_ENV&&Tl("Avoid deleting properties on a Vue instance or its root $data - just set it to null.")):void(B(e,t)&&(delete e[t],o&&o.dep.notify()))}function G(t){for(var o=void 0,a=0,n=t.length;a<n;a++)o=t[a],o&&o.__ob__&&o.__ob__.dep.depend(),Array.isArray(o)&&G(o)}function J(e,t){if(!t)return e;for(var o=El?Reflect.ownKeys(t):Object.keys(t),a=0,l,n,s;a<o.length;a++)(l=o[a],"__ob__"!==l)&&(n=e[l],s=t[l],B(e,l)?n!==s&&y(n)&&y(s)&&J(n,s):X(e,l,s));return e}function Z(e,t,o){return o?function(){var i="function"==typeof t?t.call(o,o):t,a="function"==typeof e?e.call(o,o):e;return i?J(i,a):a}:t?e?function(){return J("function"==typeof t?t.call(this,this):t,"function"==typeof e?e.call(this,this):e)}:t:e}function ee(e,t){var o=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return o?te(o):o}function te(e){for(var t=[],o=0;o<e.length;o++)-1===t.indexOf(e[o])&&t.push(e[o]);return t}function oe(e,t,o,i){var a=Object.create(e||null);return t?("production"!==process.env.NODE_ENV&&re(i,t,o),$(a,t)):a}function ie(e){for(var t in e.components)ae(t)}function ae(e){new RegExp("^[a-zA-Z][\\-\\.0-9_"+ll.source+"]*$").test(e)||Tl("Invalid component name: \""+e+"\". Component names should conform to valid custom element name in html5 specification."),(Xa(e)||al.isReservedTag(e))&&Tl("Do not use built-in or reserved HTML elements as component id: "+e)}function le(e,t){var o=e.props;if(o){var a={},l,n,s;if(Array.isArray(o))for(l=o.length;l--;)n=o[l],"string"==typeof n?(s=Ja(n),a[s]={type:null}):"production"!==process.env.NODE_ENV&&Tl("props must be strings when using array syntax.");else if(y(o))for(var r in o)n=o[r],s=Ja(r),a[s]=y(n)?n:{type:n};else"production"!==process.env.NODE_ENV&&Tl("Invalid value for option \"props\": expected an Array or an Object, but got "+v(o)+".",t);e.props=a}}function ne(e,t){var o=e.inject;if(o){var a=e.inject={};if(Array.isArray(o))for(var l=0;l<o.length;l++)a[o[l]]={from:o[l]};else if(y(o))for(var n in o){var s=o[n];a[n]=y(s)?$({from:n},s):{from:s}}else"production"!==process.env.NODE_ENV&&Tl("Invalid value for option \"inject\": expected an Array or an Object, but got "+v(o)+".",t)}}function se(e){var t=e.directives;if(t)for(var o in t){var i=t[o];"function"==typeof i&&(t[o]={bind:i,update:i})}}function re(e,t,o){y(t)||Tl("Invalid value for option \""+e+"\": expected an Object, but got "+v(t)+".",o)}function de(e,t,o){function a(i){var a=ql[i]||Kl;l[i]=a(e[i],t[i],o,i)}if("production"!==process.env.NODE_ENV&&ie(t),"function"==typeof t&&(t=t.options),le(t,o),ne(t,o),se(t),!t._base&&(t.extends&&(e=de(e,t.extends,o)),t.mixins))for(var n=0,s=t.mixins.length;n<s;n++)e=de(e,t.mixins[n],o);var l={},r;for(r in e)a(r);for(r in t)B(e,r)||a(r);return l}function ce(e,t,o,i){if("string"==typeof o){var a=e[t];if(B(a,o))return a[o];var l=Ja(o);if(B(a,l))return a[l];var n=Za(l);if(B(a,n))return a[n];var s=a[o]||a[l]||a[n];return"production"!==process.env.NODE_ENV&&i&&!s&&Tl("Failed to resolve "+t.slice(0,-1)+": "+o,e),s}}function pe(e,t,o,i){var a=t[e],l=!B(o,e),n=o[e],s=ge(Boolean,a.type);if(-1<s)if(l&&!B(a,"default"))n=!1;else if(""===n||n===tl(e)){var r=ge(String,a.type);(0>r||s<r)&&(n=!0)}if(void 0===n){n=ue(i,a,e);var d=Wl;W(!0),K(n),W(d)}return"production"===process.env.NODE_ENV||!1||Ae(a,e,n,i,l),n}function ue(e,t,o){if(B(t,"default")){var i=t.default;return"production"!==process.env.NODE_ENV&&g(i)&&Tl("Invalid default value for prop \""+o+"\": Props with type Object/Array must use a factory function to return the default value.",e),e&&e.$options.propsData&&void 0===e.$options.propsData[o]&&void 0!==e._props[o]?e._props[o]:"function"==typeof i&&"Function"!==fe(t.type)?i.call(e):i}}function Ae(e,t,o,a,l){if(e.required&&l)return void Tl("Missing required prop: \""+t+"\"",a);if(null!=o||e.required){var n=e.type,s=!n||!0===n,r=[];if(n){Array.isArray(n)||(n=[n]);for(var d=0,c;d<n.length&&!s;d++)c=he(o,n[d],a),r.push(c.expectedType||""),s=c.valid}var p=r.some(function(e){return e});if(!s&&p)return void Tl(ve(t,o,r),a);var u=e.validator;u&&!u(o)&&Tl("Invalid prop: custom validator check failed for prop \""+t+"\".",a)}}function he(e,o,i){var a=fe(o),l;if(jl.test(a)){var n=typeof e;l=n===a.toLowerCase(),l||"object"!==n||(l=e instanceof o)}else if("Object"===a)l=y(e);else if("Array"===a)l=Array.isArray(e);else try{l=e instanceof o}catch(t){Tl("Invalid prop type: \""+(o+"\" is not a constructor"),i),l=!1}return{valid:l,expectedType:a}}function fe(e){var t=e&&e.toString().match(Xl);return t?t[1]:""}function me(e,t){return fe(e)===fe(t)}function ge(e,t){if(!Array.isArray(t))return me(t,e)?0:-1;for(var o=0,a=t.length;o<a;o++)if(me(t[o],e))return o;return-1}function ve(e,t,o){var i="Invalid prop: type check failed for prop \""+e+"\". Expected "+o.map(Za).join(", "),a=o[0],l=v(t);return 1===o.length&&be(a)&&be(typeof t)&&!Ce(a,l)&&(i+=" with value "+ye(t,a)),i+=", got "+l+" ",be(l)&&(i+="with value "+ye(t,l)+"."),i}function ye(e,t){return"String"===t?"\""+e+"\"":"Number"===t?""+ +e:""+e}function be(e){return Ql.some(function(t){return e.toLowerCase()===t})}function Ce(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return e.some(function(e){return"boolean"===e.toLowerCase()})}function we(e,t,o){I();try{if(t)for(var a=t,l;a=a.$parent;)if(l=a.$options.errorCaptured,l)for(var n=0;n<l.length;n++)try{var s=!1===l[n].call(a,e,t,o);if(s)return}catch(t){ke(t,a,"errorCaptured hook")}ke(e,t,o)}finally{N()}}function xe(e,t,o,i,a){var l;try{l=o?e.apply(t,o):e.call(t),l&&!l._isVue&&w(l)&&!l._handled&&(l.catch(function(t){return we(t,i,a+" (Promise/async)")}),l._handled=!0)}catch(t){we(t,i,a)}return l}function ke(t,o,e){if(al.errorHandler)try{return al.errorHandler.call(null,t,o,e)}catch(o){o!==t&&Ee(o,null,"config.errorHandler")}Ee(t,o,e)}function Ee(e,t,o){if("production"!==process.env.NODE_ENV&&Tl("Error in "+o+": \""+e.toString()+"\"",t),(rl||dl)&&"undefined"!=typeof console)console.error(e);else throw e}function Se(){Zl=!1;var e=Jl.slice(0);Jl.length=0;for(var t=0;t<e.length;t++)e[t]()}function Be(e,t){var o;if(Jl.push(function(){if(e)try{e.call(t)}catch(o){we(o,t,"nextTick")}else o&&o(t)}),Zl||(Zl=!0,tn()),!e&&"undefined"!=typeof Promise)return new Promise(function(e){o=e})}function Te(e){_e(e,An),An.clear()}function _e(e,t){var o=Array.isArray(e),a,l;if((o||g(e))&&!Object.isFrozen(e)&&!(e instanceof Rl)){if(e.__ob__){var n=e.__ob__.dep.id;if(t.has(n))return;t.add(n)}if(o)for(a=e.length;a--;)_e(e[a],t);else for(l=Object.keys(e),a=l.length;a--;)_e(e[l[a]],t)}}function $e(e,t){function o(){var e=arguments,a=o.fns;if(Array.isArray(a))for(var l=a.slice(),n=0;n<l.length;n++)xe(l[n],null,e,t,"v-on handler");else return xe(a,null,arguments,t,"v-on handler")}return o.fns=e,o}function Pe(e,t,o,i,a,l){var n,s,r,d,c;for(n in e)s=r=e[n],d=t[n],c=gn(n),u(r)?"production"!==process.env.NODE_ENV&&Tl("Invalid handler for event \""+c.name+"\": got "+(r+""),l):u(d)?(u(r.fns)&&(r=e[n]=$e(r,l)),h(c.once)&&(r=e[n]=a(c.name,r,c.capture)),o(c.name,r,c.capture,c.passive,c.params)):r!==d&&(d.fns=r,e[n]=d);for(n in t)u(e[n])&&(c=gn(n),i(c.name,t[n],c.capture))}function De(e,t,o){function i(){o.apply(this,arguments),S(l.fns,i)}e instanceof Rl&&(e=e.data.hook||(e.data.hook={}));var a=e[t],l;u(a)?l=$e([i]):A(a.fns)&&h(a.merged)?(l=a,l.fns.push(i)):l=$e([a,i]),l.merged=!0,e[t]=l}function Fe(e,t,o){var i=t.options.props;if(!u(i)){var a={},l=e.attrs,n=e.props;if(A(l)||A(n))for(var s in i){var r=tl(s);if("production"!==process.env.NODE_ENV){var d=s.toLowerCase();s!==d&&l&&B(l,d)&&_l("Prop \""+d+"\" is passed to component "+Pl(o||t)+", but the declared prop name is \""+s+"\". Note that HTML attributes are case-insensitive and camelCased props need to use their kebab-case equivalents when using in-DOM templates. You should probably use \""+r+"\" instead of \""+s+"\".")}ze(a,n,s,r,!0)||ze(a,l,s,r,!1)}return a}}function ze(e,t,o,i,a){if(A(t)){if(B(t,o))return e[o]=t[o],a||delete t[o],!0;if(B(t,i))return e[o]=t[i],a||delete t[i],!0}return!1}function Le(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}function Me(e){return m(e)?[H(e)]:Array.isArray(e)?Re(e):void 0}function Ve(e){return A(e)&&A(e.text)&&f(e.isComment)}function Re(e,t){var o=[],a,l,n,s;for(a=0;a<e.length;a++)(l=e[a],!(u(l)||"boolean"==typeof l))&&(n=o.length-1,s=o[n],Array.isArray(l)?0<l.length&&(l=Re(l,(t||"")+"_"+a),Ve(l[0])&&Ve(s)&&(o[n]=H(s.text+l[0].text),l.shift()),o.push.apply(o,l)):m(l)?Ve(s)?o[n]=H(s.text+l):""!==l&&o.push(H(l)):Ve(l)&&Ve(s)?o[n]=H(s.text+l.text):(h(e._isVList)&&A(l.tag)&&u(l.key)&&A(t)&&(l.key="__vlist"+t+"_"+a+"__"),o.push(l)));return o}function Oe(e){var t=e.$options.provide;t&&(e._provided="function"==typeof t?t.call(e):t)}function Ie(e){var t=Ne(e.$options.inject,e);t&&(W(!1),Object.keys(t).forEach(function(o){"production"===process.env.NODE_ENV?j(e,o,t[o]):j(e,o,t[o],function(){Tl("Avoid mutating an injected value directly since the changes will be overwritten whenever the provided component re-renders. injection being mutated: \""+o+"\"",e)})}),W(!0))}function Ne(e,t){if(e){for(var o=Object.create(null),a=El?Reflect.ownKeys(e):Object.keys(e),l=0,n;l<a.length;l++)if(n=a[l],"__ob__"!==n){for(var s=e[n].from,r=t;r;){if(r._provided&&B(r._provided,s)){o[n]=r._provided[s];break}r=r.$parent}if(!r)if("default"in e[n]){var d=e[n].default;o[n]="function"==typeof d?d.call(t):d}else"production"!==process.env.NODE_ENV&&Tl("Injection \""+n+"\" not found",t)}return o}}function He(e,t){if(!e||!e.length)return{};for(var o={},a=0,n=e.length;a<n;a++){var l=e[a],s=l.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,(l.context===t||l.fnContext===t)&&s&&null!=s.slot){var r=s.slot,d=o[r]||(o[r]=[]);"template"===l.tag?d.push.apply(d,l.children||[]):d.push(l)}else(o.default||(o.default=[])).push(l)}for(var c in o)o[c].every(Ue)&&delete o[c];return o}function Ue(e){return e.isComment&&!e.asyncFactory||" "===e.text}function We(e){return e.isComment&&e.asyncFactory}function Ye(e,t,o){var i=0<Object.keys(t).length,a=e?!!e.$stable:!i,l=e&&e.$key,n;if(!e)n={};else{if(e._normalized)return e._normalized;if(a&&o&&o!==Ka&&l===o.$key&&!i&&!o.$hasNormal)return o;for(var s in n={},e)e[s]&&"$"!==s[0]&&(n[s]=qe(t,s,e[s]))}for(var r in t)r in n||(n[r]=Ke(t,r));return e&&Object.isExtensible(e)&&(e._normalized=n),V(n,"$stable",a),V(n,"$key",l),V(n,"$hasNormal",i),n}function qe(e,t,o){var i=function(){var e=arguments.length?o.apply(null,arguments):o({});e=e&&"object"==typeof e&&!Array.isArray(e)?[e]:Me(e);var t=e&&e[0];return e&&(!t||1===e.length&&t.isComment&&!We(t))?void 0:e};return o.proxy&&Object.defineProperty(e,t,{get:i,enumerable:!0,configurable:!0}),i}function Ke(e,t){return function(){return e[t]}}function je(e,t){var o,a,n,s,r;if(Array.isArray(e)||"string"==typeof e)for(o=Array(e.length),a=0,n=e.length;a<n;a++)o[a]=t(e[a],a);else if("number"==typeof e)for(o=Array(e),a=0;a<e;a++)o[a]=t(a+1,a);else if(g(e))if(El&&e[Symbol.iterator]){o=[];for(var d=e[Symbol.iterator](),c=d.next();!c.done;)o.push(t(c.value,o.length)),c=d.next()}else for(s=Object.keys(e),o=Array(s.length),(a=0,n=s.length);a<n;a++)r=s[a],o[a]=t(e[r],r,a);return A(o)||(o=[]),o._isVList=!0,o}function Xe(e,t,o,i){var a=this.$scopedSlots[e],l;a?(o=o||{},i&&("production"!==process.env.NODE_ENV&&!g(i)&&Tl("slot v-bind without argument expects an Object",this),o=$($({},i),o)),l=a(o)||("function"==typeof t?t():t)):l=this.$slots[e]||("function"==typeof t?t():t);var n=o&&o.slot;return n?this.$createElement("template",{slot:n},l):l}function Qe(e){return ce(this.$options,"filters",e,!0)||s}function Ge(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Je(e,t,o,i,a){var l=al.keyCodes[t]||o;return a&&i&&!al.keyCodes[t]?Ge(a,i):l?Ge(l,e):i?tl(i)!==t:void 0===e}function Ze(e,t,o,i,a){if(o)if(!g(o))"production"!==process.env.NODE_ENV&&Tl("v-bind without argument expects an Object or Array value",this);else{Array.isArray(o)&&(o=P(o));var l=function(l){if("class"===l||"style"===l||Qa(l))n=e;else{var s=e.attrs&&e.attrs.type;n=i||al.mustUseProp(t,s,l)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var r=Ja(l),d=tl(l);if(!(r in n)&&!(d in n)&&(n[l]=o[l],a)){var c=e.on||(e.on={});c["update:"+l]=function(e){o[l]=e}}},n;for(var s in o)l(s)}return e}function et(e,t){var o=this._staticTrees||(this._staticTrees=[]),i=o[e];return i&&!t?i:(i=o[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),ot(i,"__static__"+e,!1),i)}function tt(e,t,o){return ot(e,"__once__"+t+(o?"_"+o:""),!0),e}function ot(e,t,o){if(Array.isArray(e))for(var a=0;a<e.length;a++)e[a]&&"string"!=typeof e[a]&&it(e[a],t+"_"+a,o);else it(e,t,o)}function it(e,t,o){e.isStatic=!0,e.key=t,e.isOnce=o}function at(e,t){if(t)if(!y(t))"production"!==process.env.NODE_ENV&&Tl("v-on without argument expects an Object value",this);else{var o=e.on=e.on?$({},e.on):{};for(var i in t){var a=o[i],l=t[i];o[i]=a?[].concat(a,l):l}}return e}function lt(e,t,o,a){t=t||{$stable:!o};for(var l=0,n;l<e.length;l++)n=e[l],Array.isArray(n)?lt(n,t,o):n&&(n.proxy&&(n.fn.proxy=!0),t[n.key]=n.fn);return a&&(t.$key=a),t}function nt(e,t){for(var o=0,a;o<t.length;o+=2)a=t[o],"string"==typeof a&&a?e[t[o]]=t[o+1]:"production"!==process.env.NODE_ENV&&""!=a&&null!==a&&Tl("Invalid value for dynamic directive argument (expected string or null): "+a,this);return e}function st(e,t){return"string"==typeof e?t+e:e}function rt(e){e._o=tt,e._n=k,e._s=x,e._l=je,e._t=Xe,e._q=F,e._i=z,e._m=et,e._f=Qe,e._k=Je,e._b=Ze,e._v=H,e._e=Il,e._u=lt,e._g=at,e._d=nt,e._p=st}function dt(e,t,o,i,a){var l=this,n=a.options,s;B(i,"_uid")?(s=Object.create(i),s._original=i):(s=i,i=i._original);var r=h(n._compiled),p=!r;this.data=e,this.props=t,this.children=o,this.parent=i,this.listeners=e.on||Ka,this.injections=Ne(n.inject,i),this.slots=function(){return l.$slots||Ye(e.scopedSlots,l.$slots=He(o,i)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Ye(e.scopedSlots,this.slots())}}),r&&(this.$options=n,this.$slots=this.slots(),this.$scopedSlots=Ye(e.scopedSlots,this.$slots)),this._c=n._scopeId?function(e,t,o,a){var l=vt(s,e,t,o,a,p);return l&&!Array.isArray(l)&&(l.fnScopeId=n._scopeId,l.fnContext=i),l}:function(e,t,o,i){return vt(s,e,t,o,i,p)}}function ct(e,t,o,a,l){var n=e.options,s={},r=n.props;if(A(r))for(var d in r)s[d]=pe(d,r,t||Ka);else A(o.attrs)&&ut(s,o.attrs),A(o.props)&&ut(s,o.props);var c=new dt(o,s,l,a,e),p=n.render.call(null,c._c,c);if(p instanceof Rl)return pt(p,o,c.parent,n,c);if(Array.isArray(p)){for(var u=Me(p)||[],h=Array(u.length),f=0;f<u.length;f++)h[f]=pt(u[f],o,c.parent,n,c);return h}}function pt(e,t,o,i,a){var l=U(e);return l.fnContext=o,l.fnOptions=i,"production"!==process.env.NODE_ENV&&((l.devtoolsMeta=l.devtoolsMeta||{}).renderContext=a),t.slot&&((l.data||(l.data={})).slot=t.slot),l}function ut(e,t){for(var o in t)e[Ja(o)]=t[o]}function At(e,t,o,i,a){if(!u(e)){var l=o.$options._base;if(g(e)&&(e=l.extend(e)),"function"!=typeof e)return void("production"!==process.env.NODE_ENV&&Tl("Invalid Component definition: "+(e+""),o));var n;if(u(e.cid)&&(n=e,e=Et(n,l),void 0===e))return kt(n,t,o,i,a);t=t||{},lo(e),A(t.model)&&gt(e.options,t);var s=Fe(t,e,a);if(h(e.options.functional))return ct(e,s,t,o,i);var r=t.on;if(t.on=t.nativeOn,h(e.options.abstract)){var d=t.slot;t={},d&&(t.slot=d)}ft(t);var c=e.options.name||a,p=new Rl("vue-component-"+e.cid+(c?"-"+c:""),t,void 0,void 0,void 0,o,{Ctor:e,propsData:s,listeners:r,tag:a,children:i},n);return p}}function ht(e,t){var o={_isComponent:!0,_parentVnode:e,parent:t},i=e.data.inlineTemplate;return A(i)&&(o.render=i.render,o.staticRenderFns=i.staticRenderFns),new e.componentOptions.Ctor(o)}function ft(e){for(var t=e.hook||(e.hook={}),o=0;o<yn.length;o++){var a=yn[o],l=t[a],n=vn[a];l===n||l&&l._merged||(t[a]=l?mt(n,l):n)}}function mt(e,t){var o=function(o,i){e(o,i),t(o,i)};return o._merged=!0,o}function gt(e,t){var o=e.model&&e.model.prop||"value",i=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[o]=t.model.value;var a=t.on||(t.on={}),l=a[i],n=t.model.callback;A(l)?(Array.isArray(l)?-1===l.indexOf(n):l!==n)&&(a[i]=[n].concat(l)):a[i]=n}function vt(e,t,o,i,a,l){return(Array.isArray(o)||m(o))&&(a=i,i=o,o=void 0),h(l)&&(a=2),yt(e,t,o,i,a)}function yt(e,t,o,i,a){if(A(o)&&A(o.__ob__))return"production"!==process.env.NODE_ENV&&Tl("Avoid using observed data object as vnode data: "+JSON.stringify(o)+"\nAlways create fresh vnode data objects in each render!",e),Il();if(A(o)&&A(o.is)&&(t=o.is),!t)return Il();"production"!==process.env.NODE_ENV&&A(o)&&A(o.key)&&!m(o.key)&&Tl("Avoid using non-primitive value as key, use string/number value instead.",e),Array.isArray(i)&&"function"==typeof i[0]&&(o=o||{},o.scopedSlots={default:i[0]},i.length=0),2===a?i=Me(i):1===a&&(i=Le(i));var l,n;if("string"==typeof t){var s;n=e.$vnode&&e.$vnode.ns||al.getTagNamespace(t),al.isReservedTag(t)?("production"!==process.env.NODE_ENV&&A(o)&&A(o.nativeOn)&&"component"!==o.tag&&Tl("The .native modifier for v-on is only valid on components but it was used on <"+t+">.",e),l=new Rl(al.parsePlatformTagName(t),o,i,void 0,void 0,e)):o&&o.pre||!A(s=ce(e.$options,"components",t))?l=new Rl(t,o,i,void 0,void 0,e):l=At(s,o,e,i,t)}else l=At(t,o,e,i);return Array.isArray(l)?l:A(l)?(A(n)&&bt(l,n),A(o)&&Ct(o),l):Il()}function bt(e,t,o){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,o=!0),A(e.children))for(var a=0,n=e.children.length,l;a<n;a++)l=e.children[a],A(l.tag)&&(u(l.ns)||h(o)&&"svg"!==l.tag)&&bt(l,t,o)}function Ct(e){g(e.style)&&Te(e.style),g(e.class)&&Te(e.class)}function wt(e){e._vnode=null,e._staticTrees=null;var t=e.$options,o=e.$vnode=t._parentVnode,i=o&&o.context;e.$slots=He(t._renderChildren,i),e.$scopedSlots=Ka,e._c=function(t,o,i,a){return vt(e,t,o,i,a,!1)},e.$createElement=function(t,o,i,a){return vt(e,t,o,i,a,!0)};var a=o&&o.data;"production"===process.env.NODE_ENV?(j(e,"$attrs",a&&a.attrs||Ka,null,!0),j(e,"$listeners",t._parentListeners||Ka,null,!0)):(j(e,"$attrs",a&&a.attrs||Ka,function(){wn||Tl("$attrs is readonly.",e)},!0),j(e,"$listeners",t._parentListeners||Ka,function(){wn||Tl("$listeners is readonly.",e)},!0))}function xt(e,t){return(e.__esModule||El&&"Module"===e[Symbol.toStringTag])&&(e=e.default),g(e)?t.extend(e):e}function kt(e,t,o,i,a){var l=Il();return l.asyncFactory=e,l.asyncMeta={data:t,context:o,children:i,tag:a},l}function Et(e,t){if(h(e.error)&&A(e.errorComp))return e.errorComp;if(A(e.resolved))return e.resolved;var o=bn;if(o&&A(e.owners)&&-1===e.owners.indexOf(o)&&e.owners.push(o),h(e.loading)&&A(e.loadingComp))return e.loadingComp;if(o&&!A(e.owners)){var a=e.owners=[o],l=!0,n=null,s=null;o.$on("hook:destroyed",function(){return S(a,o)});var r=function(e){for(var t=0,o=a.length;t<o;t++)a[t].$forceUpdate();e&&(a.length=0,null!==n&&(clearTimeout(n),n=null),null!==s&&(clearTimeout(s),s=null))},d=L(function(o){e.resolved=xt(o,t),l?a.length=0:r(!0)}),c=L(function(t){"production"!==process.env.NODE_ENV&&Tl("Failed to resolve async component: "+(e+"")+(t?"\nReason: "+t:"")),A(e.errorComp)&&(e.error=!0,r(!0))}),p=e(d,c);return g(p)&&(w(p)?u(e.resolved)&&p.then(d,c):w(p.component)&&(p.component.then(d,c),A(p.error)&&(e.errorComp=xt(p.error,t)),A(p.loading)&&(e.loadingComp=xt(p.loading,t),0===p.delay?e.loading=!0:n=setTimeout(function(){n=null,u(e.resolved)&&u(e.error)&&(e.loading=!0,r(!1))},p.delay||200)),A(p.timeout)&&(s=setTimeout(function(){s=null,u(e.resolved)&&c("production"===process.env.NODE_ENV?null:"timeout ("+p.timeout+"ms)")},p.timeout)))),l=!1,e.loading?e.loadingComp:e.resolved}}function St(e){if(Array.isArray(e))for(var t=0,o;t<e.length;t++)if(o=e[t],A(o)&&(A(o.componentOptions)||We(o)))return o}function Bt(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&Pt(e,t)}function Tt(e,t){Dn.$on(e,t)}function _t(e,t){Dn.$off(e,t)}function $t(e,t){var o=Dn;return function i(){var a=t.apply(null,arguments);null!==a&&o.$off(e,i)}}function Pt(e,t,o){Dn=e,Pe(t,o||{},Tt,_t,$t,e),Dn=void 0}function Dt(e){var t=Cn;return Cn=e,function(){Cn=t}}function Ft(e){var t=e.$options,o=t.parent;if(o&&!t.abstract){for(;o.$options.abstract&&o.$parent;)o=o.$parent;o.$children.push(e)}e.$parent=o,e.$root=o?o.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function zt(e,t,o){e.$el=t,e.$options.render||(e.$options.render=Il,"production"!==process.env.NODE_ENV&&(e.$options.template&&"#"!==e.$options.template.charAt(0)||e.$options.el||t?Tl("You are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.",e):Tl("Failed to mount component: template or render function not defined.",e))),Ot(e,"beforeMount");var i;return i="production"!==process.env.NODE_ENV&&al.performance&&hn?function(){var t=e._name,i=e._uid,a="vue-perf-start:"+i,l="vue-perf-end:"+i;hn(a);var n=e._render();hn(l),fn("vue "+t+" render",a,l),hn(a),e._update(n,o),hn(l),fn("vue "+t+" patch",a,l)}:function(){e._update(e._render(),o)},new Ln(e,i,D,{before:function(){e._isMounted&&!e._isDestroyed&&Ot(e,"beforeUpdate")}},!0),o=!1,null==e.$vnode&&(e._isMounted=!0,Ot(e,"mounted")),e}function Lt(e,t,o,a,l){"production"!==process.env.NODE_ENV&&(wn=!0);var n=a.data.scopedSlots,s=e.$scopedSlots,r=n&&!n.$stable||s!==Ka&&!s.$stable||n&&e.$scopedSlots.$key!==n.$key||!n&&e.$scopedSlots.$key,d=!!(l||e.$options._renderChildren||r);if(e.$options._parentVnode=a,e.$vnode=a,e._vnode&&(e._vnode.parent=a),e.$options._renderChildren=l,e.$attrs=a.data.attrs||Ka,e.$listeners=o||Ka,t&&e.$options.props){W(!1);for(var c=e._props,p=e.$options._propKeys||[],u=0;u<p.length;u++){var A=p[u],h=e.$options.props;c[A]=pe(A,h,t,e)}W(!0),e.$options.propsData=t}o=o||Ka;var f=e.$options._parentListeners;e.$options._parentListeners=o,Pt(e,o,f),d&&(e.$slots=He(l,a.context),e.$forceUpdate()),"production"!==process.env.NODE_ENV&&(wn=!1)}function Mt(e){for(;e&&(e=e.$parent);)if(e._inactive)return!0;return!1}function Vt(e,t){if(t){if(e._directInactive=!1,Mt(e))return;}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var o=0;o<e.$children.length;o++)Vt(e.$children[o]);Ot(e,"activated")}}function Rt(e,t){if(!(t&&(e._directInactive=!0,Mt(e)))&&!e._inactive){e._inactive=!0;for(var o=0;o<e.$children.length;o++)Rt(e.$children[o]);Ot(e,"deactivated")}}function Ot(e,t){I();var o=e.$options[t];if(o)for(var a=0,l=o.length;a<l;a++)xe(o[a],e,null,e,t+" hook");e._hasHookEvent&&e.$emit("hook:"+t),N()}function It(){_n=xn.length=kn.length=0,En={},"production"!==process.env.NODE_ENV&&(Sn={}),Bn=Tn=!1}function Nt(){$n=Pn(),Tn=!0;var e,t;for(xn.sort(function(e,t){return e.id-t.id}),_n=0;_n<xn.length;_n++)if(e=xn[_n],e.before&&e.before(),t=e.id,En[t]=null,e.run(),"production"!==process.env.NODE_ENV&&null!=En[t]&&(Sn[t]=(Sn[t]||0)+1,100<Sn[t])){Tl("You may have an infinite update loop "+(e.user?"in watcher with expression \""+e.expression+"\"":"in a component render function."),e.vm);break}var o=kn.slice(),i=xn.slice();It(),Wt(o),Ht(i),kl&&al.devtools&&kl.emit("flush")}function Ht(e){for(var t=e.length;t--;){var o=e[t],a=o.vm;a._watcher===o&&a._isMounted&&!a._isDestroyed&&Ot(a,"updated")}}function Ut(e){e._inactive=!1,kn.push(e)}function Wt(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,Vt(e[t],!0)}function Yt(e){var t=e.id;if(null==En[t]){if(En[t]=!0,!Tn)xn.push(e);else{for(var o=xn.length-1;o>_n&&xn[o].id>e.id;)o--;xn.splice(o+1,0,e)}if(!Bn){if(Bn=!0,"production"!==process.env.NODE_ENV&&!al.async)return void Nt();Be(Nt)}}}function qt(e,t,o){Mn.get=function(){return this[t][o]},Mn.set=function(e){this[t][o]=e},Object.defineProperty(e,o,Mn)}function Kt(e){e._watchers=[];var t=e.$options;t.props&&jt(e,t.props),t.methods&&to(e,t.methods),t.data?Xt(e):K(e._data={},!0),t.computed&&Gt(e,t.computed),t.watch&&t.watch!==bl&&oo(e,t.watch)}function jt(e,t){var o=e.$options.propsData||{},i=e._props={},a=e.$options._propKeys=[],l=!e.$parent;l||W(!1);var n=function(n){a.push(n);var s=pe(n,t,o,e);if("production"!==process.env.NODE_ENV){var r=tl(n);(Qa(r)||al.isReservedAttr(r))&&Tl("\""+r+"\" is a reserved attribute and cannot be used as component prop.",e),j(i,n,s,function(){l||wn||Tl("Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the prop's value. Prop being mutated: \""+n+"\"",e)})}else j(i,n,s);n in e||qt(e,"_props",n)};for(var s in t)n(s);W(!0)}function Xt(e){var t=e.$options.data;t=e._data="function"==typeof t?Qt(t,e):t||{},y(t)||(t={},"production"!==process.env.NODE_ENV&&Tl("data functions should return an object:\nhttps://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function",e));for(var o=Object.keys(t),a=e.$options.props,l=e.$options.methods,n=o.length,s;n--;)s=o[n],"production"!==process.env.NODE_ENV&&l&&B(l,s)&&Tl("Method \""+s+"\" has already been defined as a data property.",e),a&&B(a,s)?"production"!==process.env.NODE_ENV&&Tl("The data property \""+s+"\" is already declared as a prop. Use prop default value instead.",e):!M(s)&&qt(e,"_data",s);K(t,!0)}function Qt(e,t){I();try{return e.call(t,t)}catch(o){return we(o,t,"data()"),{}}finally{N()}}function Gt(e,t){var o=e._computedWatchers=Object.create(null),i=xl();for(var a in t){var l=t[a],n="function"==typeof l?l:l.get;"production"!==process.env.NODE_ENV&&null==n&&Tl("Getter is missing for computed property \""+a+"\".",e),i||(o[a]=new Ln(e,n||D,D,Vn)),a in e?"production"!==process.env.NODE_ENV&&(a in e.$data?Tl("The computed property \""+a+"\" is already defined in data.",e):e.$options.props&&a in e.$options.props?Tl("The computed property \""+a+"\" is already defined as a prop.",e):e.$options.methods&&a in e.$options.methods&&Tl("The computed property \""+a+"\" is already defined as a method.",e)):Jt(e,a,l)}}function Jt(e,t,o){var i=!xl();"function"==typeof o?(Mn.get=i?Zt(t):eo(o),Mn.set=D):(Mn.get=o.get?i&&!1!==o.cache?Zt(t):eo(o.get):D,Mn.set=o.set||D),"production"!==process.env.NODE_ENV&&Mn.set===D&&(Mn.set=function(){Tl("Computed property \""+t+"\" was assigned to but it has no setter.",this)}),Object.defineProperty(e,t,Mn)}function Zt(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),Ml.target&&t.depend(),t.value}}function eo(e){return function(){return e.call(this,this)}}function to(e,t){var o=e.$options.props;for(var i in t)"production"!==process.env.NODE_ENV&&("function"!=typeof t[i]&&Tl("Method \""+i+"\" has type \""+typeof t[i]+"\" in the component definition. Did you reference the function correctly?",e),o&&B(o,i)&&Tl("Method \""+i+"\" has already been defined as a prop.",e),i in e&&M(i)&&Tl("Method \""+i+"\" conflicts with an existing Vue instance method. Avoid defining component methods that start with _ or $.")),e[i]="function"==typeof t[i]?ol(t[i],e):D}function oo(e,t){for(var o in t){var a=t[o];if(Array.isArray(a))for(var l=0;l<a.length;l++)io(e,o,a[l]);else io(e,o,a)}}function io(e,t,o,i){return y(o)&&(i=o,o=o.handler),"string"==typeof o&&(o=e[o]),e.$watch(t,o,i)}function ao(e,t){var o=e.$options=Object.create(e.constructor.options),i=t._parentVnode;o.parent=t.parent,o._parentVnode=i;var a=i.componentOptions;o.propsData=a.propsData,o._parentListeners=a.listeners,o._renderChildren=a.children,o._componentTag=a.tag,t.render&&(o.render=t.render,o.staticRenderFns=t.staticRenderFns)}function lo(e){var t=e.options;if(e.super){var o=lo(e.super),i=e.superOptions;if(o!==i){e.superOptions=o;var a=so(e);a&&$(e.extendOptions,a),t=e.options=de(o,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function so(e){var t=e.options,o=e.sealedOptions,i;for(var a in t)t[a]!==o[a]&&(i||(i={}),i[a]=t[a]);return i}function ro(e){"production"===process.env.NODE_ENV||this instanceof ro||Tl("Vue is a constructor and should be called with the `new` keyword"),this._init(e)}function co(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(-1<t.indexOf(e))return this;var o=_(arguments,1);return o.unshift(this),"function"==typeof e.install?e.install.apply(e,o):"function"==typeof e&&e.apply(null,o),t.push(e),this}}function po(e){e.mixin=function(e){return this.options=de(this.options,e),this}}function uo(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var o=this,i=o.cid,a=e._Ctor||(e._Ctor={});if(a[i])return a[i];var l=e.name||o.options.name;"production"!==process.env.NODE_ENV&&l&&ae(l);var n=function(e){this._init(e)};return n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.cid=t++,n.options=de(o.options,e),n["super"]=o,n.options.props&&Ao(n),n.options.computed&&ho(n),n.extend=o.extend,n.mixin=o.mixin,n.use=o.use,c.forEach(function(e){n[e]=o[e]}),l&&(n.options.components[l]=n),n.superOptions=o.options,n.extendOptions=e,n.sealedOptions=$({},n.options),a[i]=n,n}}function Ao(e){var t=e.options.props;for(var o in t)qt(e.prototype,"_props",o)}function ho(e){var t=e.options.computed;for(var o in t)Jt(e.prototype,o,t[o])}function fo(e){c.forEach(function(t){e[t]=function(e,o){return o?("production"!==process.env.NODE_ENV&&"component"===t&&ae(e),"component"===t&&y(o)&&(o.name=o.name||e,o=this.options._base.extend(o)),"directive"===t&&"function"==typeof o&&(o={bind:o,update:o}),this.options[t+"s"][e]=o,o):this.options[t+"s"][e]}})}function mo(e){return e&&(e.Ctor.options.name||e.tag)}function go(e,t){return Array.isArray(e)?-1<e.indexOf(t):"string"==typeof e?-1<e.split(",").indexOf(t):!!b(e)&&e.test(t)}function vo(e,t){var o=e.cache,i=e.keys,a=e._vnode;for(var l in o){var n=o[l];if(n){var s=n.name;s&&!t(s)&&yo(o,l,i,a)}}}function yo(e,t,o,i){var a=e[t];a&&(!i||a.tag!==i.tag)&&a.componentInstance.$destroy(),e[t]=null,S(o,t)}function bo(e){var t={};t.get=function(){return al},"production"!==process.env.NODE_ENV&&(t.set=function(){Tl("Do not replace the Vue.config object, set individual fields instead.")}),Object.defineProperty(e,"config",t),e.util={warn:Tl,extend:$,mergeOptions:de,defineReactive:j},e.set=X,e.delete=Q,e.nextTick=Be,e.observable=function(e){return K(e),e},e.options=Object.create(null),c.forEach(function(t){e.options[t+"s"]=Object.create(null)}),e.options._base=e,$(e.options.components,Nn),co(e),po(e),uo(e),fo(e)}function Co(e){for(var t=e.data,o=e,i=e;A(i.componentInstance);)i=i.componentInstance._vnode,i&&i.data&&(t=wo(i.data,t));for(;A(o=o.parent);)o&&o.data&&(t=wo(t,o.data));return xo(t.staticClass,t.class)}function wo(e,t){return{staticClass:ko(e.staticClass,t.staticClass),class:A(e.class)?[e.class,t.class]:t.class}}function xo(e,t){return A(e)||A(t)?ko(e,Eo(t)):""}function ko(e,t){return e?t?e+" "+t:e:t||""}function Eo(e){return Array.isArray(e)?So(e):g(e)?Bo(e):"string"==typeof e?e:""}function So(e){for(var t="",o=0,a=e.length,l;o<a;o++)A(l=Eo(e[o]))&&""!==l&&(t&&(t+=" "),t+=l);return t}function Bo(e){var t="";for(var o in e)e[o]&&(t&&(t+=" "),t+=o);return t}function To(e){if("string"==typeof e){var t=document.querySelector(e);return t?t:("production"!==process.env.NODE_ENV&&Tl("Cannot find element: "+e),document.createElement("div"))}return e}function _o(e,t){var o=e.data.ref;if(A(o)){var i=e.context,a=e.componentInstance||e.elm,l=i.$refs;t?Array.isArray(l[o])?S(l[o],a):l[o]===a&&(l[o]=void 0):e.data.refInFor?Array.isArray(l[o])?0>l[o].indexOf(a)&&l[o].push(a):l[o]=[a]:l[o]=a}}function $o(e,t){return e.key===t.key&&e.asyncFactory===t.asyncFactory&&(e.tag===t.tag&&e.isComment===t.isComment&&A(e.data)===A(t.data)&&Po(e,t)||h(e.isAsyncPlaceholder)&&u(t.asyncFactory.error))}function Po(e,t){if("input"!==e.tag)return!0;var o=A(l=e.data)&&A(l=l.attrs)&&l.type,a=A(l=t.data)&&A(l=l.attrs)&&l.type,l;return o===a||os(o)&&os(a)}function Do(e,t,o){var a={},l,n;for(l=t;l<=o;++l)n=e[l].key,A(n)&&(a[n]=l);return a}function Fo(e,t){(e.data.directives||t.data.directives)&&zo(e,t)}function zo(e,t){var o=e===as,i=Lo(e.data.directives,e.context),a=Lo(t.data.directives,t.context),l=[],n=[],s,r,d;for(s in a)r=i[s],d=a[s],r?(d.oldValue=r.value,d.oldArg=r.arg,Vo(d,"update",t,e),d.def&&d.def.componentUpdated&&n.push(d)):(Vo(d,"bind",t,e),d.def&&d.def.inserted&&l.push(d));if(l.length){var c=function(){for(var o=0;o<l.length;o++)Vo(l[o],"inserted",t,e)};o?De(t,"insert",c):c()}if(n.length&&De(t,"postpatch",function(){for(var o=0;o<n.length;o++)Vo(n[o],"componentUpdated",t,e)}),!o)for(s in i)a[s]||Vo(i[s],"unbind",e,e,t===as)}function Lo(e,t){var o=Object.create(null);if(!e)return o;var a,l;for(a=0;a<e.length;a++)l=e[a],l.modifiers||(l.modifiers=ns),o[Mo(l)]=l,l.def=ce(t.$options,"directives",l.name,!0);return o}function Mo(e){return e.rawName||e.name+"."+Object.keys(e.modifiers||{}).join(".")}function Vo(t,o,i,a,l){var n=t.def&&t.def[o];if(n)try{n(i.elm,t,i,a,l)}catch(a){we(a,i.context,"directive "+t.name+" "+o+" hook")}}function Ro(e,t){var o=t.componentOptions;if(!(A(o)&&!1===o.Ctor.options.inheritAttrs)&&!(u(e.data.attrs)&&u(t.data.attrs))){var i=t.elm,a=e.data.attrs||{},l=t.data.attrs||{},n,s,r;for(n in A(l.__ob__)&&(l=t.data.attrs=$({},l)),l)s=l[n],r=a[n],r!==s&&Oo(i,n,s,t.data.pre);for(n in(ul||hl)&&l.value!==a.value&&Oo(i,"value",l.value),a)u(l[n])&&(jn(n)?i.removeAttributeNS("http://www.w3.org/1999/xlink",Xn(n)):!Wn(n)&&i.removeAttribute(n))}}function Oo(e,t,o,i){i||-1<e.tagName.indexOf("-")?Io(e,t,o):Kn(t)?Qn(o)?e.removeAttribute(t):(o="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,o)):Wn(t)?e.setAttribute(t,qn(t,o)):jn(t)?Qn(o)?e.removeAttributeNS("http://www.w3.org/1999/xlink",Xn(t)):e.setAttributeNS("http://www.w3.org/1999/xlink",t,o):Io(e,t,o)}function Io(t,e,o){if(Qn(o))t.removeAttribute(e);else{if(ul&&!Al&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==o&&!t.__ieph){var i=function(o){o.stopImmediatePropagation(),t.removeEventListener("input",i)};t.addEventListener("input",i),t.__ieph=!0}t.setAttribute(e,o)}}function No(e,t){var o=t.elm,i=t.data,a=e.data;if(!(u(i.staticClass)&&u(i.class)&&(u(a)||u(a.staticClass)&&u(a.class)))){var l=Co(t),n=o._transitionClasses;A(n)&&(l=ko(l,Eo(n))),l!==o._prevClass&&(o.setAttribute("class",l),o._prevClass=l)}}function Ho(e){if(A(e.__r)){var t=ul?"change":"input";e[t]=[].concat(e.__r,e[t]||[]),delete e.__r}A(e.__c)&&(e.change=[].concat(e.__c,e.change||[]),delete e.__c)}function Uo(e,t,o){var i=bs;return function a(){var l=t.apply(null,arguments);null!==l&&Yo(e,a,o,i)}}function Wo(e,t,o,i){if(ss){var a=$n,l=t;t=l._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=a||0>=t.timeStamp||t.target.ownerDocument!==document)return l.apply(this,arguments)}}bs.addEventListener(e,t,Cl?{capture:o,passive:i}:o)}function Yo(e,t,o,i){(i||bs).removeEventListener(e,t._wrapper||t,o)}function qo(e,t){if(!(u(e.data.on)&&u(t.data.on))){var o=t.data.on||{},i=e.data.on||{};bs=t.elm,Ho(o),Pe(o,i,Wo,Yo,Uo,t.context),bs=void 0}}function Ko(e,t){if(!(u(e.data.domProps)&&u(t.data.domProps))){var o=t.elm,i=e.data.domProps||{},a=t.data.domProps||{},l,n;for(l in A(a.__ob__)&&(a=t.data.domProps=$({},a)),i)l in a||(o[l]="");for(l in a){if(n=a[l],"textContent"===l||"innerHTML"===l){if(t.children&&(t.children.length=0),n===i[l])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===l&&"PROGRESS"!==o.tagName){o._value=n;var s=u(n)?"":n+"";jo(o,s)&&(o.value=s)}else if("innerHTML"===l&&Zn(o.tagName)&&u(o.innerHTML)){Cs=Cs||document.createElement("div"),Cs.innerHTML="<svg>"+n+"</svg>";for(var r=Cs.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;r.firstChild;)o.appendChild(r.firstChild)}else if(n!==i[l])try{o[l]=n}catch(t){}}}}function jo(e,t){return!e.composing&&("OPTION"===e.tagName||Xo(e,t)||Qo(e,t))}function Xo(e,t){var o=!0;try{o=document.activeElement!==e}catch(t){}return o&&e.value!==t}function Qo(e,t){var o=e.value,i=e._vModifiers;if(A(i)){if(i.number)return k(o)!==k(t);if(i.trim)return o.trim()!==t.trim()}return o!==t}function Go(e){var t=Jo(e.style);return e.staticStyle?$(e.staticStyle,t):t}function Jo(e){return Array.isArray(e)?P(e):"string"==typeof e?rs(e):e}function Zo(e,t){var o={},i;if(t)for(var a=e;a.componentInstance;)a=a.componentInstance._vnode,a&&a.data&&(i=Go(a.data))&&$(o,i);(i=Go(e.data))&&$(o,i);for(var l=e;l=l.parent;)l.data&&(i=Go(l.data))&&$(o,i);return o}function ei(e,t){var o=t.data,i=e.data;if(!(u(o.staticStyle)&&u(o.style)&&u(i.staticStyle)&&u(i.style))){var a=t.elm,l=i.staticStyle,n=i.normalizedStyle||i.style||{},s=l||n,r=Jo(t.data.style)||{},d,c;t.data.normalizedStyle=A(r.__ob__)?$({},r):r;var p=Zo(t,!0);for(c in s)u(p[c])&&cs(a,c,"");for(c in p)d=p[c],d!==s[c]&&cs(a,c,null==d?"":d)}}function ti(e,t){if(t&&(t=t.trim()))if(e.classList)-1<t.indexOf(" ")?t.split(As).forEach(function(t){return e.classList.add(t)}):e.classList.add(t);else{var o=" "+(e.getAttribute("class")||"")+" ";0>o.indexOf(" "+t+" ")&&e.setAttribute("class",(o+t).trim())}}function oi(e,t){if(t&&(t=t.trim()))if(e.classList)-1<t.indexOf(" ")?t.split(As).forEach(function(t){return e.classList.remove(t)}):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{for(var o=" "+(e.getAttribute("class")||"")+" ",i=" "+t+" ";0<=o.indexOf(i);)o=o.replace(i," ");o=o.trim(),o?e.setAttribute("class",o):e.removeAttribute("class")}}function ii(e){if(e){if("object"==typeof e){var t={};return!1!==e.css&&$(t,hs(e.name||"v")),$(t,e),t}return"string"==typeof e?hs(e):void 0}}function ai(e){xs(function(){xs(e)})}function li(e,t){var o=e._transitionClasses||(e._transitionClasses=[]);0>o.indexOf(t)&&(o.push(t),ti(e,t))}function ni(e,t){e._transitionClasses&&S(e._transitionClasses,t),oi(e,t)}function si(t,e,o){var i=ri(t,e),a=i.type,l=i.timeout,n=i.propCount;if(!a)return o();var s="transition"===a?gs:ys,r=0,d=function(){t.removeEventListener(s,c),o()},c=function(o){o.target===t&&++r>=n&&d()};setTimeout(function(){r<n&&d()},l+1),t.addEventListener(s,c)}function ri(e,t){var o=window.getComputedStyle(e),i=(o[ms+"Delay"]||"").split(", "),a=(o[ms+"Duration"]||"").split(", "),l=di(i,a),n=(o[vs+"Delay"]||"").split(", "),s=(o[vs+"Duration"]||"").split(", "),d=di(n,s),c=0,p=0,u;"transition"===t?0<l&&(u="transition",c=l,p=a.length):"animation"===t?0<d&&(u="animation",c=d,p=s.length):(c=r(l,d),u=0<c?l>d?"transition":"animation":null,p=u?"transition"===u?a.length:s.length:0);var A="transition"===u&&ks.test(o[ms+"Property"]);return{type:u,timeout:c,propCount:p,hasTransform:A}}function di(e,t){for(;e.length<t.length;)e=e.concat(e);return r.apply(null,t.map(function(t,o){return ci(t)+ci(e[o])}))}function ci(e){return 1e3*+e.slice(0,-1).replace(",",".")}function pi(e,t){var o=e.elm;A(o._leaveCb)&&(o._leaveCb.cancelled=!0,o._leaveCb());var i=ii(e.data.transition);if(!u(i)&&!(A(o._enterCb)||1!==o.nodeType)){for(var a=i.css,l=i.type,n=i.enterClass,s=i.enterToClass,r=i.enterActiveClass,d=i.appearClass,c=i.appearToClass,p=i.appearActiveClass,h=i.beforeEnter,f=i.enter,m=i.afterEnter,v=i.enterCancelled,y=i.beforeAppear,b=i.appear,C=i.afterAppear,w=i.appearCancelled,x=i.duration,E=Cn,S=Cn.$vnode;S&&S.parent;)E=S.context,S=S.parent;var B=!E._isMounted||!e.isRootInsert;if(!B||b||""===b){var T=B&&d?d:n,_=B&&p?p:r,$=B&&c?c:s,P=B?y||h:h,D=B?"function"==typeof b?b:f:f,F=B?C||m:m,z=B?w||v:v,M=k(g(x)?x.enter:x);"production"!==process.env.NODE_ENV&&null!=M&&Ai(M,"enter",e);var V=!1!==a&&!Al,R=fi(D),O=o._enterCb=L(function(){V&&(ni(o,$),ni(o,_)),O.cancelled?(V&&ni(o,T),z&&z(o)):F&&F(o),o._enterCb=null});e.data.show||De(e,"insert",function(){var t=o.parentNode,i=t&&t._pending&&t._pending[e.key];i&&i.tag===e.tag&&i.elm._leaveCb&&i.elm._leaveCb(),D&&D(o,O)}),P&&P(o),V&&(li(o,T),li(o,_),ai(function(){ni(o,T),O.cancelled||(li(o,$),!R&&(hi(M)?setTimeout(O,M):si(o,l,O)))})),e.data.show&&(t&&t(),D&&D(o,O)),V||R||O()}}}function ui(e,t){function o(){w.cancelled||(!e.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[e.key]=e),c&&c(i),y&&(li(i,s),li(i,d),ai(function(){ni(i,s),w.cancelled||(li(i,r),!b&&(hi(C)?setTimeout(w,C):si(i,n,w)))})),p&&p(i,w),!y&&!b&&w())}var i=e.elm;A(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var a=ii(e.data.transition);if(u(a)||1!==i.nodeType)return t();if(!A(i._leaveCb)){var l=a.css,n=a.type,s=a.leaveClass,r=a.leaveToClass,d=a.leaveActiveClass,c=a.beforeLeave,p=a.leave,h=a.afterLeave,f=a.leaveCancelled,m=a.delayLeave,v=a.duration,y=!1!==l&&!Al,b=fi(p),C=k(g(v)?v.leave:v);"production"!==process.env.NODE_ENV&&A(C)&&Ai(C,"leave",e);var w=i._leaveCb=L(function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[e.key]=null),y&&(ni(i,r),ni(i,d)),w.cancelled?(y&&ni(i,s),f&&f(i)):(t(),h&&h(i)),i._leaveCb=null});m?m(o):o()}}function Ai(e,t,o){"number"==typeof e?isNaN(e)&&Tl("<transition> explicit "+t+" duration is NaN - the duration expression might be incorrect.",o.context):Tl("<transition> explicit "+t+" duration is not a valid number - got "+JSON.stringify(e)+".",o.context)}function hi(e){return"number"==typeof e&&!isNaN(e)}function fi(e){if(u(e))return!1;var t=e.fns;return A(t)?fi(Array.isArray(t)?t[0]:t):1<(e._length||e.length)}function mi(e,t){!0!==t.data.show&&pi(t)}function gi(e,t,o){vi(e,t,o),(ul||hl)&&setTimeout(function(){vi(e,t,o)},0)}function vi(e,t,o){var a=t.value,n=e.multiple;if(n&&!Array.isArray(a))return void("production"!==process.env.NODE_ENV&&Tl("<select multiple v-model=\""+t.expression+"\"> expects an Array value for its binding, but got "+Object.prototype.toString.call(a).slice(8,-1),o));for(var s=0,r=e.options.length,l,d;s<r;s++)if(d=e.options[s],n)l=-1<z(a,bi(d)),d.selected!==l&&(d.selected=l);else if(F(bi(d),a))return void(e.selectedIndex!==s&&(e.selectedIndex=s));n||(e.selectedIndex=-1)}function yi(e,t){return t.every(function(t){return!F(t,e)})}function bi(e){return"_value"in e?e._value:e.value}function Ci(t){t.target.composing=!0}function wi(t){t.target.composing&&(t.target.composing=!1,xi(t.target,"input"))}function xi(t,o){var i=document.createEvent("HTMLEvents");i.initEvent(o,!0,!0),t.dispatchEvent(i)}function ki(e){return!e.componentInstance||e.data&&e.data.transition?e:ki(e.componentInstance._vnode)}function Ei(e){var t=e&&e.componentOptions;return t&&t.Ctor.options.abstract?Ei(St(t.children)):e}function Si(e){var t={},o=e.$options;for(var i in o.propsData)t[i]=e[i];var a=o._parentListeners;for(var l in a)t[Ja(l)]=a[l];return t}function Bi(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}function Ti(e){for(;e=e.parent;)if(e.data.transition)return!0}function _i(e,t){return t.key===e.key&&t.tag===e.tag}function $i(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function Pi(e){e.data.newPos=e.elm.getBoundingClientRect()}function Di(e){var t=e.data.pos,o=e.data.newPos,i=t.left-o.left,a=t.top-o.top;if(i||a){e.data.moved=!0;var l=e.elm.style;l.transform=l.WebkitTransform="translate("+i+"px,"+a+"px)",l.transitionDuration="0s"}}function Fi(e,t,o,i,a,l,n,s,r,d){"boolean"!=typeof n&&(r=s,s=n,n=!1);const c="function"==typeof o?o.options:o;e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,a&&(c.functional=!0)),i&&(c._scopeId=i);let p;if(l?(p=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,r(e)),e&&e._registeredComponents&&e._registeredComponents.add(l)},c._ssrRegister=p):t&&(p=n?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),p)if(c.functional){const e=c.render;c.render=function(t,o){return p.call(o),e(t,o)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,p):[p]}return o}function zi(){return(e,t)=>Li(e,t)}function Li(e,t){const o=zs?t.media||"default":e,i=Ms[o]||(Ms[o]={ids:new Set,styles:[]});if(!i.ids.has(e)){i.ids.add(e);let o=t.source;if(t.map&&(o+="\n/*# sourceURL="+t.map.sources[0]+" */",o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",t.media&&i.element.setAttribute("media",t.media),void 0===Ls&&(Ls=document.head||document.getElementsByTagName("head")[0]),Ls.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(o),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{const e=i.ids.size-1,t=document.createTextNode(o),a=i.element.childNodes;a[e]&&i.element.removeChild(a[e]),a.length?i.element.insertBefore(t,a[e]):i.element.appendChild(t)}}}/* script */function Mi(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function Vi(e){return Mi(e)?new Date(e.getTime()):null==e?new Date(NaN):new Date(e)}function Ri(e){return Mi(e)&&!isNaN(e.getTime())}function Oi(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!(0<=t&&6>=t))throw new RangeError("weekStartsOn must be between 0 and 6");var o=Vi(e),i=o.getDay();return o.setDate(o.getDate()-(i+7-t)%7),o.setHours(0,0,0,0),o}function Ii(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=t.firstDayOfWeek,a=void 0===o?0:o,l=t.firstWeekContainsDate,n=void 0===l?1:l;if(!(1<=n&&7>=n))throw new RangeError("firstWeekContainsDate must be between 1 and 7");for(var s=Vi(e),r=s.getFullYear(),d=new Date(0),c=r+1;c>=r-1&&(d.setFullYear(c,0,n),d.setHours(0,0,0,0),d=Oi(d,a),!(s.getTime()>=d.getTime()));c--);return d}function Ni(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=t.firstDayOfWeek,i=void 0===o?0:o,a=t.firstWeekContainsDate,l=void 0===a?1:a,s=Vi(e),r=Oi(s,i),d=Ii(s,{firstDayOfWeek:i,firstWeekContainsDate:l}),c=r.getTime()-d.getTime();return n(c/604800000)+1}function Hi(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,o="".concat(l(e)),i=0>e?"-":"";o.length<t;)o="0".concat(o);return i+o}function Ui(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",o=0<e?"-":"+",i=l(e),a=d(i/60);return o+Hi(a,2)+t+Hi(i%60,2)}function Wi(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=t?t+"":"YYYY-MM-DDTHH:mm:ss.SSSZ",a=Vi(e);if(!Ri(a))return"Invalid Date";var l=o.locale||js;return i.replace(Xs,function(e,t){return t?t:"function"==typeof Gs[e]?"".concat(Gs[e](a,l)):e})}function Yi(e){return ji(e)||Ki(e)||qi()}function qi(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Ki(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function ji(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}}function Xi(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,i)}return o}function Qi(e){for(var t=1,o;t<arguments.length;t++)o=null==arguments[t]?{}:arguments[t],t%2?Xi(o,!0).forEach(function(t){ta(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Xi(o).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))});return e}function Gi(e,t){return ea(e)||Zi(e,t)||Ji()}function Ji(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Zi(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var o=[],i=!0,a=!1,l=void 0;try{for(var n=e[Symbol.iterator](),s;!(i=(s=n.next()).done)&&(o.push(s.value),!(t&&o.length===t));i=!0);}catch(e){a=!0,l=e}finally{try{i||null==n["return"]||n["return"]()}finally{if(a)throw l}}return o}}function ea(e){if(Array.isArray(e))return e}function ta(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function oa(e){return"p"==="".concat(e).toLowerCase().charAt(0)}function ia(e){var t=e.match(/([+-]|\d\d)/g)||["-","0","0"],o=Gi(t,3),i=o[0],a=o[1],l=o[2],n=60*parseInt(a,10)+parseInt(l,10);return 0===n?0:"+"===i?-n:+n}function aa(e,t){if(void 0!==e&&void 0!==t)if(t){if(12>e)return e+12;}else if(12===e)return 0;return e}function la(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Date,o=[0,0,1,0,0,0,0],a=[t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()],l=!0,n=0;7>n;n++)void 0===e[n]?o[n]=l?a[n]:o[n]:(o[n]=e[n],l=!1);return o}function na(){for(var e=arguments.length,t=Array(e),o=0,i;o<e;o++)t[o]=arguments[o];var a=t[0];return 100>a&&0<=a?(t[0]+=400,i=new Date(Date.UTC.apply(Date,t)),isFinite(i.getUTCFullYear())&&i.setUTCFullYear(a)):i=new Date(Date.UTC.apply(Date,t)),i}function sa(e,t,o){var a=t.match(Js);if(!a)throw new Error;for(var l=a.length,n={},s=0;s<l;s+=1){var r=a[s],d=cr[r];if(!d){var c=r.replace(/^\[|\]$/g,"");if(0===e.indexOf(c))e=e.substr(c.length);else throw new Error("not match")}else{var p="function"==typeof d[0]?d[0](o):d[0],u=d[1],A=(p.exec(e)||[])[0],h=u(A,o);n=Qi({},n,{},h),e=e.replace(A,"")}}return n}function ra(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};try{var i=o.locale,a=void 0===i?js:i,l=o.backupDate,n=void 0===l?new Date:l,s=sa(e,t,a),r=s.year,d=s.month,c=s.day,p=s.hour,u=s.minute,A=s.second,h=s.millisecond,f=s.isPM,m=s.date,g=s.offset,v=s.weekday,y=s.week;if(m)return m;var b=[r,d,c,p,u,A,h];if(b[3]=aa(b[3],f),void 0!==y&&void 0===d&&void 0===c){var C=Ii(void 0===r?n:new Date(r,3),{firstDayOfWeek:a.firstDayOfWeek,firstWeekContainsDate:a.firstWeekContainsDate});return new Date(C.getTime()+1e3*(3600*(24*(7*(y-1)))))}var w=na.apply(void 0,Yi(la(b,n))),x=1e3*(60*(void 0===g?w.getTimezoneOffset():g)),k=new Date(w.getTime()+x);return void 0!==v&&k.getDay()!==v?new Date(NaN):k}catch(t){return new Date(NaN)}}function da(e){"@babel/helpers - typeof";return da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},da(e)}function ca(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function pa(){return pa=Object.assign||function(e){for(var t=1,o;t<arguments.length;t++)for(var a in o=arguments[t],o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);return e},pa.apply(this,arguments)}function ua(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,i)}return o}function Aa(e){for(var t=1,o;t<arguments.length;t++)o=null==arguments[t]?{}:arguments[t],t%2?ua(Object(o),!0).forEach(function(t){ca(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ua(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))});return e}function ha(e,t){if(null==e)return{};var o={},a=Object.keys(e),l,n;for(n=0;n<a.length;n++)l=a[n],0<=t.indexOf(l)||(o[l]=e[l]);return o}function fa(e,t){if(null==e)return{};var o=ha(e,t),a,l;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)a=n[l],0<=t.indexOf(a)||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}function ma(e,t){return ga(e)||va(e,t)||ya(e,t)||Ca()}function ga(e){if(Array.isArray(e))return e}function va(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],i=!0,a=!1,l=void 0;try{for(var n=e[Symbol.iterator](),s;!(i=(s=n.next()).done)&&(o.push(s.value),!(t&&o.length===t));i=!0);}catch(e){a=!0,l=e}finally{try{i||null==n["return"]||n["return"]()}finally{if(a)throw l}}return o}}function ya(e,t){if(e){if("string"==typeof e)return ba(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ba(e,t):void 0}}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=Array(t);o<t;o++)a[o]=e[o];return a}function Ca(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wa(){return wa=Object.assign||function(e){for(var t=1,o;t<arguments.length;t++)for(var i in o=arguments[t],o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);return e},wa.apply(this,arguments)}function xa(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,n=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,s=new Date(e,t,o,i,a,l,n);return 100>e&&0<=e&&s.setFullYear(e),s}function ka(e){return e instanceof Date&&!isNaN(e)}function Ea(e){return Array.isArray(e)&&2===e.length&&e.every(ka)&&e[0]<=e[1]}function Sa(e){return Array.isArray(e)&&e.every(ka)}function Ba(e){var t=new Date(e);if(ka(t))return t;for(var o=arguments.length,i=Array(1<o?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return i.length?Ba.apply(void 0,i):new Date}function Ta(e){var t=new Date(e);return t.setMonth(0,1),t.setHours(0,0,0,0),t}function _a(e){var t=new Date(e);return t.setDate(1),t.setHours(0,0,0,0),t}function $a(e){var t=new Date(e);return t.setHours(0,0,0,0),t}function Pa(e){for(var t=e.firstDayOfWeek,o=e.year,a=e.month,l=[],n=xa(o,a,0),s=n.getDate(),r=s-(n.getDay()+7-t)%7,d=r;d<=s;d++)l.push(xa(o,a,d-s));n.setMonth(a+1,0);for(var c=n.getDate(),p=1;p<=c;p++)l.push(xa(o,a,p));for(var u=1;u<=42-(s-r+1)-c;u++)l.push(xa(o,a,c+u));return l}function Da(e,t){var o=new Date(e),i=+t,l=o.getFullYear(),n=xa(l,i+1,0).getDate(),s=o.getDate();return o.setMonth(i,a(s,n)),o}function Fa(e,t){var o=new Date(e),i=new Date(t);return o.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),o}function za(e,t){if(!Array.isArray(e))return[];var o=[],a=e.length,l=0;for(t=t||a;l<a;)o.push(e.slice(l,l+=t));return o}function La(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ma(e,t){if(!La(e))return{};Array.isArray(t)||(t=[t]);var o={};return t.forEach(function(t){t in e&&(o[t]=e[t])}),o}function Va(e,t){if(!La(e))return{};var o=e;return La(t)&&Object.keys(t).forEach(function(i){var a=t[i];La(a)&&La(e[i])&&(a=Va(e[i],a)),o=Aa({},o,ca({},i,a))}),o}function Ra(e,t,o){if("string"!=typeof e)return wr[Cr];var i=Cr;return wr[e]&&(i=e),t&&(wr[e]=t,i=e),o||(Cr=i),wr[e]||wr[Cr]}function Oa(e){return Ra(e,null,!0)}function Ia(e){var t=!1;return function(){for(var o=this,i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];t||(t=!0,requestAnimationFrame(function(){t=!1,e.apply(o,a)}))}}function Na(e){var t=e.style.display,o=e.style.visibility;e.style.display="block",e.style.visibility="hidden";var i=window.getComputedStyle(e),a=e.offsetWidth+parseInt(i.marginLeft,10)+parseInt(i.marginRight,10),l=e.offsetHeight+parseInt(i.marginTop,10)+parseInt(i.marginBottom,10);return e.style.display=t,e.style.visibility=o,{width:a,height:l}}function Ha(e,t,o,i){var a=0,l=0,n=0,s=0,r=e.getBoundingClientRect(),d=document.documentElement.clientWidth,c=document.documentElement.clientHeight;return i&&(n=window.pageXOffset+r.left,s=window.pageYOffset+r.top),a=d-r.left<t&&r.right<t?n-r.left+1:r.left+r.width/2<=d/2?n:n+r.width-t,l=r.top<=o&&c-r.bottom<=o?s+c-r.top-o:r.top+r.height/2<=c/2?s+r.height:s-o,{left:"".concat(a,"px"),top:"".concat(l,"px")}}function Ua(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document.body;if(!e||e===t)return null;var o=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},i=/(auto|scroll)/.test(o(e,"overflow")+o(e,"overflow-y")+o(e,"overflow-x"));return i?e:Ua(e.parentNode,t)}function Wa(e,t,o,i,a,l,n,s,r,d){"boolean"!=typeof n&&(r=s,s=n,n=!1);var c="function"==typeof o?o.options:o;e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,a&&(c.functional=!0)),i&&(c._scopeId=i);var p;if(l?(p=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,r(e)),e&&e._registeredComponents&&e._registeredComponents.add(l)},c._ssrRegister=p):t&&(p=n?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),p)if(c.functional){var u=c.render;c.render=function(e,t){return p.call(t),u(e,t)}}else{var A=c.beforeCreate;c.beforeCreate=A?[].concat(A,p):[p]}return o}function Ya(){if("undefined"==typeof window)return 0;if(void 0!==td)return td;var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=document.createElement("div");return t.style.width="100%",e.appendChild(t),td=e.offsetWidth-t.offsetWidth,e.parentNode.removeChild(e),td}function qa(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=e.split(":");if(2<=t.length){var o=parseInt(t[0],10),i=parseInt(t[1],10);return{hours:o,minutes:i}}return null}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o["default"]:o,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i["default"]:i;/*!
   * Vue.js v2.6.14
   * (c) 2014-2021 Evan You
   * Released under the MIT License.
   */var Ka=Object.freeze({}),ja=Object.prototype.toString,Xa=E("slot,component",!0),Qa=E("key,ref,slot,slot-scope,is"),Ga=Object.prototype.hasOwnProperty,Ja=T(function(e){return e.replace(/-(\w)/g,function(e,t){return t?t.toUpperCase():""})}),Za=T(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}),tl=T(function(e){return e.replace(/\B([A-Z])/g,"-$1").toLowerCase()}),ol=Function.prototype.bind?function(e,t){return e.bind(t)}:function(e,t){function o(o){var i=arguments.length;return i?1<i?e.apply(t,arguments):e.call(t,o):e.call(t)}return o._length=e.length,o},il=function(){return!1},s=function(e){return e},c=["component","directive","filter"],no=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],al={optionMergeStrategies:Object.create(null),silent:!1,productionTip:"production"!==process.env.NODE_ENV,devtools:"production"!==process.env.NODE_ENV,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:il,isReservedAttr:il,isUnknownElement:il,getTagNamespace:D,parsePlatformTagName:s,mustUseProp:il,async:!0,_lifecycleHooks:no},ll=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/,nl=new RegExp("[^"+ll.source+".$_\\d]"),sl=("__proto__"in{}),rl="undefined"!=typeof window,dl="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,cl=dl&&WXEnvironment.platform.toLowerCase(),pl=rl&&window.navigator.userAgent.toLowerCase(),ul=pl&&/msie|trident/.test(pl),Al=pl&&0<pl.indexOf("msie 9.0"),hl=pl&&0<pl.indexOf("edge/"),fl=pl&&0<pl.indexOf("android")||"android"===cl,ml=pl&&/iphone|ipad|ipod|ios/.test(pl)||"ios"===cl,gl=pl&&/chrome\/\d+/.test(pl)&&!hl,vl=pl&&/phantomjs/.test(pl),yl=pl&&pl.match(/firefox\/(\d+)/),bl={}.watch,Cl=!1;if(rl)try{var wl={};Object.defineProperty(wl,"passive",{get:function(){Cl=!0}}),window.addEventListener("test-passive",null,wl)}catch(t){}var xl=function(){return void 0===Sl&&(rl||dl||"undefined"==typeof global?Sl=!1:Sl=global.process&&"server"===global.process.env.VUE_ENV),Sl},kl=rl&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__,El="undefined"!=typeof Symbol&&O(Symbol)&&"undefined"!=typeof Reflect&&O(Reflect.ownKeys),Sl,Bl;Bl="undefined"!=typeof Set&&O(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var Tl=D,_l=D,$l=D,Pl=D;if("production"!==process.env.NODE_ENV){var Dl="undefined"!=typeof console,Fl=function(e){return e.replace(/(?:^|[-_])(\w)/g,function(e){return e.toUpperCase()}).replace(/[-_]/g,"")};Tl=function(e,t){var o=t?$l(t):"";al.warnHandler?al.warnHandler.call(null,e,t,o):Dl&&!al.silent&&console.error("[Vue warn]: "+e+o)},_l=function(e,t){Dl&&!al.silent&&console.warn("[Vue tip]: "+e+(t?$l(t):""))},Pl=function(e,t){if(e.$root===e)return"<Root>";var o="function"==typeof e&&null!=e.cid?e.options:e._isVue?e.$options||e.constructor.options:e,i=o.name||o._componentTag,a=o.__file;if(!i&&a){var l=a.match(/([^/\\]+)\.vue$/);i=l&&l[1]}return(i?"<"+Fl(i)+">":"<Anonymous>")+(a&&!1!==t?" at "+a:"")};var zl=function(e,t){for(var o="";t;)1==t%2&&(o+=e),1<t&&(e+=e),t>>=1;return o};$l=function(e){if(e._isVue&&e.$parent){for(var t=[],o=0;e;){if(0<t.length){var i=t[t.length-1];if(i.constructor===e.constructor){o++,e=e.$parent;continue}else 0<o&&(t[t.length-1]=[i,o],o=0)}t.push(e),e=e.$parent}return"\n\nfound in\n\n"+t.map(function(e,t){return""+(0===t?"---> ":zl(" ",5+2*t))+(Array.isArray(e)?Pl(e[0])+"... ("+e[1]+" recursive calls)":Pl(e))}).join("\n")}return"\n\n(found in "+Pl(e)+")"}}var Ll=0,Ml=function(){this.id=Ll++,this.subs=[]};Ml.prototype.addSub=function(e){this.subs.push(e)},Ml.prototype.removeSub=function(e){S(this.subs,e)},Ml.prototype.depend=function(){Ml.target&&Ml.target.addDep(this)},Ml.prototype.notify=function(){var e=this.subs.slice();"production"===process.env.NODE_ENV||al.async||e.sort(function(e,t){return e.id-t.id});for(var t=0,o=e.length;t<o;t++)e[t].update()},Ml.target=null;var Vl=[],Rl=function(e,t,o,i,a,l,n,s){this.tag=e,this.data=t,this.children=o,this.text=i,this.elm=a,this.ns=void 0,this.context=l,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=n,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},Ol={child:{configurable:!0}};Ol.child.get=function(){return this.componentInstance},Object.defineProperties(Rl.prototype,Ol);var Il=function(e){void 0===e&&(e="");var t=new Rl;return t.text=e,t.isComment=!0,t},Nl=Array.prototype,Hl=Object.create(Nl);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(e){var t=Nl[e];V(Hl,e,function(){for(var o=[],i=arguments.length;i--;)o[i]=arguments[i];var a=t.apply(this,o),l=this.__ob__,n;return"push"===e||"unshift"===e?n=o:"splice"===e?n=o.slice(2):void 0,n&&l.observeArray(n),l.dep.notify(),a})});var Ul=Object.getOwnPropertyNames(Hl),Wl=!0,Yl=function(e){this.value=e,this.dep=new Ml,this.vmCount=0,V(e,"__ob__",this),Array.isArray(e)?(sl?Y(e,Hl):q(e,Hl,Ul),this.observeArray(e)):this.walk(e)};Yl.prototype.walk=function(e){for(var t=Object.keys(e),o=0;o<t.length;o++)j(e,t[o])},Yl.prototype.observeArray=function(e){for(var t=0,o=e.length;t<o;t++)K(e[t])};var ql=al.optionMergeStrategies;"production"!==process.env.NODE_ENV&&(ql.el=ql.propsData=function(e,t,o,i){return o||Tl("option \""+i+"\" can only be used during instance creation with the `new` keyword."),Kl(e,t)}),ql.data=function(e,t,o){return o?Z(e,t,o):t&&"function"!=typeof t?("production"!==process.env.NODE_ENV&&Tl("The \"data\" option should be a function that returns a per-instance value in component definitions.",o),e):Z(e,t)},no.forEach(function(e){ql[e]=ee}),c.forEach(function(e){ql[e+"s"]=oe}),ql.watch=function(e,t,o,i){if(e===bl&&(e=void 0),t===bl&&(t=void 0),!t)return Object.create(e||null);if("production"!==process.env.NODE_ENV&&re(i,t,o),!e)return t;var a={};for(var l in $(a,e),t){var n=a[l],s=t[l];n&&!Array.isArray(n)&&(n=[n]),a[l]=n?n.concat(s):Array.isArray(s)?s:[s]}return a},ql.props=ql.methods=ql.inject=ql.computed=function(e,t,o,i){if(t&&"production"!==process.env.NODE_ENV&&re(i,t,o),!e)return t;var a=Object.create(null);return $(a,e),t&&$(a,t),a},ql.provide=Z;var Kl=function(e,t){return void 0===t?e:t},jl=/^(String|Number|Boolean|Function|Symbol|BigInt)$/,Xl=/^\s*function (\w+)/,Ql=["string","number","boolean"],Gl=!1,Jl=[],Zl=!1,tn;if("undefined"!=typeof Promise&&O(Promise)){var on=Promise.resolve();tn=function(){on.then(Se),ml&&setTimeout(D)},Gl=!0}else if(!ul&&"undefined"!=typeof MutationObserver&&(O(MutationObserver)||"[object MutationObserverConstructor]"===MutationObserver.toString())){var p=1,el=new MutationObserver(Se),an=document.createTextNode(p+"");el.observe(an,{characterData:!0}),tn=function(){p=(p+1)%2,an.data=p+""},Gl=!0}else tn="undefined"!=typeof setImmediate&&O(setImmediate)?function(){setImmediate(Se)}:function(){setTimeout(Se,0)};var ln;if("production"!==process.env.NODE_ENV){var nn=E("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,require"),sn=function(e,t){Tl("Property or method \""+t+"\" is not defined on the instance but referenced during render. Make sure that this property is reactive, either in the data option, or for class-based components, by initializing the property. See: https://vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.",e)},rn=function(e,t){Tl("Property \""+t+"\" must be accessed with \"$data."+t+"\" because properties starting with \"$\" or \"_\" are not proxied in the Vue instance to prevent conflicts with Vue internals. See: https://vuejs.org/v2/api/#data",e)},dn="undefined"!=typeof Proxy&&O(Proxy);if(dn){var cn=E("stop,prevent,self,ctrl,shift,alt,meta,exact");al.keyCodes=new Proxy(al.keyCodes,{set:function(e,t,o){return cn(t)?(Tl("Avoid overwriting built-in modifier in config.keyCodes: ."+t),!1):(e[t]=o,!0)}})}var pn={has:function e(t,o){var e=(o in t),i=nn(o)||"string"==typeof o&&"_"===o.charAt(0)&&!(o in t.$data);return e||i||(o in t.$data?rn(t,o):sn(t,o)),e||!i}},un={get:function(e,t){return"string"!=typeof t||t in e||(t in e.$data?rn(e,t):sn(e,t)),e[t]}};ln=function(e){if(dn){var t=e.$options,o=t.render&&t.render._withStripped?un:pn;e._renderProxy=new Proxy(e,o)}else e._renderProxy=e}}var An=new Bl,hn,fn;if("production"!==process.env.NODE_ENV){var mn=rl&&window.performance;mn&&mn.mark&&mn.measure&&mn.clearMarks&&mn.clearMeasures&&(hn=function(e){return mn.mark(e)},fn=function(e,t,o){mn.measure(e,t,o),mn.clearMarks(t),mn.clearMarks(o)})}var gn=T(function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var o="~"===e.charAt(0);e=o?e.slice(1):e;var i="!"===e.charAt(0);return e=i?e.slice(1):e,{name:e,once:o,capture:i,passive:t}});rt(dt.prototype);var vn={init:function(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var o=e;vn.prepatch(o,o)}else{var i=e.componentInstance=ht(e,Cn);i.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var o=t.componentOptions,i=t.componentInstance=e.componentInstance;Lt(i,o.propsData,o.listeners,t,o.children)},insert:function(e){var t=e.context,o=e.componentInstance;o._isMounted||(o._isMounted=!0,Ot(o,"mounted")),e.data.keepAlive&&(t._isMounted?Ut(o):Vt(o,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?Rt(t,!0):t.$destroy())}},yn=Object.keys(vn),bn=null,Cn=null,wn=!1,xn=[],kn=[],En={},Sn={},Bn=!1,Tn=!1,_n=0,$n=0,Pn=Date.now,Dn;if(rl&&!ul){var Fn=window.performance;Fn&&"function"==typeof Fn.now&&Pn()>document.createEvent("Event").timeStamp&&(Pn=function(){return Fn.now()})}var zn=0,Ln=function(e,t,o,i,a){this.vm=e,a&&(e._watcher=this),e._watchers.push(this),i?(this.deep=!!i.deep,this.user=!!i.user,this.lazy=!!i.lazy,this.sync=!!i.sync,this.before=i.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=o,this.id=++zn,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new Bl,this.newDepIds=new Bl,this.expression="production"===process.env.NODE_ENV?"":t.toString(),"function"==typeof t?this.getter=t:(this.getter=R(t),!this.getter&&(this.getter=D,"production"!==process.env.NODE_ENV&&Tl("Failed watching path: \""+t+"\" Watcher only accepts simple dot-delimited paths. For full control, use a function instead.",e))),this.value=this.lazy?void 0:this.get()};Ln.prototype.get=function(){I(this);var t=this.vm,e;try{e=this.getter.call(t,t)}catch(o){if(this.user)we(o,t,"getter for watcher \""+this.expression+"\"");else throw o}finally{this.deep&&Te(e),N(),this.cleanupDeps()}return e},Ln.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),!this.depIds.has(t)&&e.addSub(this))},Ln.prototype.cleanupDeps=function(){for(var e=this.deps.length,t;e--;)t=this.deps[e],this.newDepIds.has(t.id)||t.removeSub(this);var o=this.depIds;this.depIds=this.newDepIds,this.newDepIds=o,this.newDepIds.clear(),o=this.deps,this.deps=this.newDeps,this.newDeps=o,this.newDeps.length=0},Ln.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Yt(this)},Ln.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||g(e)||this.deep){var t=this.value;if(this.value=e,this.user){var o="callback for watcher \""+this.expression+"\"";xe(this.cb,this.vm,[e,t],this.vm,o)}else this.cb.call(this.vm,e,t)}}},Ln.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},Ln.prototype.depend=function(){for(var e=this.deps.length;e--;)this.deps[e].depend()},Ln.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||S(this.vm._watchers,this);for(var e=this.deps.length;e--;)this.deps[e].removeSub(this);this.active=!1}};var Mn={enumerable:!0,configurable:!0,get:D,set:D},Vn={lazy:!0},Rn=0;(function(e){e.prototype._init=function(e){var t=this;t._uid=Rn++;var o,i;"production"!==process.env.NODE_ENV&&al.performance&&hn&&(o="vue-perf-start:"+t._uid,i="vue-perf-end:"+t._uid,hn(o)),t._isVue=!0,e&&e._isComponent?ao(t,e):t.$options=de(lo(t.constructor),e||{},t),"production"===process.env.NODE_ENV?t._renderProxy=t:ln(t),t._self=t,Ft(t),Bt(t),wt(t),Ot(t,"beforeCreate"),Ie(t),Kt(t),Oe(t),Ot(t,"created"),"production"!==process.env.NODE_ENV&&al.performance&&hn&&(t._name=Pl(t,!1),hn(i),fn("vue "+t._name+" init",o,i)),t.$options.el&&t.$mount(t.$options.el)}})(ro),function(e){var t={get:function(){return this._data}},o={};o.get=function(){return this._props},"production"!==process.env.NODE_ENV&&(t.set=function(){Tl("Avoid replacing instance root $data. Use nested data properties instead.",this)},o.set=function(){Tl("$props is readonly.",this)}),Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",o),e.prototype.$set=X,e.prototype.$delete=Q,e.prototype.$watch=function(e,t,o){var i=this;if(y(t))return io(i,e,t,o);o=o||{},o.user=!0;var a=new Ln(i,e,t,o);if(o.immediate){var l="callback for immediate watcher \""+a.expression+"\"";I(),xe(t,i,[a.value],i,l),N()}return function(){a.teardown()}}}(ro),function(e){e.prototype.$on=function(e,t){var o=this;if(Array.isArray(e))for(var a=0,n=e.length;a<n;a++)o.$on(e[a],t);else(o._events[e]||(o._events[e]=[])).push(t),/^hook:/.test(e)&&(o._hasHookEvent=!0);return o},e.prototype.$once=function(e,t){function o(){i.$off(e,o),t.apply(i,arguments)}var i=this;return o.fn=t,i.$on(e,o),i},e.prototype.$off=function(e,t){var o=this;if(!arguments.length)return o._events=Object.create(null),o;if(Array.isArray(e)){for(var a=0,n=e.length;a<n;a++)o.$off(e[a],t);return o}var l=o._events[e];if(!l)return o;if(!t)return o._events[e]=null,o;for(var s=l.length,r;s--;)if(r=l[s],r===t||r.fn===t){l.splice(s,1);break}return o},e.prototype.$emit=function(e){var t=this;if("production"!==process.env.NODE_ENV){var o=e.toLowerCase();o!==e&&t._events[o]&&_l("Event \""+o+"\" is emitted in component "+Pl(t)+" but the handler is registered for \""+e+"\". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use \""+tl(e)+"\" instead of \""+e+"\".")}var a=t._events[e];if(a){a=1<a.length?_(a):a;for(var n=_(arguments,1),s=0,r=a.length;s<r;s++)xe(a[s],t,n,t,"event handler for \""+e+"\"")}return t}}(ro),function(e){e.prototype._update=function(e,t){var o=this,i=o.$el,a=o._vnode,l=Dt(o);o._vnode=e,o.$el=a?o.__patch__(a,e):o.__patch__(o.$el,e,t,!1),l(),i&&(i.__vue__=null),o.$el&&(o.$el.__vue__=o),o.$vnode&&o.$parent&&o.$vnode===o.$parent._vnode&&(o.$parent.$el=o.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Ot(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||S(t.$children,e),e._watcher&&e._watcher.teardown();for(var o=e._watchers.length;o--;)e._watchers[o].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Ot(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}(ro),function(e){rt(e.prototype),e.prototype.$nextTick=function(e){return Be(e,this)},e.prototype._render=function(){var t=this,e=t.$options,o=e.render,i=e._parentVnode;i&&(t.$scopedSlots=Ye(i.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=i;var a;try{bn=t,a=o.call(t._renderProxy,t.$createElement)}catch(o){if(we(o,t,"render"),"production"!==process.env.NODE_ENV&&t.$options.renderError)try{a=t.$options.renderError.call(t._renderProxy,t.$createElement,o)}catch(o){we(o,t,"renderError"),a=t._vnode}else a=t._vnode}finally{bn=null}return Array.isArray(a)&&1===a.length&&(a=a[0]),a instanceof Rl||("production"!==process.env.NODE_ENV&&Array.isArray(a)&&Tl("Multiple root nodes returned from render function. Render function should return a single root node.",t),a=Il()),a.parent=i,a}}(ro);var On=[String,RegExp,Array],In={name:"keep-alive",abstract:!0,props:{include:On,exclude:On,max:[String,Number]},methods:{cacheVNode:function(){var e=this,t=e.cache,o=e.keys,i=e.vnodeToCache,a=e.keyToCache;if(i){var l=i.tag,n=i.componentInstance,s=i.componentOptions;t[a]={name:mo(s),tag:l,componentInstance:n},o.push(a),this.max&&o.length>parseInt(this.max)&&yo(t,o[0],o,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)yo(this.cache,e,this.keys)},mounted:function(){var e=this;this.cacheVNode(),this.$watch("include",function(t){vo(e,function(e){return go(t,e)})}),this.$watch("exclude",function(t){vo(e,function(e){return!go(t,e)})})},updated:function(){this.cacheVNode()},render:function(){var e=this.$slots.default,t=St(e),o=t&&t.componentOptions;if(o){var i=mo(o),a=this,l=a.include,n=a.exclude;if(l&&(!i||!go(l,i))||n&&i&&go(n,i))return t;var s=this,r=s.cache,d=s.keys,c=null==t.key?o.Ctor.cid+(o.tag?"::"+o.tag:""):t.key;r[c]?(t.componentInstance=r[c].componentInstance,S(d,c),d.push(c)):(this.vnodeToCache=t,this.keyToCache=c),t.data.keepAlive=!0}return t||e&&e[0]}},Nn={KeepAlive:In};bo(ro),Object.defineProperty(ro.prototype,"$isServer",{get:xl}),Object.defineProperty(ro.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(ro,"FunctionalRenderContext",{value:dt}),ro.version="2.6.14";var Hn=E("style,class"),Un=E("input,textarea,option,select,progress"),Wn=E("contenteditable,draggable,spellcheck"),Yn=E("events,caret,typing,plaintext-only"),qn=function(e,t){return Qn(t)||"false"===t?"false":"contenteditable"===e&&Yn(t)?t:"true"},Kn=E("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),jn=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},Xn=function(e){return jn(e)?e.slice(6,e.length):""},Qn=function(e){return null==e||!1===e},Gn={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Jn=E("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Zn=E("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),es=function(e){return Jn(e)||Zn(e)},ts=Object.create(null),os=E("text,number,password,search,email,tel,url"),is=Object.freeze({createElement:function(e,t){var o=document.createElement(e);return"select"===e?(t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&o.setAttribute("multiple","multiple"),o):o},createElementNS:function(e,t){return document.createElementNS(Gn[e],t)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,t,o){e.insertBefore(t,o)},removeChild:function(e,t){e.removeChild(t)},appendChild:function(e,t){e.appendChild(t)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,t){e.textContent=t},setStyleScope:function(e,t){e.setAttribute(t,"")}}),as=new Rl("",{},[]),ls=["create","activate","update","remove","destroy"],ns=Object.create(null),ss=Gl&&!(yl&&53>=+yl[1]),rs=T(function(e){var t={};return e.split(/;(?![^(]*\))/g).forEach(function(e){if(e){var o=e.split(/:(.+)/);1<o.length&&(t[o[0].trim()]=o[1].trim())}}),t}),ds=/\s*!important$/,cs=function(e,t,o){if(/^--/.test(t))e.style.setProperty(t,o);else if(ds.test(o))e.style.setProperty(tl(t),o.replace(ds,""),"important");else{var a=us(t);if(Array.isArray(o))for(var l=0,n=o.length;l<n;l++)e.style[a]=o[l];else e.style[a]=o}},ps=["Webkit","Moz","ms"],us=T(function(e){if(ws=ws||document.createElement("div").style,e=Ja(e),"filter"!==e&&e in ws)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),o=0,a;o<ps.length;o++)if(a=ps[o]+t,a in ws)return a}),As=/\s+/,hs=T(function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}}),fs=rl&&!Al,ms="transition",gs="transitionend",vs="animation",ys="animationend",bs,Cs,ws;fs&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(ms="WebkitTransition",gs="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(vs="WebkitAnimation",ys="webkitAnimationEnd"));var xs=rl?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()},ks=/\b(transform|all)(,|$)/,Es=rl?{create:mi,activate:mi,remove:function(e,t){!0===e.data.show?t():ui(e,t)}}:{},Ss=[{create:Ro,update:Ro},{create:No,update:No},{create:qo,update:qo},{create:Ko,update:Ko},{create:ei,update:ei},Es].concat([{create:function(e,t){_o(t)},update:function(e,t){e.data.ref!==t.data.ref&&(_o(e,!0),_o(t))},destroy:function(e){_o(e,!0)}},{create:Fo,update:Fo,destroy:function(e){Fo(e,as)}}]),Bs=function(e){function t(e){return new Rl(z.tagName(e).toLowerCase(),{},[],void 0,e)}function o(e,t){function o(){0==--o.listeners&&a(e)}return o.listeners=t,o}function a(e){var t=z.parentNode(e);A(t)&&z.removeChild(t,e)}function l(e,t){return!t&&!e.ns&&!(al.ignoredElements.length&&al.ignoredElements.some(function(t){return b(t)?t.test(e.tag):t===e.tag}))&&al.isUnknownElement(e.tag)}function n(e,t,o,i,a,n,r){if(A(e.elm)&&A(n)&&(e=n[r]=U(e)),e.isRootInsert=!a,!s(e,t,o,i)){var d=e.data,u=e.children,f=e.tag;A(f)?("production"!==process.env.NODE_ENV&&(d&&d.pre&&V++,l(e,V)&&Tl("Unknown custom element: <"+f+"> - did you register the component correctly? For recursive components, make sure to provide the \"name\" option.",e.context)),e.elm=e.ns?z.createElementNS(e.ns,f):z.createElement(f,e),v(e),p(e,u,t),A(d)&&g(e,t),c(o,e.elm,i),"production"!==process.env.NODE_ENV&&d&&d.pre&&V--):h(e.isComment)?(e.elm=z.createComment(e.text),c(o,e.elm,i)):(e.elm=z.createTextNode(e.text),c(o,e.elm,i))}}function s(e,t,o,a){var l=e.data;if(A(l)){var n=A(e.componentInstance)&&l.keepAlive;if(A(l=l.hook)&&A(l=l.init)&&l(e,!1),A(e.componentInstance))return r(e,t),c(o,e.elm,a),h(n)&&d(e,t,o,a),!0}}function r(e,t){A(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,f(e)?(g(e,t),v(e)):(_o(e),t.push(e))}function d(e,t,o,a){for(var l=e,n;l.componentInstance;)if(l=l.componentInstance._vnode,A(n=l.data)&&A(n=n.transition)){for(n=0;n<D.activate.length;++n)D.activate[n](as,l);t.push(l);break}c(o,e.elm,a)}function c(e,t,o){A(e)&&(A(o)?z.parentNode(o)===e&&z.insertBefore(e,t,o):z.appendChild(e,t))}function p(e,t,o){if(Array.isArray(t)){"production"!==process.env.NODE_ENV&&S(t);for(var a=0;a<t.length;++a)n(t[a],o,e.elm,null,!0,t,a)}else m(e.text)&&z.appendChild(e.elm,z.createTextNode(e.text+""))}function f(e){for(;e.componentInstance;)e=e.componentInstance._vnode;return A(e.tag)}function g(e,t){for(var o=0;o<D.create.length;++o)D.create[o](as,e);L=e.data.hook,A(L)&&(A(L.create)&&L.create(as,e),A(L.insert)&&t.push(e))}function v(e){var t;if(A(t=e.fnScopeId))z.setStyleScope(e.elm,t);else for(var o=e;o;)A(t=o.context)&&A(t=t.$options._scopeId)&&z.setStyleScope(e.elm,t),o=o.parent;A(t=Cn)&&t!==e.context&&t!==e.fnContext&&A(t=t.$options._scopeId)&&z.setStyleScope(e.elm,t)}function y(e,t,o,i,a,l){for(;i<=a;++i)n(o[i],l,e,t,!1,o,i)}function C(e){var t=e.data,o,a;if(A(t))for(A(o=t.hook)&&A(o=o.destroy)&&o(e),o=0;o<D.destroy.length;++o)D.destroy[o](e);if(A(o=e.children))for(a=0;a<e.children.length;++a)C(e.children[a])}function w(e,t,o){for(;t<=o;++t){var i=e[t];A(i)&&(A(i.tag)?(x(i),C(i)):a(i.elm))}}function x(e,t){if(A(t)||A(e.data)){var l=D.remove.length+1,n;for(A(t)?t.listeners+=l:t=o(e.elm,l),A(n=e.componentInstance)&&A(n=n._vnode)&&A(n.data)&&x(n,t),n=0;n<D.remove.length;++n)D.remove[n](e,t);A(n=e.data.hook)&&A(n=n.remove)?n(e,t):t()}else a(e.elm)}function k(e,t,o,i,a){var l=0,s=0,r=t.length-1,d=t[0],c=t[r],p=o.length-1,h=o[0],f=o[p],m=!a,g,v,b,C;for("production"!==process.env.NODE_ENV&&S(o);l<=r&&s<=p;)u(d)?d=t[++l]:u(c)?c=t[--r]:$o(d,h)?(T(d,h,i,o,s),d=t[++l],h=o[++s]):$o(c,f)?(T(c,f,i,o,p),c=t[--r],f=o[--p]):$o(d,f)?(T(d,f,i,o,p),m&&z.insertBefore(e,d.elm,z.nextSibling(c.elm)),d=t[++l],f=o[--p]):$o(c,h)?(T(c,h,i,o,s),m&&z.insertBefore(e,c.elm,d.elm),c=t[--r],h=o[++s]):(u(g)&&(g=Do(t,l,r)),v=A(h.key)?g[h.key]:B(h,t,l,r),u(v)?n(h,i,e,d.elm,!1,o,s):(b=t[v],$o(b,h)?(T(b,h,i,o,s),t[v]=void 0,m&&z.insertBefore(e,b.elm,d.elm)):n(h,i,e,d.elm,!1,o,s)),h=o[++s]);l>r?(C=u(o[p+1])?null:o[p+1].elm,y(e,C,o,s,p,i)):s>p&&w(t,l,r)}function S(e){for(var t={},o=0;o<e.length;o++){var a=e[o],l=a.key;A(l)&&(t[l]?Tl("Duplicate keys detected: '"+l+"'. This may cause an update error.",a.context):t[l]=!0)}}function B(e,t,o,a){for(var l=o,n;l<a;l++)if(n=t[l],A(n)&&$o(e,n))return l}function T(e,t,o,a,l,n){if(e!==t){A(t.elm)&&A(a)&&(t=a[l]=U(t));var s=t.elm=e.elm;if(h(e.isAsyncPlaceholder))return void(A(t.asyncFactory.resolved)?$(e.elm,t,o):t.isAsyncPlaceholder=!0);if(h(t.isStatic)&&h(e.isStatic)&&t.key===e.key&&(h(t.isCloned)||h(t.isOnce)))return void(t.componentInstance=e.componentInstance);var r=t.data,d;A(r)&&A(d=r.hook)&&A(d=d.prepatch)&&d(e,t);var c=e.children,p=t.children;if(A(r)&&f(t)){for(d=0;d<D.update.length;++d)D.update[d](e,t);A(d=r.hook)&&A(d=d.update)&&d(e,t)}u(t.text)?A(c)&&A(p)?c!==p&&k(s,c,p,o,n):A(p)?("production"!==process.env.NODE_ENV&&S(p),A(e.text)&&z.setTextContent(s,""),y(s,null,p,0,p.length-1,o)):A(c)?w(c,0,c.length-1):A(e.text)&&z.setTextContent(s,""):e.text!==t.text&&z.setTextContent(s,t.text),A(r)&&A(d=r.hook)&&A(d=d.postpatch)&&d(e,t)}}function _(e,t,o){if(h(o)&&A(e.parent))e.parent.data.pendingInsert=t;else for(var a=0;a<t.length;++a)t[a].data.hook.insert(t[a])}function $(e,t,o,a){var l=t.tag,n=t.data,s=t.children,d;if(a=a||n&&n.pre,t.elm=e,h(t.isComment)&&A(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if("production"!==process.env.NODE_ENV&&!P(e,t,a))return!1;if(A(n)&&(A(d=n.hook)&&A(d=d.init)&&d(t,!0),A(d=t.componentInstance)))return r(t,o),!0;if(A(l)){if(A(s))if(!e.hasChildNodes())p(t,s,o);else if(!(A(d=n)&&A(d=d.domProps)&&A(d=d.innerHTML))){for(var c=!0,u=e.firstChild,f=0;f<s.length;f++){if(!u||!$(u,s[f],o,a)){c=!1;break}u=u.nextSibling}if(!c||u)return"production"===process.env.NODE_ENV||"undefined"==typeof console||R||(R=!0,console.warn("Parent: ",e),console.warn("Mismatching childNodes vs. VNodes: ",e.childNodes,s)),!1}else if(d!==e.innerHTML)return"production"===process.env.NODE_ENV||"undefined"==typeof console||R||(R=!0,console.warn("Parent: ",e),console.warn("server innerHTML: ",d),console.warn("client innerHTML: ",e.innerHTML)),!1;if(A(n)){var m=!1;for(var v in n)if(!O(v)){m=!0,g(t,o);break}!m&&n["class"]&&Te(n["class"])}}else e.data!==t.text&&(e.data=t.text);return!0}function P(e,t,o){return A(t.tag)?0===t.tag.indexOf("vue-component")||!l(t,o)&&t.tag.toLowerCase()===(e.tagName&&e.tagName.toLowerCase()):e.nodeType===(t.isComment?8:3)}var D={},F=e.modules,z=e.nodeOps,L,M;for(L=0;L<ls.length;++L)for(D[ls[L]]=[],M=0;M<F.length;++M)A(F[M][ls[L]])&&D[ls[L]].push(F[M][ls[L]]);var V=0,R=!1,O=E("attrs,class,staticClass,staticStyle,key");return function(e,o,a,l){if(u(o))return void(A(e)&&C(e));var s=!1,r=[];if(u(e))s=!0,n(o,r);else{var d=A(e.nodeType);if(!d&&$o(e,o))T(e,o,r,null,null,l);else{if(d){if(1===e.nodeType&&e.hasAttribute("data-server-rendered")&&(e.removeAttribute("data-server-rendered"),a=!0),h(a)){if($(e,o,r))return _(o,r,!0),e;"production"!==process.env.NODE_ENV&&Tl("The client-side rendered virtual DOM tree is not matching server-rendered content. This is likely caused by incorrect HTML markup, for example nesting block-level elements inside <p>, or missing <tbody>. Bailing hydration and performing full client-side render.")}e=t(e)}var c=e.elm,p=z.parentNode(c);if(n(o,r,c._leaveCb?null:p,z.nextSibling(c)),A(o.parent))for(var m=o.parent,g=f(o);m;){for(var v=0;v<D.destroy.length;++v)D.destroy[v](m);if(m.elm=o.elm,g){for(var y=0;y<D.create.length;++y)D.create[y](as,m);var b=m.data.hook.insert;if(b.merged)for(var x=1;x<b.fns.length;x++)b.fns[x]()}else _o(m);m=m.parent}A(p)?w([e],0,0):A(e.tag)&&C(e)}}return _(o,r,s),o.elm}}({nodeOps:is,modules:Ss});Al&&document.addEventListener("selectionchange",function(){var e=document.activeElement;e&&e.vmodel&&xi(e,"input")});var Ts={inserted:function(e,t,o,i){"select"===o.tag?(i.elm&&!i.elm._vOptions?De(o,"postpatch",function(){Ts.componentUpdated(e,t,o)}):gi(e,t,o.context),e._vOptions=[].map.call(e.options,bi)):("textarea"===o.tag||os(e.type))&&(e._vModifiers=t.modifiers,!t.modifiers.lazy&&(e.addEventListener("compositionstart",Ci),e.addEventListener("compositionend",wi),e.addEventListener("change",wi),Al&&(e.vmodel=!0)))},componentUpdated:function(e,t,o){if("select"===o.tag){gi(e,t,o.context);var a=e._vOptions,l=e._vOptions=[].map.call(e.options,bi);if(l.some(function(e,t){return!F(e,a[t])})){var n=e.multiple?t.value.some(function(e){return yi(e,l)}):t.value!==t.oldValue&&yi(t.value,l);n&&xi(e,"change")}}}},_s={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]},$s=function(e){return e.tag||We(e)},Ps=function(e){return"show"===e.name},Ds=$({tag:String,moveClass:String},_s);delete Ds.mode;ro.config.mustUseProp=function(e,t,o){return"value"===o&&Un(e)&&"button"!==t||"selected"===o&&"option"===e||"checked"===o&&"input"===e||"muted"===o&&"video"===e},ro.config.isReservedTag=es,ro.config.isReservedAttr=Hn,ro.config.getTagNamespace=function(e){return Zn(e)?"svg":"math"===e?"math":void 0},ro.config.isUnknownElement=function(e){if(!rl)return!0;if(es(e))return!1;if(e=e.toLowerCase(),null!=ts[e])return ts[e];var t=document.createElement(e);return-1<e.indexOf("-")?ts[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:ts[e]=/HTMLUnknownElement/.test(t.toString())},$(ro.options.directives,{model:Ts,show:{bind:function(e,t,o){var i=t.value;o=ki(o);var a=o.data&&o.data.transition,l=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;i&&a?(o.data.show=!0,pi(o,function(){e.style.display=l})):e.style.display=i?l:"none"},update:function(e,t,o){var i=t.value,a=t.oldValue;if(!i!=!a){o=ki(o);var l=o.data&&o.data.transition;l?(o.data.show=!0,i?pi(o,function(){e.style.display=e.__vOriginalDisplay}):ui(o,function(){e.style.display="none"})):e.style.display=i?e.__vOriginalDisplay:"none"}},unbind:function(e,t,o,i,a){a||(e.style.display=e.__vOriginalDisplay)}}}),$(ro.options.components,{Transition:{name:"transition",props:_s,abstract:!0,render:function(e){var t=this,o=this.$slots.default;if(o&&(o=o.filter($s),!!o.length)){"production"!==process.env.NODE_ENV&&1<o.length&&Tl("<transition> can only be used on a single element. Use <transition-group> for lists.",this.$parent);var i=this.mode;"production"!==process.env.NODE_ENV&&i&&"in-out"!==i&&"out-in"!==i&&Tl("invalid <transition> mode: "+i,this.$parent);var a=o[0];if(Ti(this.$vnode))return a;var l=Ei(a);if(!l)return a;if(this._leaving)return Bi(e,a);var n="__transition-"+this._uid+"-";l.key=null==l.key?l.isComment?n+"comment":n+l.tag:m(l.key)?0===(l.key+"").indexOf(n)?l.key:n+l.key:l.key;var s=(l.data||(l.data={})).transition=Si(this),r=this._vnode,d=Ei(r);if(l.data.directives&&l.data.directives.some(Ps)&&(l.data.show=!0),d&&d.data&&!_i(l,d)&&!We(d)&&!(d.componentInstance&&d.componentInstance._vnode.isComment)){var c=d.data.transition=$({},s);if("out-in"===i)return this._leaving=!0,De(c,"afterLeave",function(){t._leaving=!1,t.$forceUpdate()}),Bi(e,a);if("in-out"===i){if(We(l))return r;var p=function(){u()},u;De(s,"afterEnter",p),De(s,"enterCancelled",p),De(c,"delayLeave",function(e){u=e})}}return a}}},TransitionGroup:{props:Ds,beforeMount:function(){var e=this,t=this._update;this._update=function(o,i){var a=Dt(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,a(),t.call(e,o,i)}},render:function(e){for(var t=this.tag||this.$vnode.data.tag||"span",o=Object.create(null),a=this.prevChildren=this.children,l=this.$slots.default||[],n=this.children=[],s=Si(this),r=0,d;r<l.length;r++)if(d=l[r],d.tag)if(null!=d.key&&0!==(d.key+"").indexOf("__vlist"))n.push(d),o[d.key]=d,(d.data||(d.data={})).transition=s;else if("production"!==process.env.NODE_ENV){var p=d.componentOptions,u=p?p.Ctor.options.name||p.tag||"":d.tag;Tl("<transition-group> children must be keyed: <"+u+">")}if(a){for(var A=[],h=[],f=0,m;f<a.length;f++)m=a[f],m.data.transition=s,m.data.pos=m.elm.getBoundingClientRect(),o[m.key]?A.push(m):h.push(m);this.kept=e(t,null,A),this.removed=h}return e(t,null,n)},updated:function(){var e=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,t)&&(e.forEach($i),e.forEach(Pi),e.forEach(Di),this._reflow=document.body.offsetHeight,e.forEach(function(e){if(e.data.moved){var o=e.elm,i=o.style;li(o,t),i.transform=i.WebkitTransform=i.transitionDuration="",o.addEventListener(gs,o._moveCb=function i(a){a&&a.target!==o||(!a||/transform$/.test(a.propertyName))&&(o.removeEventListener(gs,i),o._moveCb=null,ni(o,t))})}}))},methods:{hasMove:function(e,t){if(!fs)return!1;if(this._hasMove)return this._hasMove;var o=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach(function(e){oi(o,e)}),ti(o,t),o.style.display="none",this.$el.appendChild(o);var i=ri(o);return this.$el.removeChild(o),this._hasMove=i.hasTransform}}}}),ro.prototype.__patch__=rl?Bs:D,ro.prototype.$mount=function(e,t){return e=e&&rl?To(e):void 0,zt(this,e,t)},rl&&setTimeout(function(){al.devtools&&(kl?kl.emit("init",ro):"production"!==process.env.NODE_ENV&&"test"!==process.env.NODE_ENV&&console[console.info?"info":"log"]("Download the Vue Devtools extension for a better development experience:\nhttps://github.com/vuejs/vue-devtools")),"production"!==process.env.NODE_ENV&&"test"!==process.env.NODE_ENV&&!1!==al.productionTip&&"undefined"!=typeof console&&console[console.info?"info":"log"]("You are running Vue in development mode.\nMake sure to turn on production mode when deploying for production.\nSee more tips at https://vuejs.org/guide/deployment.html")},0);var Fs={props:{value:{type:String,default:""},interactive:{type:Boolean,default:!1}},data(){return{uid:"",table:null,cell:null,row:null,colPos:0,rect:null}},computed:{listeners(){return{...this.$listeners,input:this.onInput}},err(){return this.validate?this.validate(this.value):""},filterRowTop(){return this.cell?{top:this.cell.offsetTop+"px"}:{}}},watch:{value(e){e!==this.$el.textContent&&(this.$refs.cell.textContent=e)}},mounted(){this.uid="uid"+this._uid,this.cell=this.$refs.cell,this.cell.textContent=this.value,this.row=this.cell.parentNode,this.thead=this.row.parentNode,this.colPos=Array.from(this.row.children).indexOf(this.cell)-1,this.colLabel=this.thead.children[0].children[this.colPos+1]},methods:{updateValue(t){const e=t.target.textContent;this.value!==e&&this.$emit("input",e)},onInput(t){this.interactive&&this.updateValue(t)},onFocus(){setTimeout(()=>{this.colLabel.classList.add("focus"),this.selectAll(this.cell),this.$parent.currentColPos=this.colPos,this.$parent.currentRowPos=-1,this.$parent.labelTr.children[this.$parent.currentColPos+1].classList.add("focus")},0)},selectAll(e){const t=window.getSelection();if(t){const o=document.createRange();o.selectNodeContents(e),t.removeAllRanges(),t.addRange(o)}},onBlur(t){this.updateValue(t),this.colLabel.classList.remove("focus"),t.target.classList.remove("edit")},keyWest(t){const e=document.getSelection();if(t.target.textContent===e.toString()||0===e.focusOffset){let e=t.target.previousElementSibling;for(;e&&e.style&&"none"===e.style.display;)e=e.previousElementSibling;return e?(e.focus&&e.focus(),e):e}return t.target},keyEast(t){const e=document.getSelection();if(t.target.textContent===e.toString()||e.focusOffset>=t.target.textContent.length){let e=t.target.nextElementSibling;for(;e&&e.style&&"none"===e.style.display;)e=e.nextElementSibling;return e?(e.focus&&e.focus(),e):e}return t.target},keyEnter(t){t.preventDefault(),this.selectAll(this.cell),this.updateValue(t)},keyDelete(t){""===t.target.textContent&&setTimeout(this.updateValue(t),0)},mouseMove(t){this.cell.style.cursor=15>this.cell.offsetWidth-t.offsetX?"pointer":"text"},mouseDown(t){0===t.button&&15>this.cell.offsetWidth-t.offsetX&&(t.preventDefault(),setTimeout(()=>{this.$parent.$refs.panelFilter.showPanel(this)},0))}}};const zs="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());let Ls;const Ms={};/* template */var Vs=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("td",e._g({ref:"cell",staticClass:"cell column-filter",style:e.filterRowTop,attrs:{id:e.uid,contenteditable:"",ondragenter:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",ondragover:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",tabindex:"-1"},on:{focus:e.onFocus,blur:e.onBlur,keydown:[function(t){return t.type.indexOf("key")||37===t.keyCode?t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyWest.apply(null,arguments):null},function(t){return t.type.indexOf("key")||39===t.keyCode?t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyEast.apply(null,arguments):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyEnter.apply(null,arguments)}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyDelete.apply(null,arguments)},mousemove:e.mouseMove,mousedown:e.mouseDown}},e.listeners))};Vs._withStripped=!0;/* style */const Rs=/*#__PURE__*/Fi({render:Vs,staticRenderFns:[]},function(e){e&&e("data-v-315d85bd_0",{source:"\n.column-filter[data-v-315d85bd] {\r\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAABuCAMAAAAwApxlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE4UExURQAAAAAAAICAgFVVVUBAQICAgGZmZoCAgJKSko6OjmZmZoCAgHZ2doCAgIiIiHh4eIeHh4CAgHl5eXl5eYaGhoWFhYCAgIWFhXt7e4SEhIODg4CAgICAgH19fYKCgoCAgISEhIKCgn19fX19fYKCgoCAgH5+foGBgX5+foCAgHx8fH19fYCAgH5+foCAgHx8fH5+fn5+foGBgYCAgH5+fn5+foCAgIODg4CAgIGBgYODg3x8fICAgIGBgYCAgICAgH9/f39/f4CAgH9/f4CAgICAgH9/f4CAgIGBgYSEhIODg39/f4CAgH9/f4CAgICAgICAgH9/f4CAgH5+fn9/f35+foCAgIKCgoSEhIODg39/f4CAgIKCgoSEhH9/f4GBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiW6rGxQAAABedFJOUwABAgMEBAUGBwkKCg0ODxEREhMVFRcYGRsfJSowMTE0NDU7Pz9CQ0VNUFReXl9gZ2ttb3BxdXh5fH19f4CAgoWLkZqbnqChoaSkqqurra28wsXFydXW1tbq7u/x+fuJeTf3AAAACXBIWXMAABbqAAAW6gHljkMQAAABFUlEQVRoQ+3X11LCUBSF4RAEVFCwYEXFgr0g9gLYexcbahLDOcn7v4HArGfYmWHWd7X/q3O39xyDiIiIiIiIiIgoKOHORLwNs7DuhVK5tDyEkrX45Svv9wAla8e3LEvd9CElmXu6/nbtIY0WtaEcx9EXHUhRmdv3t8rjPEpYOjc3O4yZqFWlxrOZILZa3cjx88vTySRKVl65f653GkVKihS95j4fQEsy95t37K4fLWrpR9eUexRCihosXJ6dH46ihMWSval2zEQtyhzLb65PhVGyZl6r39XKKkrWlmfbtneVQEqKFBt/A/c+iFsS2m3cMX3dhRaV+/C1/7mGkhWfWNkuTPegxEVjGIiIiIiIiIiIiIJlGP8KtCi1NMvKyQAAAABJRU5ErkJggg==');\r\n  background-repeat: no-repeat;\r\n  background-size: 36px;\r\n  background-position: right -12px top -1px;\n}\r\n\r\n",map:{version:3,sources:["C:\\Projects\\vue-excel-editor\\src\\VueExcelFilter.vue"],names:[],mappings:";AA6JA;EACA,+mCAAA;EACA,4BAAA;EACA,qBAAA;EACA,yCAAA;AACA",file:"VueExcelFilter.vue",sourcesContent:["<template>\r\n  <td\r\n    :id=\"uid\"\r\n    ref=\"cell\"\r\n    contenteditable\r\n    ondragenter=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\r\n    ondragover=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\r\n    class=\"cell column-filter\"\r\n    :style=\"filterRowTop\"\r\n    autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\r\n    tabindex=\"-1\"\r\n    v-on=\"listeners\"\r\n    @focus=\"onFocus\"\r\n    @blur=\"onBlur\"\r\n    @keydown.exact.37=\"keyWest\"\r\n    @keydown.exact.39=\"keyEast\"\r\n    @keydown.exact.enter=\"keyEnter\"\r\n    @keyup.exact.delete=\"keyDelete\"\r\n    @mousemove=\"mouseMove\"\r\n    @mousedown=\"mouseDown\" />\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    value: {type: String, default: ''},\r\n    interactive: {type: Boolean, default: false}\r\n  },\r\n  data () {\r\n    return {\r\n      uid: '',\r\n      table: null,\r\n      cell: null,\r\n      row: null,\r\n      colPos: 0,\r\n      rect: null\r\n    }\r\n  },\r\n  computed: {\r\n    listeners () {\r\n      return {\r\n        ...this.$listeners, input: this.onInput\r\n      }\r\n    },\r\n    err () {\r\n      if (this.validate)\r\n        return this.validate(this.value)\r\n      return ''\r\n    },\r\n    filterRowTop () {\r\n      if (this.cell) return {top: this.cell.offsetTop + 'px'}\r\n      else return {}\r\n    },\r\n  },\r\n  watch: {\r\n    value (newVal) {\r\n      if (newVal !== this.$el.textContent)\r\n        this.$refs.cell.textContent = newVal\r\n    }\r\n  },\r\n  mounted () {\r\n    this.uid = 'uid' + this._uid\r\n    // remember the first value\r\n\r\n    // Convert the value into html\r\n    this.cell = this.$refs.cell\r\n    this.cell.textContent = this.value\r\n\r\n    // Store the DOM neighbour\r\n    this.row = this.cell.parentNode\r\n    this.thead = this.row.parentNode\r\n    this.colPos = Array.from(this.row.children).indexOf(this.cell) - 1\r\n    this.colLabel = this.thead.children[0].children[this.colPos + 1]\r\n  },\r\n  methods: {\r\n    updateValue (e) {\r\n      const content = e.target.textContent\r\n      if (this.value !== content)\r\n        this.$emit('input', content)\r\n    },\r\n    onInput (e) {\r\n      if (this.interactive)\r\n        this.updateValue(e)\r\n    },\r\n    onFocus () {\r\n      setTimeout(() => {\r\n        this.colLabel.classList.add('focus')\r\n        // document.execCommand('selectAll', false, null)\r\n        this.selectAll(this.cell)\r\n        this.$parent.currentColPos = this.colPos\r\n        this.$parent.currentRowPos = -1\r\n        this.$parent.labelTr.children[this.$parent.currentColPos + 1].classList.add('focus')\r\n      }, 0)\r\n    },\r\n    selectAll(node) {\r\n      const selection = window.getSelection()\r\n      if (selection) {\r\n        const range = document.createRange()\r\n        range.selectNodeContents(node)\r\n        selection.removeAllRanges()\r\n        selection.addRange(range)\r\n      }\r\n    },\r\n    onBlur (e) {\r\n      this.updateValue(e)\r\n      this.colLabel.classList.remove('focus')\r\n      e.target.classList.remove('edit')\r\n    },\r\n    keyWest (e) {\r\n      const sel = document.getSelection()\r\n      if (e.target.textContent === sel.toString() || sel.focusOffset === 0) {\r\n        let td = e.target.previousElementSibling\r\n        while (td && td.style && td.style.display === 'none') td = td.previousElementSibling\r\n        if (!td) return td\r\n        if (td.focus) td.focus()\r\n        return td\r\n      }\r\n      return e.target\r\n    },\r\n    keyEast (e) {\r\n      const sel = document.getSelection()\r\n      if (e.target.textContent === sel.toString() || sel.focusOffset >= e.target.textContent.length) {\r\n        let td = e.target.nextElementSibling\r\n        while (td && td.style && td.style.display === 'none') td = td.nextElementSibling\r\n        if (!td) return td\r\n        if (td.focus) td.focus()\r\n        return td\r\n      }\r\n      return e.target\r\n    },\r\n    keyEnter (e) {\r\n      e.preventDefault()\r\n      // document.execCommand('selectAll', false, null)\r\n      this.selectAll(this.cell)\r\n      // if (!this.$parent.keyEast(e))\r\n      this.updateValue(e)\r\n    },\r\n    keyDelete (e) {\r\n      if (e.target.textContent === '')\r\n        setTimeout(this.updateValue(e), 0)\r\n    },\r\n    mouseMove (e) {\r\n      this.cell.style.cursor = this.cell.offsetWidth - e.offsetX < 15 ? 'pointer' : 'text'\r\n    },\r\n    mouseDown (e) {\r\n      if (e.button === 0 && this.cell.offsetWidth - e.offsetX < 15) {\r\n        e.preventDefault()\r\n        setTimeout(() => {\r\n          // this.$parent.showFilterPanel(this)\r\n          this.$parent.$refs.panelFilter.showPanel(this)\r\n        }, 0)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.column-filter {\r\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAABuCAMAAAAwApxlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE4UExURQAAAAAAAICAgFVVVUBAQICAgGZmZoCAgJKSko6OjmZmZoCAgHZ2doCAgIiIiHh4eIeHh4CAgHl5eXl5eYaGhoWFhYCAgIWFhXt7e4SEhIODg4CAgICAgH19fYKCgoCAgISEhIKCgn19fX19fYKCgoCAgH5+foGBgX5+foCAgHx8fH19fYCAgH5+foCAgHx8fH5+fn5+foGBgYCAgH5+fn5+foCAgIODg4CAgIGBgYODg3x8fICAgIGBgYCAgICAgH9/f39/f4CAgH9/f4CAgICAgH9/f4CAgIGBgYSEhIODg39/f4CAgH9/f4CAgICAgICAgH9/f4CAgH5+fn9/f35+foCAgIKCgoSEhIODg39/f4CAgIKCgoSEhH9/f4GBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiW6rGxQAAABedFJOUwABAgMEBAUGBwkKCg0ODxEREhMVFRcYGRsfJSowMTE0NDU7Pz9CQ0VNUFReXl9gZ2ttb3BxdXh5fH19f4CAgoWLkZqbnqChoaSkqqurra28wsXFydXW1tbq7u/x+fuJeTf3AAAACXBIWXMAABbqAAAW6gHljkMQAAABFUlEQVRoQ+3X11LCUBSF4RAEVFCwYEXFgr0g9gLYexcbahLDOcn7v4HArGfYmWHWd7X/q3O39xyDiIiIiIiIiIgoKOHORLwNs7DuhVK5tDyEkrX45Svv9wAla8e3LEvd9CElmXu6/nbtIY0WtaEcx9EXHUhRmdv3t8rjPEpYOjc3O4yZqFWlxrOZILZa3cjx88vTySRKVl65f653GkVKihS95j4fQEsy95t37K4fLWrpR9eUexRCihosXJ6dH46ihMWSval2zEQtyhzLb65PhVGyZl6r39XKKkrWlmfbtneVQEqKFBt/A/c+iFsS2m3cMX3dhRaV+/C1/7mGkhWfWNkuTPegxEVjGIiIiIiIiIiIiIJlGP8KtCi1NMvKyQAAAABJRU5ErkJggg==');\r\n  background-repeat: no-repeat;\r\n  background-size: 36px;\r\n  background-position: right -12px top -1px;\r\n}\r\n\r\n</style>\r\n"]},media:void 0})},Fs,"data-v-315d85bd",!1,void 0,!1,zi,void 0,void 0);/* scoped */var Os={props:{nFilterCount:{type:Number,default:1e3},localizedLabel:{type:Object,default(){return{sortingAndFiltering:"Sorting And Filtering",sortAscending:"Sort Ascending",sortDescending:"Sort Descending",near:"\u2252 Near",exactMatch:"= Exact Match",notMatch:"\u2260 Not Match",greaterThan:"&gt; Greater Than",greaterThanOrEqualTo:"\u2265 Greater Than or Equal To",lessThan:"&lt; Less Than",lessThanOrEqualTo:"\u2264 Less Than Or Equal To",regularExpression:"~ Regular Expression",customFilter:"Custom Filter",listFirstNValuesOnly:e=>`List first ${e} values only`,apply:"Apply"}}}},data(){return{show:!1,showDropdown:!1,processing:!1,columnFilterRef:null,inputFilter:"",inputFilterCondition:"",sortedUniqueValueList:[]}},computed:{filteredSortedUniqueValueList(){const e=this.inputFilter.toUpperCase();return this.sortedUniqueValueList.filter(t=>t.toUpperCase().startsWith(e))},symbol(){switch(this.inputFilterCondition){case"":return"\u2252";case"<=":return"\u2264";case">=":return"\u2265";case"<>":return"\u2260";default:return this.inputFilterCondition;}}},methods:{clickOutside(t){"panelModal"===t.target.id&&this.hidePanel()},sort(e){this.hidePanel(),this.$parent.sort(e,this.columnFilterRef.colPos)},setFilterCondition(e){this.showDropdown=!1,this.inputFilterCondition=e,this.$refs.inputFilter.focus()},freezePanelSizeAfterShown(){const e=this.$refs.panelList,t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},removePanelSizeAfterHide(){const e=this.$refs.panelList;e.removeAttribute("style")},doInputFilter(){window.delay&&clearTimeout(window.delay),window.delay=setTimeout(()=>{this.inputFilter=this.$refs.inputFilter.value},200)},doFilter(){const e=this.inputFilterCondition+this.$refs.inputFilter.value;this.columnFilterRef.$el.textContent=e,this.columnFilterRef.$emit("input",e),this.hidePanel()},filterPanelSelect(e){this.columnFilterRef.$el.textContent="="+e,this.columnFilterRef.$emit("input","="+e),this.hidePanel()},showPanel(e){this.columnFilterRef=e,this.inputFilter="",this.inputFilterCondition="",this.sortedUniqueValueList=[],this.$refs.inputFilter.value="",""!=this.columnFilterRef.$el.textContent&&(this.columnFilterRef.$el.textContent="",this.columnFilterRef.$emit("input",""),this.$parent.calTable()),setTimeout(()=>{this.show=!0,setTimeout(()=>this.$refs.inputFilter.focus());const t={},o=this.$parent.fields[e.colPos].name;this.$parent.table.forEach(e=>t[e[o]]=!0);const i=Object.keys(t);i.sort(),0<i.length&&""===i[0]&&(i[0]=" "),this.sortedUniqueValueList=i,setTimeout(()=>this.freezePanelSizeAfterShown())})},hidePanel(){this.show=!1,this.removePanelSizeAfterHide(),setTimeout(()=>{this.sortedUniqueValueList=[]},0)}}};/* script */ /* template */var Is=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"panel-modal",attrs:{id:"panelModal"},on:{click:e.clickOutside,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.hidePanel.apply(null,arguments)}}},[o("div",{ref:"panelFilter",staticClass:"panel-body"},[o("div",{staticClass:"panel-title"},[o("svg",{staticClass:"svg-inline--fa fa-sort-amount-down fa-w-16 fa-1x",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-amount-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M304 416h-64a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-128-64h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.37 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm256-192H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h192a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-64 128H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM496 32H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h256a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.sortingAndFiltering)}})]),e._v(" "),o("div",{staticClass:"panel-content"},[o("div",{staticClass:"panel-action"},[o("button",{staticClass:"panel-button float-left",on:{click:function(){return e.sort(1)}}},[o("svg",{staticClass:"svg-inline--fa fa-sort-alpha-down fa-w-14",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-alpha-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.sortAscending)}})]),e._v(" "),o("button",{staticClass:"panel-button float-right",on:{click:function(){return e.sort(-1)}}},[o("svg",{staticClass:"svg-inline--fa fa-sort-alpha-up-alt fa-w-14",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-alpha-up-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M16 160h48v304a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V160h48c14.21 0 21.38-17.24 11.31-27.31l-80-96a16 16 0 0 0-22.62 0l-80 96C-5.35 142.74 1.78 160 16 160zm272 64h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 65.63V48a16 16 0 0 0-16-16H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 190.37V208a16 16 0 0 0 16 16zm159.06 234.62l-59.27-160A16 16 0 0 0 372.72 288h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 480h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 480H432a16 16 0 0 0 15.06-21.38zM335.61 400L352 352l16.39 48z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.sortDescending)}})])]),e._v(" "),o("div",{staticClass:"panel-action"},[o("div",[o("button",{staticClass:"panel-input-button",on:{click:function(){e.showDropdown=!e.showDropdown}}},[e._v(e._s(e.symbol))]),e._v(" "),o("div",{staticClass:"panel-dropdown",class:{show:e.showDropdown}},[o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.near)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("=")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.exactMatch)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("<>")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.notMatch)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition(">")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.greaterThan)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition(">=")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.greaterThanOrEqualTo)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("<")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.lessThan)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("<=")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.lessThanOrEqualTo)}})]),e._v(" "),o("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("~")}}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.regularExpression)}})])]),e._v(" "),o("span",{staticClass:"panel-input-b"},[o("input",{ref:"inputFilter",staticClass:"panel-input",attrs:{type:"text",placeholder:e.localizedLabel.customFilter,trim:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},on:{keyup:e.doInputFilter,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.doFilter.apply(null,arguments)}}})])])]),e._v(" "),o("div",[o("div",{ref:"panelList",staticClass:"panel-list"},e._l(e.filteredSortedUniqueValueList.slice(0,e.nFilterCount),function(t,i){return o("div",{key:i,staticClass:"panel-list-item",on:{click:function(o){return o.preventDefault(),e.filterPanelSelect(t)}}},[o("input",{staticClass:"panel-checkbox",attrs:{type:"checkbox"}}),e._v(" "),o("span",[e._v(e._s(t))])])}),0),e._v(" "),e.filteredSortedUniqueValueList.length>e.nFilterCount?o("div",{staticClass:"normal-text",staticStyle:{float:"right"}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.listFirstNValuesOnly(e.nFilterCount))}})]):e._e()])]),e._v(" "),o("div",{staticClass:"panel-footer"},[o("button",{staticClass:"panel-button",on:{click:e.doFilter}},[o("svg",{staticClass:"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sign-in-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.apply)}})])])])])};Is._withStripped=!0;/* style */const Ns=/*#__PURE__*/Fi({render:Is,staticRenderFns:[]},function(e){e&&e("data-v-72c10554_0",{source:"\ninput[data-v-72c10554]:focus, button[data-v-72c10554]:focus {\r\n  outline: none !important;\r\n  box-shadow: none !important;\n}\n.panel-modal[data-v-72c10554] {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: #0007;\r\n  z-index: 999;\r\n  font-weight: 400;\r\n  font-size: 1rem;\r\n  text-shadow: none;\n}\n.panel-body[data-v-72c10554] {\r\n  background-color: white;\r\n  position: fixed;\r\n  border-radius: 5px;\r\n  padding: 0;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  max-width: 75vh;\r\n  height: fit-content;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\n}\n.panel-title[data-v-72c10554] {\r\n  padding: 1rem;\r\n  display: flex;\r\n  color: dimgray;\r\n  font-size: 1.25rem;\r\n  line-height: 1.5rem;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  border-bottom: 1px solid lightgray;\n}\ndiv.panel-title span[data-v-72c10554], button.panel-button span[data-v-72c10554] {\r\n  margin-left: 6px;\n}\n.panel-content[data-v-72c10554] {\r\n  padding: 1rem;\r\n  text-align: left;\r\n  overflow-y: scroll;\n}\n.panel-content .panel-button[data-v-72c10554] {\r\n  width: 48%;\r\n  background-color: #17a2b8;\n}\n.panel-action[data-v-72c10554] {\r\n  display: inline-block;\r\n  margin-bottom: 0.5rem;\r\n  width: 100%;\r\n  position: relative;\r\n  white-space: nowrap;\n}\n.panel-input-b[data-v-72c10554] {\r\n  display: inline-block;\r\n  border-top-right-radius: 4px;\r\n  border-bottom-right-radius: 4px;\r\n  width: calc(100% - 2.2rem);\r\n  border: 1px solid lightgray;\r\n  border-left: 0;\r\n  margin-left: -4px;\r\n  height: 2.3rem;\n}\n.panel-input[data-v-72c10554] {\r\n  border: 0;\r\n  box-shadow: none;\r\n  padding: 0.6rem;\r\n  width: calc(100% - 2.2rem);\r\n  font-size: 0.88rem;\r\n  background-color: transparent;\n}\n.panel-input-button[data-v-72c10554] {\r\n  border-top-left-radius: 4px;\r\n  border-bottom-left-radius: 4px;\r\n  color: white;\r\n  background-color: #28a745;\r\n  border: 1px solid #28a745;\r\n  font-size: 1.3rem;\r\n  width: 2.2rem;\r\n  height: 2.35rem;\r\n  vertical-align: -2px;\r\n  cursor: pointer;\n}\n.panel-dropdown[data-v-72c10554] {\r\n  z-index: 50;\r\n  position: absolute;\r\n  left: 0;\r\n  top: 2.4rem;\r\n  display: inline-block;\r\n  background-color: white;\r\n  border: 1px solid gray;\r\n  margin-top: -1px;\r\n  display: none;\n}\n.panel-dropdown.show[data-v-72c10554] {\r\n  display: inline-block;\n}\n.panel-dropdown-item[data-v-72c10554] {\r\n  padding: 0.35rem 0.65rem;\r\n  cursor: pointer;\n}\n.panel-dropdown-item[data-v-72c10554]:hover {\r\n  background-color: lightskyblue;\n}\n.panel-dropdown-item span[data-v-72c10554] {\r\n  margin-right: 6px;\r\n  color: gray;\n}\n.panel-dropdown-item[data-v-72c10554]:not(:last-child) {\r\n  border-bottom: 1px solid lightgray;\n}\n.panel-footer[data-v-72c10554] {\r\n  display: flex;\r\n  padding: 1rem;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  border-top: 1px solid lightgray;\n}\n.panel-button[data-v-72c10554] {\r\n  width: 120px;\r\n  font-size: 0.88rem;\r\n  border-radius: 5px;\r\n  border: 0;\r\n  background-color: #007bff;\r\n  color: white;\r\n  padding: 0.6rem;\r\n  cursor: pointer;\n}\n.float-left[data-v-72c10554] {\r\n  float: left !important;\n}\n.float-right[data-v-72c10554] {\r\n  float: right !important;\n}\n.panel-list[data-v-72c10554] {\r\n  overflow-y: scroll;\r\n  max-height: 20rem;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 0.25rem;\r\n  display: flex;\r\n  flex-direction: column;\n}\n.panel-checkbox[data-v-72c10554] {\r\n  vertical-align: 2px;\n}\n.panel-list span[data-v-72c10554] {\r\n  margin-left: 10px;\r\n  color: gray;\n}\n.panel-list-item[data-v-72c10554] {\r\n  padding: 10px 10px;\r\n  font-size: 0.88rem;\r\n  cursor: pointer;\r\n  white-space: nowrap;\n}\n.panel-list-item[data-v-72c10554]:hover {\r\n  background-color: lightskyblue;\n}\n.panel-list-item[data-v-72c10554]:not(:last-child) {\r\n  border-bottom: 1px solid lightgray;\n}\n.normal-text[data-v-72c10554] {\r\n  font-size: 0.88rem;\r\n  color: gray;\n}\n.fa-spin[data-v-72c10554] {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-72c10554] {\r\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-72c10554] {\r\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-72c10554] {\r\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-72c10554] {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-72c10554] {\r\n  text-align: center;\r\n  width: 1.25em;\n}\n.fa-xs[data-v-72c10554] {\r\n  font-size: 0.75em;\n}\n.fa-sm[data-v-72c10554] {\r\n  font-size: 0.875em;\n}\n.fa-1x[data-v-72c10554] {\r\n  font-size: 1em;\n}\n.fa-2x[data-v-72c10554] {\r\n  font-size: 2em;\n}\n.fa-3x[data-v-72c10554] {\r\n  font-size: 3em;\n}\r\n",map:{version:3,sources:["C:\\Projects\\vue-excel-editor\\src\\panelFilter.vue"],names:[],mappings:";AA2NA;EACA,wBAAA;EACA,2BAAA;AACA;AAEA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,YAAA;EACA,aAAA;EACA,gBAAA;EACA,uBAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,SAAA;EACA,gCAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,cAAA;EACA,kBAAA;EACA,mBAAA;EACA,mBAAA;EACA,2BAAA;EACA,kCAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,aAAA;EACA,gBAAA;EACA,kBAAA;AACA;AAEA;EACA,UAAA;EACA,yBAAA;AACA;AAEA;EACA,qBAAA;EACA,qBAAA;EACA,WAAA;EACA,kBAAA;EACA,mBAAA;AACA;AAEA;EACA,qBAAA;EACA,4BAAA;EACA,+BAAA;EACA,0BAAA;EACA,2BAAA;EACA,cAAA;EACA,iBAAA;EACA,cAAA;AACA;AACA;EACA,SAAA;EACA,gBAAA;EACA,eAAA;EACA,0BAAA;EACA,kBAAA;EACA,6BAAA;AACA;AACA;EACA,2BAAA;EACA,8BAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,iBAAA;EACA,aAAA;EACA,eAAA;EACA,oBAAA;EACA,eAAA;AACA;AAEA;EACA,WAAA;EACA,kBAAA;EACA,OAAA;EACA,WAAA;EACA,qBAAA;EACA,uBAAA;EACA,sBAAA;EACA,gBAAA;EACA,aAAA;AACA;AAEA;EACA,qBAAA;AACA;AACA;EACA,wBAAA;EACA,eAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,iBAAA;EACA,WAAA;AACA;AACA;EACA,kCAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,mBAAA;EACA,yBAAA;EACA,+BAAA;AACA;AAEA;EACA,YAAA;EACA,kBAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;EACA,YAAA;EACA,eAAA;EACA,eAAA;AACA;AAEA;EACA,sBAAA;AACA;AAEA;EACA,uBAAA;AACA;AAEA;EACA,kBAAA;EACA,iBAAA;EACA,yBAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;EACA,iBAAA;EACA,WAAA;AACA;AACA;EACA,kBAAA;EACA,kBAAA;EACA,eAAA;EACA,mBAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,kCAAA;AACA;AACA;EACA,kBAAA;EACA,WAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA",file:"panelFilter.vue",sourcesContent:["<template>\r\n  <div id=\"panelModal\" v-show=\"show\" class=\"panel-modal\" @click=\"clickOutside\" @keydown.exact.esc=\"hidePanel\">\r\n    <div ref=\"panelFilter\"\r\n         class=\"panel-body\">\r\n      <div class=\"panel-title\">\r\n        <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sort-amount-down\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-sort-amount-down fa-w-16 fa-1x\"><path fill=\"currentColor\" d=\"M304 416h-64a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-128-64h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.37 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm256-192H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h192a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-64 128H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM496 32H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h256a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z\" class=\"\"></path></svg>        \r\n        <span v-html=\"localizedLabel.sortingAndFiltering\" />\r\n      </div>\r\n      <div class=\"panel-content\">\r\n        <div class=\"panel-action\">\r\n          <button class=\"panel-button float-left\" @click=\"sort(1)\">\r\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sort-alpha-down\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-sort-alpha-down fa-w-14\"><path fill=\"currentColor\" d=\"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z\" class=\"\"></path></svg>\r\n            <span v-html=\"localizedLabel.sortAscending\" />\r\n          </button>\r\n          <button class=\"panel-button float-right\" @click=\"sort(-1)\">\r\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sort-alpha-up-alt\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-sort-alpha-up-alt fa-w-14\"><path fill=\"currentColor\" d=\"M16 160h48v304a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V160h48c14.21 0 21.38-17.24 11.31-27.31l-80-96a16 16 0 0 0-22.62 0l-80 96C-5.35 142.74 1.78 160 16 160zm272 64h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 65.63V48a16 16 0 0 0-16-16H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 190.37V208a16 16 0 0 0 16 16zm159.06 234.62l-59.27-160A16 16 0 0 0 372.72 288h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 480h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 480H432a16 16 0 0 0 15.06-21.38zM335.61 400L352 352l16.39 48z\" class=\"\"></path></svg>\r\n            <span v-html=\"localizedLabel.sortDescending\" />\r\n          </button>\r\n        </div>\r\n        <div class=\"panel-action\">\r\n          <div>\r\n            <button class=\"panel-input-button\" @click=\"showDropdown = !showDropdown\">{{ symbol }}</button>\r\n            <div :class=\"{show: showDropdown}\" class=\"panel-dropdown\">\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('')\">\r\n                <span v-html=\"localizedLabel.near\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('=')\">\r\n                <span v-html=\"localizedLabel.exactMatch\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('<>')\">\r\n                <span v-html=\"localizedLabel.notMatch\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('>')\">\r\n                <span v-html=\"localizedLabel.greaterThan\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('>=')\">\r\n                <span v-html=\"localizedLabel.greaterThanOrEqualTo\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('<')\">\r\n                <span v-html=\"localizedLabel.lessThan\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('<=')\">\r\n                <span v-html=\"localizedLabel.lessThanOrEqualTo\" />\r\n              </div>\r\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('~')\">\r\n                <span v-html=\"localizedLabel.regularExpression\" />\r\n              </div>\r\n            </div>\r\n            <span class=\"panel-input-b\">\r\n              <input type=\"text\"\r\n                     ref=\"inputFilter\"\r\n                     class=\"panel-input\"\r\n                     :placeholder=\"localizedLabel.customFilter\"\r\n                     trim autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\r\n                     @keyup=\"doInputFilter\"\r\n                     @keydown.exact.enter=\"doFilter\" />\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <div ref=\"panelList\" class=\"panel-list\">\r\n            <div v-for=\"(item, k) in filteredSortedUniqueValueList.slice(0, nFilterCount)\" :key=\"k\"\r\n                 class=\"panel-list-item\"\r\n                 @click.prevent=\"filterPanelSelect(item)\">\r\n              <input type=\"checkbox\" class=\"panel-checkbox\" />\r\n              <span>{{ item }}</span>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"filteredSortedUniqueValueList.length>nFilterCount\" class=\"normal-text\" style=\"float:right\">\r\n            <span v-html=\"localizedLabel.listFirstNValuesOnly(nFilterCount)\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"panel-footer\">\r\n        <button class=\"panel-button\" @click=\"doFilter\">\r\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sign-in-alt\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm\"><path fill=\"currentColor\" d=\"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z\" class=\"\"></path></svg>\r\n          <span v-html=\"localizedLabel.apply\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    nFilterCount: {type: Number, default: 1000},     // show top n values in filter dialog\r\n    localizedLabel: {\r\n      type: Object,\r\n      default () {\r\n        return {\r\n          sortingAndFiltering: 'Sorting And Filtering',\r\n          sortAscending: 'Sort Ascending',\r\n          sortDescending: 'Sort Descending',\r\n          near: '\u2252 Near',\r\n          exactMatch: '= Exact Match',\r\n          notMatch: '\u2260 Not Match',\r\n          greaterThan: '&gt; Greater Than',\r\n          greaterThanOrEqualTo: '\u2265 Greater Than or Equal To',\r\n          lessThan: '&lt; Less Than',\r\n          lessThanOrEqualTo: '\u2264 Less Than Or Equal To',\r\n          regularExpression: '~ Regular Expression',\r\n          customFilter: 'Custom Filter',\r\n          listFirstNValuesOnly: n => `List first ${n} values only`,\r\n          apply: 'Apply'\r\n        }\r\n      }\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      show: false,\r\n      showDropdown: false,\r\n      processing: false,\r\n      columnFilterRef: null,\r\n      inputFilter: '',\r\n      inputFilterCondition: '',\r\n      sortedUniqueValueList: []\r\n    }\r\n  },\r\n  computed: {\r\n    filteredSortedUniqueValueList () {\r\n      const filter = this.inputFilter.toUpperCase()\r\n      return this.sortedUniqueValueList.filter(item => item.toUpperCase().startsWith(filter))\r\n    },\r\n    symbol () {\r\n      switch(this.inputFilterCondition) {\r\n        case '':\r\n          return '\u2252'\r\n        case '<=':\r\n          return '\u2264'\r\n        case '>=':\r\n          return '\u2265'\r\n        case '<>':\r\n          return '\u2260'\r\n        default:\r\n          return this.inputFilterCondition\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    clickOutside (e) {\r\n      if (e.target.id === 'panelModal') this.hidePanel()\r\n    },\r\n    sort (direction) {\r\n      this.hidePanel()\r\n      this.$parent.sort(direction, this.columnFilterRef.colPos)\r\n    },\r\n    setFilterCondition(choice) {\r\n      this.showDropdown = false\r\n      this.inputFilterCondition = choice\r\n      this.$refs.inputFilter.focus()\r\n    },\r\n    freezePanelSizeAfterShown () {\r\n      const target = this.$refs.panelList\r\n      const rect = target.getBoundingClientRect()\r\n      target.setAttribute('style', `width:${rect.width}px; height:${rect.height}px;`)\r\n    },\r\n    removePanelSizeAfterHide () {\r\n      const target = this.$refs.panelList\r\n      target.removeAttribute('style')\r\n    },\r\n    doInputFilter () {\r\n      if (window.delay) clearTimeout(window.delay)\r\n      window.delay = setTimeout(() => {\r\n        this.inputFilter = this.$refs.inputFilter.value\r\n      }, 200)\r\n    },\r\n    doFilter () {\r\n      const opt = this.inputFilterCondition + this.$refs.inputFilter.value\r\n      this.columnFilterRef.$el.textContent = opt\r\n      this.columnFilterRef.$emit('input', opt)\r\n      this.hidePanel()\r\n    },\r\n    filterPanelSelect (opt) {\r\n      // this.columnFilter[this.columnFilterRef.colPos] = el  // Cannot use this, dunno why\r\n      this.columnFilterRef.$el.textContent = '=' + opt\r\n      this.columnFilterRef.$emit('input', '=' + opt)\r\n      this.hidePanel()\r\n    },\r\n    showPanel (ref) {\r\n      this.columnFilterRef = ref\r\n      this.inputFilter = ''\r\n      this.inputFilterCondition = ''\r\n      this.sortedUniqueValueList = []\r\n      this.$refs.inputFilter.value = ''\r\n      if (this.columnFilterRef.$el.textContent != '') {\r\n        this.columnFilterRef.$el.textContent = ''\r\n        this.columnFilterRef.$emit('input', '')\r\n        this.$parent.calTable()\r\n      }\r\n      setTimeout(() => {\r\n        this.show = true\r\n        setTimeout(() => (this.$refs.inputFilter.focus()))\r\n\r\n        const hash = {}\r\n        const fieldName = this.$parent.fields[ref.colPos].name\r\n        this.$parent.table.forEach(record => (hash[record[fieldName]] = true))\r\n        const keys = Object.keys(hash)\r\n        keys.sort()\r\n        if (keys.length > 0 && keys[0] === '') keys[0] = ' '\r\n        this.sortedUniqueValueList = keys\r\n        setTimeout(() => this.freezePanelSizeAfterShown())\r\n      })\r\n    },\r\n    hidePanel () {\r\n      this.show = false\r\n      this.removePanelSizeAfterHide()\r\n      setTimeout(() => {\r\n        this.sortedUniqueValueList = []\r\n      }, 0)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\ninput:focus, button:focus {\r\n  outline: none !important;\r\n  box-shadow: none !important;\r\n}\r\n\r\n.panel-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: #0007;\r\n  z-index: 999;\r\n  font-weight: 400;\r\n  font-size: 1rem;\r\n  text-shadow: none;\r\n}\r\n\r\n.panel-body {\r\n  background-color: white;\r\n  position: fixed;\r\n  border-radius: 5px;\r\n  padding: 0;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  max-width: 75vh;\r\n  height: fit-content;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.panel-title {\r\n  padding: 1rem;\r\n  display: flex;\r\n  color: dimgray;\r\n  font-size: 1.25rem;\r\n  line-height: 1.5rem;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n\r\ndiv.panel-title span, button.panel-button span {\r\n  margin-left: 6px;\r\n}\r\n\r\n.panel-content {\r\n  padding: 1rem;\r\n  text-align: left;\r\n  overflow-y: scroll;\r\n}\r\n\r\n.panel-content .panel-button {\r\n  width: 48%;\r\n  background-color: #17a2b8;\r\n}\r\n\r\n.panel-action {\r\n  display: inline-block;\r\n  margin-bottom: 0.5rem;\r\n  width: 100%;\r\n  position: relative;\r\n  white-space: nowrap;\r\n}\r\n\r\n.panel-input-b {\r\n  display: inline-block;\r\n  border-top-right-radius: 4px;\r\n  border-bottom-right-radius: 4px;\r\n  width: calc(100% - 2.2rem);\r\n  border: 1px solid lightgray;\r\n  border-left: 0;\r\n  margin-left: -4px;\r\n  height: 2.3rem;\r\n}\r\n.panel-input {\r\n  border: 0;\r\n  box-shadow: none;\r\n  padding: 0.6rem;\r\n  width: calc(100% - 2.2rem);\r\n  font-size: 0.88rem;\r\n  background-color: transparent;\r\n}\r\n.panel-input-button {\r\n  border-top-left-radius: 4px;\r\n  border-bottom-left-radius: 4px;\r\n  color: white;\r\n  background-color: #28a745;\r\n  border: 1px solid #28a745;\r\n  font-size: 1.3rem;\r\n  width: 2.2rem;\r\n  height: 2.35rem;\r\n  vertical-align: -2px;\r\n  cursor: pointer;\r\n}\r\n\r\n.panel-dropdown {\r\n  z-index: 50;\r\n  position: absolute;\r\n  left: 0;\r\n  top: 2.4rem;\r\n  display: inline-block;\r\n  background-color: white;\r\n  border: 1px solid gray;\r\n  margin-top: -1px;\r\n  display: none;\r\n}\r\n\r\n.panel-dropdown.show {\r\n  display: inline-block;\r\n}\r\n.panel-dropdown-item {\r\n  padding: 0.35rem 0.65rem;\r\n  cursor: pointer;\r\n}\r\n.panel-dropdown-item:hover {\r\n  background-color: lightskyblue;\r\n}\r\n.panel-dropdown-item span {\r\n  margin-right: 6px;\r\n  color: gray;\r\n}\r\n.panel-dropdown-item:not(:last-child) {\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n\r\n.panel-footer {\r\n  display: flex;\r\n  padding: 1rem;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  border-top: 1px solid lightgray;\r\n}\r\n\r\n.panel-button {\r\n  width: 120px;\r\n  font-size: 0.88rem;\r\n  border-radius: 5px;\r\n  border: 0;\r\n  background-color: #007bff;\r\n  color: white;\r\n  padding: 0.6rem;\r\n  cursor: pointer;\r\n}\r\n\r\n.float-left {\r\n  float: left !important;\r\n}\r\n\r\n.float-right {\r\n  float: right !important;\r\n}\r\n\r\n.panel-list {\r\n  overflow-y: scroll;\r\n  max-height: 20rem;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 0.25rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.panel-checkbox {\r\n  vertical-align: 2px;\r\n}\r\n.panel-list span {\r\n  margin-left: 10px;\r\n  color: gray;\r\n}\r\n.panel-list-item {\r\n  padding: 10px 10px;\r\n  font-size: 0.88rem;\r\n  cursor: pointer;\r\n  white-space: nowrap;\r\n}\r\n.panel-list-item:hover {\r\n  background-color: lightskyblue;\r\n}\r\n.panel-list-item:not(:last-child) {\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n.normal-text {\r\n  font-size: 0.88rem;\r\n  color: gray;\r\n}\r\n\r\n.fa-spin {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\r\n}\r\n.svg-inline--fa.fa-w-14 {\r\n  width: 0.875em;\r\n}\r\n.svg-inline--fa.fa-w-16 {\r\n  width: 1em;\r\n}\r\n.svg-inline--fa.fa-fw {\r\n  width: 1.25em;\r\n}\r\n.svg-inline--fa {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\r\n}\r\n.fa-fw {\r\n  text-align: center;\r\n  width: 1.25em;\r\n}\r\n.fa-xs {\r\n  font-size: 0.75em;\r\n}\r\n.fa-sm {\r\n  font-size: 0.875em;\r\n}\r\n.fa-1x {\r\n  font-size: 1em;\r\n}\r\n.fa-2x {\r\n  font-size: 2em;\r\n}\r\n.fa-3x {\r\n  font-size: 3em;\r\n}\r\n</style>\r\n"]},media:void 0})},Os,"data-v-72c10554",!1,void 0,!1,zi,void 0,void 0);/* scoped */var Hs={components:{draggable:t},props:{value:Array,localizedLabel:{type:Object,default(){return{tableSetting:"Table Setting",exportExcel:"Export Excel",importExcel:"Import Excel",back:"Back",reset:"Default"}}}},data(){return{show:!1,processing:!1}},computed:{fields:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{reset(){this.$parent.resetColumn(),this.hidePanel()},clickOutside(t){"panelModal"===t.target.id&&this.hidePanel()},columnLabelClick(t,e){e.invisible=!e.invisible,setTimeout(this.$parent.calStickyLeft)},freezePanelSizeAfterShown(){const e=this.$refs.panelList,t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},removePanelSizeAfterHide(){const e=this.$refs.panelList;e.removeAttribute("style")},exportTable(e){this.hidePanel(),this.$parent.exportTable(e)},importTable(){this.hidePanel(),this.$parent.importTable()},showPanel(){this.show=!0,setTimeout(()=>this.$refs.button.focus()),setTimeout(()=>this.freezePanelSizeAfterShown())},hidePanel(){this.show=!1,this.removePanelSizeAfterHide()}}};/* script */ /* template */var Us=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"panel-modal",attrs:{id:"panelModal"},on:{click:e.clickOutside,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.hidePanel.apply(null,arguments)}}},[o("div",{ref:"panelSetting",staticClass:"panel-body"},[o("div",{staticClass:"panel-title"},[o("svg",{staticClass:"svg-inline--fa fa-bars fa-w-14 fa-1x",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"bars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.tableSetting)}})]),e._v(" "),o("div",{staticClass:"panel-content"},[o("div",{staticClass:"panel-action"},[o("button",{staticClass:"panel-button float-left no-margin",on:{click:function(){return e.exportTable("excel")}}},[o("svg",{staticClass:"svg-inline--fa fa-file-excel fa-w-12",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"file-excel",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"}},[o("path",{attrs:{fill:"currentColor",d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.exportExcel)}})]),e._v(" "),o("button",{staticClass:"panel-button float-right no-margin",on:{click:e.importTable}},[o("svg",{staticClass:"svg-inline--fa fa-file-csv fa-w-12",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"file-csv",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"}},[o("path",{attrs:{fill:"currentColor",d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-96 144c0 4.42-3.58 8-8 8h-8c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h8c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-8c-26.51 0-48-21.49-48-48v-32c0-26.51 21.49-48 48-48h8c4.42 0 8 3.58 8 8v16zm44.27 104H160c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h12.27c5.95 0 10.41-3.5 10.41-6.62 0-1.3-.75-2.66-2.12-3.84l-21.89-18.77c-8.47-7.22-13.33-17.48-13.33-28.14 0-21.3 19.02-38.62 42.41-38.62H200c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-12.27c-5.95 0-10.41 3.5-10.41 6.62 0 1.3.75 2.66 2.12 3.84l21.89 18.77c8.47 7.22 13.33 17.48 13.33 28.14.01 21.29-19 38.62-42.39 38.62zM256 264v20.8c0 20.27 5.7 40.17 16 56.88 10.3-16.7 16-36.61 16-56.88V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v20.8c0 35.48-12.88 68.89-36.28 94.09-3.02 3.25-7.27 5.11-11.72 5.11s-8.7-1.86-11.72-5.11c-23.4-25.2-36.28-58.61-36.28-94.09V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8zm121-159L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.importExcel)}})])]),e._v(" "),o("div",[o("div",{ref:"panelList",staticClass:"panel-list"},[o("draggable",{attrs:{draggable:".panel-list-item"},model:{value:e.fields,callback:function(t){e.fields=t},expression:"fields"}},e._l(e.fields,function(t,i){return o("div",{key:i,staticClass:"panel-list-item",on:{click:function(o){return o.preventDefault(),e.columnLabelClick(o,t)}}},[o("input",{staticClass:"panel-checkbox",attrs:{type:"checkbox",disabled:!0},domProps:{checked:!t.invisible}}),e._v(" "),o("span",[e._v(e._s(t.label))])])}),0)],1)])]),e._v(" "),o("div",{staticClass:"panel-footer"},[o("button",{ref:"button",staticClass:"panel-button",on:{click:e.reset}},[o("svg",{staticClass:"svg-inline--fa fa-save fa-w-14 fa-fw fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"save",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.reset)}})]),e._v(" "),o("button",{ref:"button",staticClass:"panel-button",on:{click:e.hidePanel}},[o("svg",{staticClass:"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sign-in-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"}})]),e._v(" "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.back)}})])])])])};Us._withStripped=!0;/* style */const Ws=/*#__PURE__*/Fi({render:Us,staticRenderFns:[]},function(e){e&&e("data-v-24fd6f13_0",{source:"\ninput[data-v-24fd6f13]:focus, button[data-v-24fd6f13]:focus {\r\n  outline: none !important;\r\n  box-shadow: inset 0 -1px 0 #ddd !important;\n}\n.panel-modal[data-v-24fd6f13] {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: #0007;\r\n  z-index: 999;\r\n  font-weight: 400;\r\n  font-size: 1rem;\r\n  text-shadow: none;\n}\n.panel-body[data-v-24fd6f13] {\r\n  background-color: white;\r\n  position: fixed;\r\n  border-radius: 5px;\r\n  padding: 0;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 28rem;\r\n  max-width: 75vh;\r\n  height: fit-content;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\n}\n.panel-title[data-v-24fd6f13] {\r\n  padding: 1rem;\r\n  display: flex;\r\n  color: dimgray;\r\n  font-size: 1.25rem;\r\n  line-height: 1.5rem;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  border-bottom: 1px solid lightgray;\n}\ndiv.panel-title span[data-v-24fd6f13], button.panel-button span[data-v-24fd6f13] {\r\n  margin-left: 6px;\n}\n.panel-content[data-v-24fd6f13] {\r\n  padding: 1rem;\r\n  text-align: left;\r\n  overflow-y: scroll;\n}\n.panel-content .panel-button[data-v-24fd6f13] {\r\n  width: 48%;\r\n  background-color: #17a2b8;\n}\n.panel-action[data-v-24fd6f13] {\r\n  display: inline-block;\r\n  margin-bottom: 0.5rem;\r\n  width: 100%;\r\n  position: relative;\r\n  white-space: nowrap;\n}\n.panel-footer[data-v-24fd6f13] {\r\n  display: flex;\r\n  padding: 1rem;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  border-top: 1px solid lightgray;\n}\n.panel-button[data-v-24fd6f13] {\r\n  width: 120px;\r\n  font-size: 0.88rem;\r\n  border-radius: 5px;\r\n  border: 0;\r\n  background-color: #007bff;\r\n  margin-left: 10px;\r\n  color: white;\r\n  padding: 0.6rem;\r\n  cursor: pointer;\n}\n.float-left[data-v-24fd6f13] {\r\n  float: left !important;\n}\n.float-right[data-v-24fd6f13] {\r\n  float: right !important;\n}\n.panel-list[data-v-24fd6f13] {\r\n  overflow-y: scroll;\r\n  max-height: 20rem;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 0.25rem;\r\n  display: flex;\r\n  flex-direction: column;\n}\n.panel-checkbox[data-v-24fd6f13] {\r\n  vertical-align: 2px;\n}\n.panel-list span[data-v-24fd6f13] {\r\n  margin-left: 10px;\r\n  color: gray;\n}\n.panel-list-item[data-v-24fd6f13] {\r\n  padding: 10px 10px;\r\n  font-size: 0.88rem;\r\n  cursor: pointer;\n}\n.panel-list-item[data-v-24fd6f13]:hover {\r\n  background-color: lightskyblue;\n}\n.panel-list-item[data-v-24fd6f13]:not(:last-child) {\r\n  border-bottom: 1px solid lightgray;\n}\n.fa-spin[data-v-24fd6f13] {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-24fd6f13] {\r\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-24fd6f13] {\r\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-24fd6f13] {\r\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-24fd6f13] {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-24fd6f13] {\r\n  text-align: center;\r\n  width: 1.25em;\n}\n.fa-xs[data-v-24fd6f13] {\r\n  font-size: 0.75em;\n}\n.fa-sm[data-v-24fd6f13] {\r\n  font-size: 0.875em;\n}\n.fa-1x[data-v-24fd6f13] {\r\n  font-size: 1em;\n}\n.fa-2x[data-v-24fd6f13] {\r\n  font-size: 2em;\n}\n.fa-3x[data-v-24fd6f13] {\r\n  font-size: 3em;\n}\n.no-margin[data-v-24fd6f13] {\r\n  margin: 0 !important;\n}\r\n",map:{version:3,sources:["C:\\Projects\\vue-excel-editor\\src\\panelSetting.vue"],names:[],mappings:";AAiIA;EACA,wBAAA;EACA,0CAAA;AACA;AAEA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,YAAA;EACA,aAAA;EACA,gBAAA;EACA,uBAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,SAAA;EACA,gCAAA;EACA,YAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,cAAA;EACA,kBAAA;EACA,mBAAA;EACA,mBAAA;EACA,2BAAA;EACA,kCAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,aAAA;EACA,gBAAA;EACA,kBAAA;AACA;AAEA;EACA,UAAA;EACA,yBAAA;AACA;AAEA;EACA,qBAAA;EACA,qBAAA;EACA,WAAA;EACA,kBAAA;EACA,mBAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,mBAAA;EACA,yBAAA;EACA,+BAAA;AACA;AAEA;EACA,YAAA;EACA,kBAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;EACA,iBAAA;EACA,YAAA;EACA,eAAA;EACA,eAAA;AACA;AAEA;EACA,sBAAA;AACA;AAEA;EACA,uBAAA;AACA;AAEA;EACA,kBAAA;EACA,iBAAA;EACA,yBAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;EACA,iBAAA;EACA,WAAA;AACA;AACA;EACA,kBAAA;EACA,kBAAA;EACA,eAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,kCAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,oBAAA;AACA",file:"panelSetting.vue",sourcesContent:["<template>\r\n  <div id=\"panelModal\" v-show=\"show\" class=\"panel-modal\" @click=\"clickOutside\" @keydown.exact.esc=\"hidePanel\">\r\n    <div ref=\"panelSetting\"\r\n         class=\"panel-body\">\r\n      <div class=\"panel-title\">\r\n        <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"bars\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-bars fa-w-14 fa-1x\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\" class=\"\"></path></svg>\r\n        <span v-html=\"localizedLabel.tableSetting\" />\r\n      </div>\r\n      <div class=\"panel-content\">\r\n        <div class=\"panel-action\">\r\n          <button class=\"panel-button float-left no-margin\" @click=\"exportTable('excel')\">\r\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"file-excel\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" class=\"svg-inline--fa fa-file-excel fa-w-12\"><path fill=\"currentColor\" d=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z\" class=\"\"></path></svg>\r\n            <span v-html=\"localizedLabel.exportExcel\" />\r\n          </button>\r\n          <button class=\"panel-button float-right no-margin\" @click=\"importTable\">\r\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"file-csv\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" class=\"svg-inline--fa fa-file-csv fa-w-12\"><path fill=\"currentColor\" d=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-96 144c0 4.42-3.58 8-8 8h-8c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h8c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-8c-26.51 0-48-21.49-48-48v-32c0-26.51 21.49-48 48-48h8c4.42 0 8 3.58 8 8v16zm44.27 104H160c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h12.27c5.95 0 10.41-3.5 10.41-6.62 0-1.3-.75-2.66-2.12-3.84l-21.89-18.77c-8.47-7.22-13.33-17.48-13.33-28.14 0-21.3 19.02-38.62 42.41-38.62H200c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-12.27c-5.95 0-10.41 3.5-10.41 6.62 0 1.3.75 2.66 2.12 3.84l21.89 18.77c8.47 7.22 13.33 17.48 13.33 28.14.01 21.29-19 38.62-42.39 38.62zM256 264v20.8c0 20.27 5.7 40.17 16 56.88 10.3-16.7 16-36.61 16-56.88V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v20.8c0 35.48-12.88 68.89-36.28 94.09-3.02 3.25-7.27 5.11-11.72 5.11s-8.7-1.86-11.72-5.11c-23.4-25.2-36.28-58.61-36.28-94.09V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8zm121-159L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z\" class=\"\"></path></svg>\r\n            <span v-html=\"localizedLabel.importExcel\" />\r\n          </button>\r\n        </div>\r\n        <div>\r\n          <div ref=\"panelList\" class=\"panel-list\">\r\n            <draggable v-model=\"fields\" draggable=\".panel-list-item\">\r\n              <div v-for=\"(item, k) in fields\" :key=\"k\"\r\n                   class=\"panel-list-item\"\r\n                   @click.prevent=\"columnLabelClick($event, item)\">\r\n                <input type=\"checkbox\" :checked=\"!item.invisible\" :disabled=\"true\" class=\"panel-checkbox\">\r\n                <span>{{ item.label }}</span>\r\n              </div>\r\n            </draggable>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"panel-footer\">\r\n        <button ref=\"button\" class=\"panel-button\" @click=\"reset\">\r\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"save\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-save fa-w-14 fa-fw fa-sm\"><path fill=\"currentColor\" d=\"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z\" class=\"\"></path></svg>\r\n          <span v-html=\"localizedLabel.reset\" />\r\n        </button>\r\n        <button ref=\"button\" class=\"panel-button\" @click=\"hidePanel\">\r\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sign-in-alt\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm\"><path fill=\"currentColor\" d=\"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z\" class=\"\"></path></svg>\r\n          <span v-html=\"localizedLabel.back\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport draggable from 'vuedraggable'\r\n\r\nexport default {\r\n  components: {\r\n    'draggable': draggable\r\n  },\r\n  props: {\r\n    value: Array,\r\n    localizedLabel: {\r\n      type: Object,\r\n      default () {\r\n        return {\r\n          tableSetting: 'Table Setting',\r\n          exportExcel: 'Export Excel',\r\n          importExcel: 'Import Excel',\r\n          back: 'Back',\r\n          reset: 'Default'\r\n        }\r\n      }\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      show: false,\r\n      processing: false\r\n    }\r\n  },\r\n  computed: {\r\n    fields: {\r\n      get: function () {\r\n        return this.value\r\n      },\r\n      set: function (newVal) {\r\n        this.$emit('input', newVal)\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    reset () {\r\n      this.$parent.resetColumn()\r\n      this.hidePanel()\r\n    },\r\n    clickOutside (e) {\r\n      if (e.target.id === 'panelModal') this.hidePanel()\r\n    },\r\n    columnLabelClick (e, item) {\r\n      item.invisible = !item.invisible\r\n      setTimeout(this.$parent.calStickyLeft)\r\n    },\r\n    freezePanelSizeAfterShown () {\r\n      const target = this.$refs.panelList\r\n      const rect = target.getBoundingClientRect()\r\n      target.setAttribute('style', `width:${rect.width}px; height:${rect.height}px;`)\r\n    },\r\n    removePanelSizeAfterHide () {\r\n      const target = this.$refs.panelList\r\n      target.removeAttribute('style')\r\n    },\r\n    exportTable (format) {\r\n      this.hidePanel()\r\n      this.$parent.exportTable(format)\r\n    },\r\n    importTable () {\r\n      this.hidePanel()\r\n      this.$parent.importTable()\r\n    },\r\n    showPanel () {\r\n      this.show = true\r\n      setTimeout(() => (this.$refs.button.focus()))\r\n      setTimeout(() => this.freezePanelSizeAfterShown())\r\n    },\r\n    hidePanel () {\r\n      this.show = false\r\n      this.removePanelSizeAfterHide()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\ninput:focus, button:focus {\r\n  outline: none !important;\r\n  box-shadow: inset 0 -1px 0 #ddd !important;\r\n}\r\n\r\n.panel-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: #0007;\r\n  z-index: 999;\r\n  font-weight: 400;\r\n  font-size: 1rem;\r\n  text-shadow: none;\r\n}\r\n\r\n.panel-body {\r\n  background-color: white;\r\n  position: fixed;\r\n  border-radius: 5px;\r\n  padding: 0;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 28rem;\r\n  max-width: 75vh;\r\n  height: fit-content;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.panel-title {\r\n  padding: 1rem;\r\n  display: flex;\r\n  color: dimgray;\r\n  font-size: 1.25rem;\r\n  line-height: 1.5rem;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n\r\ndiv.panel-title span, button.panel-button span {\r\n  margin-left: 6px;\r\n}\r\n\r\n.panel-content {\r\n  padding: 1rem;\r\n  text-align: left;\r\n  overflow-y: scroll;\r\n}\r\n\r\n.panel-content .panel-button {\r\n  width: 48%;\r\n  background-color: #17a2b8;\r\n}\r\n\r\n.panel-action {\r\n  display: inline-block;\r\n  margin-bottom: 0.5rem;\r\n  width: 100%;\r\n  position: relative;\r\n  white-space: nowrap;\r\n}\r\n\r\n.panel-footer {\r\n  display: flex;\r\n  padding: 1rem;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  border-top: 1px solid lightgray;\r\n}\r\n\r\n.panel-button {\r\n  width: 120px;\r\n  font-size: 0.88rem;\r\n  border-radius: 5px;\r\n  border: 0;\r\n  background-color: #007bff;\r\n  margin-left: 10px;\r\n  color: white;\r\n  padding: 0.6rem;\r\n  cursor: pointer;\r\n}\r\n\r\n.float-left {\r\n  float: left !important;\r\n}\r\n\r\n.float-right {\r\n  float: right !important;\r\n}\r\n\r\n.panel-list {\r\n  overflow-y: scroll;\r\n  max-height: 20rem;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 0.25rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.panel-checkbox {\r\n  vertical-align: 2px;\r\n}\r\n.panel-list span {\r\n  margin-left: 10px;\r\n  color: gray;\r\n}\r\n.panel-list-item {\r\n  padding: 10px 10px;\r\n  font-size: 0.88rem;\r\n  cursor: pointer;\r\n}\r\n.panel-list-item:hover {\r\n  background-color: lightskyblue;\r\n}\r\n.panel-list-item:not(:last-child) {\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n\r\n.fa-spin {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\r\n}\r\n.svg-inline--fa.fa-w-14 {\r\n  width: 0.875em;\r\n}\r\n.svg-inline--fa.fa-w-16 {\r\n  width: 1em;\r\n}\r\n.svg-inline--fa.fa-fw {\r\n  width: 1.25em;\r\n}\r\n.svg-inline--fa {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\r\n}\r\n.fa-fw {\r\n  text-align: center;\r\n  width: 1.25em;\r\n}\r\n.fa-xs {\r\n  font-size: 0.75em;\r\n}\r\n.fa-sm {\r\n  font-size: 0.875em;\r\n}\r\n.fa-1x {\r\n  font-size: 1em;\r\n}\r\n.fa-2x {\r\n  font-size: 2em;\r\n}\r\n.fa-3x {\r\n  font-size: 3em;\r\n}\r\n.no-margin {\r\n  margin: 0 !important;\r\n}\r\n</style>\r\n"]},media:void 0})},Hs,"data-v-24fd6f13",!1,void 0,!1,zi,void 0,void 0);/* scoped */var Ys={props:{localizedLabel:{type:Object,default(){return{}}}},data(){return{show:!1,processing:!1,inputFind:""}},methods:{clickOutside(t){"panelModal"===t.target.id&&this.hidePanel()},doFind(t,o){o&&o.preventDefault(),this.hidePanel(),this.$parent.doFind(this.inputFind)},showPanel(){this.show=!0,setTimeout(()=>this.$refs.inputFind.focus())},hidePanel(){this.show=!1}}};/* script */ /* template */var qs=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"panel-modal",attrs:{id:"panelModal"},on:{click:e.clickOutside,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.hidePanel.apply(null,arguments)}}},[o("div",{ref:"panelFind",staticClass:"panel-body"},[o("div",[o("span",{staticClass:"panel-input-b"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.inputFind,expression:"inputFind"}],ref:"inputFind",staticClass:"panel-input",attrs:{type:"text",trim:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},domProps:{value:e.inputFind},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.doFind(e.inputFind,t)},input:function(t){t.target.composing||(e.inputFind=t.target.value)}}})]),e._v(" "),o("button",{staticClass:"panel-input-button",on:{click:function(){return e.doFind(e.inputFind)}}},[o("svg",{staticClass:"svg-inline--fa fa-search fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"search",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"}})])])])])])};qs._withStripped=!0;/* style */const Ks=/*#__PURE__*/Fi({render:qs,staticRenderFns:[]},function(e){e&&e("data-v-3e237df7_0",{source:"\ninput[data-v-3e237df7]:focus, button[data-v-3e237df7]:focus {\r\n  outline: none !important;\r\n  box-shadow: none !important;\n}\n.panel-modal[data-v-3e237df7] {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: #0007;\r\n  z-index: 999;\r\n  font-weight: 400;\r\n  font-size: 1rem;\r\n  text-shadow: none;\n}\n.panel-body[data-v-3e237df7] {\r\n  background-color: white;\r\n  position: fixed;\r\n  border-radius: 5px;\r\n  padding: 1rem;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 28rem;\r\n  max-width: 75vh;\r\n  height: fit-content;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  white-space: nowrap;\n}\n.panel-input-b[data-v-3e237df7] {\r\n  display: inline-block;\r\n  border-top-left-radius: 4px;\r\n  border-bottom-left-radius: 4px;\r\n  width: calc(100% - 2.2rem);\r\n  border: 1px solid lightgray;\r\n  border-right: 0;\r\n  margin-right: -4px;\r\n  height: 2.3rem;\n}\n.panel-input[data-v-3e237df7] {\r\n  border: 0;\r\n  box-shadow: none;\r\n  padding: 0.6rem;\r\n  width: 100%;\r\n  font-size: 0.88rem;\r\n  background-color: transparent;\n}\n.panel-input-button[data-v-3e237df7] {\r\n  border-top-right-radius: 4px;\r\n  border-bottom-right-radius: 4px;\r\n  color: white;\r\n  background-color: #28a745;\r\n  border: 1px solid #28a745;\r\n  font-size: 1.3rem;\r\n  width: 2.2rem;\r\n  height: 2.35rem;\r\n  vertical-align: -2px;\r\n  cursor: pointer;\n}\n.fa-spin[data-v-3e237df7] {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-3e237df7] {\r\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-3e237df7] {\r\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-3e237df7] {\r\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-3e237df7] {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-3e237df7] {\r\n  text-align: center;\r\n  width: 1.25em;\n}\n.fa-xs[data-v-3e237df7] {\r\n  font-size: 0.75em;\n}\n.fa-sm[data-v-3e237df7] {\r\n  font-size: 0.875em;\n}\n.fa-1x[data-v-3e237df7] {\r\n  font-size: 1em;\n}\n.fa-2x[data-v-3e237df7] {\r\n  font-size: 2em;\n}\n.fa-3x[data-v-3e237df7] {\r\n  font-size: 3em;\n}\r\n",map:{version:3,sources:["C:\\Projects\\vue-excel-editor\\src\\panelFind.vue"],names:[],mappings:";AA4DA;EACA,wBAAA;EACA,2BAAA;AACA;AAEA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,YAAA;EACA,aAAA;EACA,gBAAA;EACA,uBAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,eAAA;EACA,kBAAA;EACA,aAAA;EACA,QAAA;EACA,SAAA;EACA,gCAAA;EACA,YAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;EACA,mBAAA;AACA;AAEA;EACA,qBAAA;EACA,2BAAA;EACA,8BAAA;EACA,0BAAA;EACA,2BAAA;EACA,eAAA;EACA,kBAAA;EACA,cAAA;AACA;AACA;EACA,SAAA;EACA,gBAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,6BAAA;AACA;AACA;EACA,4BAAA;EACA,+BAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,iBAAA;EACA,aAAA;EACA,eAAA;EACA,oBAAA;EACA,eAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA",file:"panelFind.vue",sourcesContent:["<template>\r\n  <div id=\"panelModal\" v-show=\"show\" class=\"panel-modal\" @click=\"clickOutside\" @keydown.exact.esc=\"hidePanel\">\r\n    <div ref=\"panelFind\" class=\"panel-body\">\r\n      <div>\r\n        <span class=\"panel-input-b\">\r\n          <input type=\"text\"\r\n                 ref=\"inputFind\"\r\n                 v-model=\"inputFind\"\r\n                 class=\"panel-input\"\r\n                 trim autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\r\n                 @keydown.exact.enter=\"doFind(inputFind, $event)\" />\r\n        </span>\r\n        <button class=\"panel-input-button\" @click=\"doFind(inputFind)\">\r\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"search\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-search fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z\" class=\"\"></path></svg>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    localizedLabel: {\r\n      type: Object,\r\n      default () {\r\n        return {\r\n        }\r\n      }\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      show: false,\r\n      processing: false,\r\n      inputFind: ''\r\n    }\r\n  },\r\n  methods: {\r\n    clickOutside (e) {\r\n      if (e.target.id === 'panelModal') this.hidePanel()\r\n    },\r\n    doFind(s, e) {\r\n      if (e) e.preventDefault()\r\n      this.hidePanel()\r\n      this.$parent.doFind(this.inputFind)\r\n    },\r\n    showPanel () {\r\n      this.show = true\r\n      setTimeout(() => (this.$refs.inputFind.focus()))\r\n    },\r\n    hidePanel () {\r\n      this.show = false\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\ninput:focus, button:focus {\r\n  outline: none !important;\r\n  box-shadow: none !important;\r\n}\r\n\r\n.panel-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: #0007;\r\n  z-index: 999;\r\n  font-weight: 400;\r\n  font-size: 1rem;\r\n  text-shadow: none;\r\n}\r\n\r\n.panel-body {\r\n  background-color: white;\r\n  position: fixed;\r\n  border-radius: 5px;\r\n  padding: 1rem;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 28rem;\r\n  max-width: 75vh;\r\n  height: fit-content;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  white-space: nowrap;\r\n}\r\n\r\n.panel-input-b {\r\n  display: inline-block;\r\n  border-top-left-radius: 4px;\r\n  border-bottom-left-radius: 4px;\r\n  width: calc(100% - 2.2rem);\r\n  border: 1px solid lightgray;\r\n  border-right: 0;\r\n  margin-right: -4px;\r\n  height: 2.3rem;\r\n}\r\n.panel-input {\r\n  border: 0;\r\n  box-shadow: none;\r\n  padding: 0.6rem;\r\n  width: 100%;\r\n  font-size: 0.88rem;\r\n  background-color: transparent;\r\n}\r\n.panel-input-button {\r\n  border-top-right-radius: 4px;\r\n  border-bottom-right-radius: 4px;\r\n  color: white;\r\n  background-color: #28a745;\r\n  border: 1px solid #28a745;\r\n  font-size: 1.3rem;\r\n  width: 2.2rem;\r\n  height: 2.35rem;\r\n  vertical-align: -2px;\r\n  cursor: pointer;\r\n}\r\n\r\n.fa-spin {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\r\n}\r\n.svg-inline--fa.fa-w-14 {\r\n  width: 0.875em;\r\n}\r\n.svg-inline--fa.fa-w-16 {\r\n  width: 1em;\r\n}\r\n.svg-inline--fa.fa-fw {\r\n  width: 1.25em;\r\n}\r\n.svg-inline--fa {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\r\n}\r\n.fa-fw {\r\n  text-align: center;\r\n  width: 1.25em;\r\n}\r\n.fa-xs {\r\n  font-size: 0.75em;\r\n}\r\n.fa-sm {\r\n  font-size: 0.875em;\r\n}\r\n.fa-1x {\r\n  font-size: 1em;\r\n}\r\n.fa-2x {\r\n  font-size: 2em;\r\n}\r\n.fa-3x {\r\n  font-size: 3em;\r\n}\r\n</style>\r\n"]},media:void 0})},Ys,"data-v-3e237df7",!1,void 0,!1,zi,void 0,void 0);/* scoped */var js={months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],firstDayOfWeek:0,firstWeekContainsDate:1},Xs=/\[([^\]]+)]|YYYY|YY?|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|m{1,2}|s{1,2}|Z{1,2}|S{1,3}|w{1,2}|x|X|a|A/g,Qs=function(e,t,o){var i=12>e?"AM":"PM";return o?i.toLocaleLowerCase():i},Gs={Y:function(e){var t=e.getFullYear();return 9999>=t?"".concat(t):"+".concat(t)},YY:function(e){return Hi(e.getFullYear(),4).substr(2)},YYYY:function(e){return Hi(e.getFullYear(),4)},M:function(e){return e.getMonth()+1},MM:function(e){return Hi(e.getMonth()+1,2)},MMM:function(e,t){return t.monthsShort[e.getMonth()]},MMMM:function(e,t){return t.months[e.getMonth()]},D:function(e){return e.getDate()},DD:function(e){return Hi(e.getDate(),2)},H:function(e){return e.getHours()},HH:function(e){return Hi(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:12<t?t%12:t},hh:function(){var e=Gs.h.apply(Gs,arguments);return Hi(e,2)},m:function(e){return e.getMinutes()},mm:function(e){return Hi(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return Hi(e.getSeconds(),2)},S:function(e){return d(e.getMilliseconds()/100)},SS:function(e){return Hi(d(e.getMilliseconds()/10),2)},SSS:function(e){return Hi(e.getMilliseconds(),3)},d:function(e){return e.getDay()},dd:function(e,t){return t.weekdaysMin[e.getDay()]},ddd:function(e,t){return t.weekdaysShort[e.getDay()]},dddd:function(e,t){return t.weekdays[e.getDay()]},A:function(e,t){var o=t.meridiem||Qs;return o(e.getHours(),e.getMinutes(),!1)},a:function(e,t){var o=t.meridiem||Qs;return o(e.getHours(),e.getMinutes(),!0)},Z:function(e){return Ui(e.getTimezoneOffset(),":")},ZZ:function(e){return Ui(e.getTimezoneOffset())},X:function(e){return d(e.getTime()/1e3)},x:function(e){return e.getTime()},w:function(e,t){return Ni(e,{firstDayOfWeek:t.firstDayOfWeek,firstWeekContainsDate:t.firstWeekContainsDate})},ww:function(e,t){return Hi(Gs.w(e,t),2)}},Js=/(\[[^\[]*\])|(MM?M?M?|Do|DD?|ddd?d?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|S{1,3}|x|X|ZZ?|.)/g,Zs=/\d/,er=/\d\d/,tr=/\d\d?/,or=/[+-]?\d+/,ir="year",ar="month",lr="day",nr="hour",sr="minute",rr="second",dr="millisecond",cr={},pr=function(e,t,o){var i=Array.isArray(e)?e:[e],a;a="string"==typeof o?function(e){var t=parseInt(e,10);return ta({},o,t)}:o,i.forEach(function(e){cr[e]=[t,a]})},ur=function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},Ar=function(e){return function(t){var o=t[e];if(!Array.isArray(o))throw new Error("Locale[".concat(e,"] need an array"));return new RegExp(o.map(ur).join("|"))}},hr=function(e,t){return function(o,i){var a=i[e];if(!Array.isArray(a))throw new Error("Locale[".concat(e,"] need an array"));var l=a.indexOf(o);if(0>l)throw new Error("Invalid Word");return ta({},t,l)}};pr("Y",or,ir),pr("YY",er,function(e){var t=new Date().getFullYear(),o=d(t/100),i=parseInt(e,10);return i=100*(68<i?o-1:o)+i,ta({},ir,i)}),pr("YYYY",/\d{4}/,ir),pr("M",tr,function(e){return ta({},ar,parseInt(e,10)-1)}),pr("MM",er,function(e){return ta({},ar,parseInt(e,10)-1)}),pr("MMM",Ar("monthsShort"),hr("monthsShort",ar)),pr("MMMM",Ar("months"),hr("months",ar)),pr("D",tr,lr),pr("DD",er,lr),pr(["H","h"],tr,nr),pr(["HH","hh"],er,nr),pr("m",tr,sr),pr("mm",er,sr),pr("s",tr,rr),pr("ss",er,rr),pr("S",Zs,function(e){return ta({},dr,100*parseInt(e,10))}),pr("SS",er,function(e){return ta({},dr,10*parseInt(e,10))}),pr("SSS",/\d{3}/,dr),pr(["A","a"],function(e){return e.meridiemParse||/[ap]\.?m?\.?/i},function(e,t){var o="function"==typeof t.isPM?t.isPM(e):oa(e);return{isPM:o}}),pr(["Z","ZZ"],/[+-]\d\d:?\d\d/,function(e){return{offset:ia(e)}}),pr("x",or,function(e){return{date:new Date(parseInt(e,10))}}),pr("X",/[+-]?\d+(\.\d{1,3})?/,function(e){return{date:new Date(1e3*parseFloat(e))}}),pr("d",Zs,"weekday"),pr("dd",Ar("weekdaysMin"),hr("weekdaysMin","weekday")),pr("ddd",Ar("weekdaysShort"),hr("weekdaysShort","weekday")),pr("dddd",Ar("weekdays"),hr("weekdays","weekday")),pr("w",tr,"week"),pr("ww",er,"week");var fr=["attrs","props","domProps"],mr=["class","style","directives"],gr=["on","nativeOn"],vr=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},yr=function(e){return e.reduce(function(t,o){for(var a in o)if(!t[a])t[a]=o[a];else if(-1!==fr.indexOf(a))t[a]=wa({},t[a],o[a]);else if(-1!==mr.indexOf(a)){var l=t[a]instanceof Array?t[a]:[t[a]],n=o[a]instanceof Array?o[a]:[o[a]];t[a]=l.concat(n)}else if(-1!==gr.indexOf(a)){for(var e in o[a])if(t[a][e]){var s=t[a][e]instanceof Array?t[a][e]:[t[a][e]],r=o[a][e]instanceof Array?o[a][e]:[o[a][e]];t[a][e]=s.concat(r)}else t[a][e]=o[a][e];}else if("hook"==a)for(var d in o[a])t[a][d]=t[a][d]?vr(t[a][d],o[a][d]):o[a][d];else t[a]=o[a];return t},{})},br=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;t["default"]={months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],firstDayOfWeek:0,firstWeekContainsDate:1},e.exports=t.default}),en=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}(br),Cr="en",wr={};wr[Cr]={formatLocale:en,yearFormat:"YYYY",monthFormat:"MMM",monthBeforeYear:!0};var xr={name:"Popup",inject:{prefixClass:{default:"mx"}},props:{visible:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!0}},data:function(){return{top:"",left:""}},watch:{visible:{immediate:!0,handler:function(e){var t=this;this.$nextTick(function(){e&&t.displayPopup()})}}},mounted:function(){var e=this;this.appendToBody&&document.body.appendChild(this.$el),this._clickoutEvent="ontouchend"in document?"touchstart":"mousedown",document.addEventListener(this._clickoutEvent,this.handleClickOutside);var t=this.$parent.$el;this._displayPopup=Ia(function(){return e.displayPopup()}),this._scrollParent=Ua(t)||window,this._scrollParent.addEventListener("scroll",this._displayPopup),window.addEventListener("resize",this._displayPopup)},beforeDestroy:function(){this.appendToBody&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el),document.removeEventListener(this._clickoutEvent,this.handleClickOutside),this._scrollParent.removeEventListener("scroll",this._displayPopup),window.removeEventListener("resize",this._displayPopup)},methods:{handleClickOutside:function(e){if(this.visible){var t=e.target,o=this.$el;o&&!o.contains(t)&&this.$emit("clickoutside",e)}},displayPopup:function(){if(this.visible){var e=this.$el,t=this.$parent.$el,o=this.appendToBody;this._popupRect||(this._popupRect=Na(e));var i=this._popupRect,a=i.width,l=i.height,n=Ha(t,a,l,o),s=n.left,r=n.top;this.left=s,this.top=r}}}},kr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{name:e.prefixClass+"-zoom-in-down"}},[e.visible?o("div",{class:e.prefixClass+"-datepicker-main "+e.prefixClass+"-datepicker-popup",style:{top:e.top,left:e.left,position:"absolute"}},[e._t("default")],2):e._e()])},staticRenderFns:[]},void 0,xr,void 0,!1,void 0,!1,void 0,void 0,void 0),Er=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em"}},[o("path",{attrs:{d:"M940.218182 107.054545h-209.454546V46.545455h-65.163636v60.50909H363.054545V46.545455H297.890909v60.50909H83.781818c-18.618182 0-32.581818 13.963636-32.581818 32.581819v805.236363c0 18.618182 13.963636 32.581818 32.581818 32.581818h861.090909c18.618182 0 32.581818-13.963636 32.581818-32.581818V139.636364c-4.654545-18.618182-18.618182-32.581818-37.236363-32.581819zM297.890909 172.218182V232.727273h65.163636V172.218182h307.2V232.727273h65.163637V172.218182h176.872727v204.8H116.363636V172.218182h181.527273zM116.363636 912.290909V442.181818h795.927273v470.109091H116.363636z"}})])},staticRenderFns:[]},void 0,{},void 0,!1,void 0,!1,void 0,void 0,void 0),Sr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em"}},[o("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e._v(" "),o("path",{attrs:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}}),e._v(" "),o("path",{attrs:{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"}})])},staticRenderFns:[]},void 0,{},void 0,!1,void 0,!1,void 0,void 0,void 0),Br=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em"}},[o("path",{attrs:{d:"M810.005333 274.005333l-237.994667 237.994667 237.994667 237.994667-60.010667 60.010667-237.994667-237.994667-237.994667 237.994667-60.010667-60.010667 237.994667-237.994667-237.994667-237.994667 60.010667-60.010667 237.994667 237.994667 237.994667-237.994667z"}})])},staticRenderFns:[]},void 0,{},void 0,!1,void 0,!1,void 0,void 0,void 0),Tr={props:{type:String},inject:{prefixClass:{default:"mx"}}},_r=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("button",e._g({class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-icon-"+e.type,attrs:{type:"button"}},e.$listeners),[o("i",{class:e.prefixClass+"-icon-"+e.type})])},staticRenderFns:[]},void 0,Tr,void 0,!1,void 0,!1,void 0,void 0,void 0),$r={name:"TableDate",components:{IconButton:_r},inject:{getLocale:{default:function(){return Oa}},getWeek:{default:function(){return Ni}},prefixClass:{default:"mx"},onDateMouseEnter:{default:void 0},onDateMouseLeave:{default:void 0}},props:{calendar:{type:Date,default:function(){return new Date}},showWeekNumber:{type:Boolean,default:!1},titleFormat:{type:String,default:"YYYY-MM-DD"},getRowClasses:{type:Function,default:function(){return[]}},getCellClasses:{type:Function,default:function(){return[]}}},computed:{firstDayOfWeek:function(){return this.getLocale().formatLocale.firstDayOfWeek||0},yearMonth:function(){var e=this.getLocale(),t=e.yearFormat,o=e.monthBeforeYear,i=e.monthFormat,a=void 0===i?"MMM":i,l={panel:"year",label:this.formatDate(this.calendar,t)},n={panel:"month",label:this.formatDate(this.calendar,a)};return o?[n,l]:[l,n]},days:function e(){var t=this.getLocale(),e=t.days||t.formatLocale.weekdaysMin;return e.concat(e).slice(this.firstDayOfWeek,this.firstDayOfWeek+7)},dates:function(){var e=this.calendar.getFullYear(),t=this.calendar.getMonth(),o=Pa({firstDayOfWeek:this.firstDayOfWeek,year:e,month:t});return za(o,7)}},methods:{getNextCalendar:function(e){var t=this.calendar.getFullYear(),o=this.calendar.getMonth();return xa(t,o+e)},handleIconLeftClick:function(){this.$emit("changecalendar",this.getNextCalendar(-1),"last-month")},handleIconRightClick:function(){this.$emit("changecalendar",this.getNextCalendar(1),"next-month")},handleIconDoubleLeftClick:function(){this.$emit("changecalendar",this.getNextCalendar(-12),"last-year")},handleIconDoubleRightClick:function(){this.$emit("changecalendar",this.getNextCalendar(12),"next-year")},handlePanelChange:function(e){this.$emit("changepanel",e)},handleMouseEnter:function(e){"function"==typeof this.onDateMouseEnter&&this.onDateMouseEnter(e)},handleMouseLeave:function(e){"function"==typeof this.onDateMouseLeave&&this.onDateMouseLeave(e)},handleCellClick:function(e){var t=e.target;"DIV"===t.tagName.toUpperCase()&&(t=t.parentNode);var o=t.getAttribute("data-row-col");if(o){var i=o.split(",").map(function(e){return parseInt(e,10)}),a=ma(i,2),l=a[0],n=a[1],s=this.dates[l][n];this.$emit("select",new Date(s))}},formatDate:function(e,t){return Wi(e,t,{locale:this.getLocale().formatLocale})},getCellTitle:function(e){var t=this.titleFormat;return this.formatDate(e,t)},getWeekNumber:function(e){return this.getWeek(e,this.getLocale().formatLocale)}}},Pr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.prefixClass+"-calendar "+e.prefixClass+"-calendar-panel-date"},[o("div",{class:e.prefixClass+"-calendar-header"},[o("icon-button",{attrs:{type:"double-left"},on:{click:e.handleIconDoubleLeftClick}}),e._v(" "),o("icon-button",{attrs:{type:"left"},on:{click:e.handleIconLeftClick}}),e._v(" "),o("icon-button",{attrs:{type:"double-right"},on:{click:e.handleIconDoubleRightClick}}),e._v(" "),o("icon-button",{attrs:{type:"right"},on:{click:e.handleIconRightClick}}),e._v(" "),o("span",{class:e.prefixClass+"-calendar-header-label"},e._l(e.yearMonth,function(t){return o("button",{key:t.panel,class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-current-"+t.panel,attrs:{type:"button"},on:{click:function(){return e.handlePanelChange(t.panel)}}},[e._v("\n        "+e._s(t.label)+"\n      ")])}),0)],1),e._v(" "),o("div",{class:e.prefixClass+"-calendar-content"},[o("table",{class:e.prefixClass+"-table "+e.prefixClass+"-table-date"},[o("thead",[o("tr",[e.showWeekNumber?o("th",{class:e.prefixClass+"-week-number-header"}):e._e(),e._v(" "),e._l(e.days,function(t){return o("th",{key:t},[e._v(e._s(t))])})],2)]),e._v(" "),o("tbody",{on:{click:e.handleCellClick}},e._l(e.dates,function(t,a){return o("tr",{key:a,class:[e.prefixClass+"-date-row",e.getRowClasses(t)]},[e.showWeekNumber?o("td",{class:e.prefixClass+"-week-number",attrs:{"data-row-col":a+",0"}},[e._v("\n            "+e._s(e.getWeekNumber(t[0]))+"\n          ")]):e._e(),e._v(" "),e._l(t,function(t,i){return o("td",{key:i,staticClass:"cell",class:e.getCellClasses(t),attrs:{"data-row-col":a+","+i,title:e.getCellTitle(t)},on:{mouseenter:function(){return e.handleMouseEnter(t)},mouseleave:function(){return e.handleMouseLeave(t)}}},[o("div",[e._v(e._s(t.getDate()))])])})],2)}),0)])])])},staticRenderFns:[]},void 0,$r,void 0,!1,void 0,!1,void 0,void 0,void 0),Dr={name:"TableMonth",components:{IconButton:_r},inject:{getLocale:{default:function(){return Oa}},prefixClass:{default:"mx"}},props:{calendar:{type:Date,default:function(){return new Date}},getCellClasses:{type:Function,default:function(){return[]}}},computed:{calendarYear:function(){return this.calendar.getFullYear()},months:function e(){var t=this.getLocale(),o=t.months||t.formatLocale.monthsShort,e=o.map(function(e,t){return{text:e,month:t}});return za(e,3)}},methods:{getNextCalendar:function(e){var t=this.calendar.getFullYear(),o=this.calendar.getMonth();return xa(t+e,o)},handleIconDoubleLeftClick:function(){this.$emit("changecalendar",this.getNextCalendar(-1),"last-year")},handleIconDoubleRightClick:function(){this.$emit("changecalendar",this.getNextCalendar(1),"next-year")},handlePanelChange:function(){this.$emit("changepanel","year")},handleClick:function(e){var t=e.target;"DIV"===t.tagName.toUpperCase()&&(t=t.parentNode);var o=t.getAttribute("data-month");o&&this.$emit("select",parseInt(o,10))}}},Fr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.prefixClass+"-calendar "+e.prefixClass+"-calendar-panel-month"},[o("div",{class:e.prefixClass+"-calendar-header"},[o("icon-button",{attrs:{type:"double-left"},on:{click:e.handleIconDoubleLeftClick}}),e._v(" "),o("icon-button",{attrs:{type:"double-right"},on:{click:e.handleIconDoubleRightClick}}),e._v(" "),o("span",{class:e.prefixClass+"-calendar-header-label"},[o("button",{class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text",attrs:{type:"button"},on:{click:e.handlePanelChange}},[e._v("\n        "+e._s(e.calendarYear)+"\n      ")])])],1),e._v(" "),o("div",{class:e.prefixClass+"-calendar-content"},[o("table",{class:e.prefixClass+"-table "+e.prefixClass+"-table-month",on:{click:e.handleClick}},e._l(e.months,function(t,a){return o("tr",{key:a},e._l(t,function(t,i){return o("td",{key:i,staticClass:"cell",class:e.getCellClasses(t.month),attrs:{"data-month":t.month}},[o("div",[e._v(e._s(t.text))])])}),0)}),0)])])},staticRenderFns:[]},void 0,Dr,void 0,!1,void 0,!1,void 0,void 0,void 0),zr={name:"TableYear",components:{IconButton:_r},inject:{prefixClass:{default:"mx"}},props:{calendar:{type:Date,default:function(){return new Date}},getCellClasses:{type:Function,default:function(){return[]}},getYearPanel:{type:Function}},computed:{years:function(){var e=new Date(this.calendar);return"function"==typeof this.getYearPanel?this.getYearPanel(e):this.getYears(e)},firstYear:function(){return this.years[0][0]},lastYear:function(){var e=function(e){return e[e.length-1]};return e(e(this.years))}},methods:{getYears:function(e){for(var t=10*d(e.getFullYear()/10),o=[],a=0;10>a;a++)o.push(t+a);return za(o,2)},getNextCalendar:function(e){var t=this.calendar.getFullYear(),o=this.calendar.getMonth();return xa(t+e,o)},handleIconDoubleLeftClick:function(){this.$emit("changecalendar",this.getNextCalendar(-10),"last-decade")},handleIconDoubleRightClick:function(){this.$emit("changecalendar",this.getNextCalendar(10),"next-decade")},handleClick:function(e){var t=e.target;"DIV"===t.tagName.toUpperCase()&&(t=t.parentNode);var o=t.getAttribute("data-year");o&&this.$emit("select",parseInt(o,10))}}},Lr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.prefixClass+"-calendar "+e.prefixClass+"-calendar-panel-year"},[o("div",{class:e.prefixClass+"-calendar-header"},[o("icon-button",{attrs:{type:"double-left"},on:{click:e.handleIconDoubleLeftClick}}),e._v(" "),o("icon-button",{attrs:{type:"double-right"},on:{click:e.handleIconDoubleRightClick}}),e._v(" "),o("span",{class:e.prefixClass+"-calendar-header-label"},[o("span",[e._v(e._s(e.firstYear))]),e._v(" "),o("span",{class:e.prefixClass+"-calendar-decade-separator"}),e._v(" "),o("span",[e._v(e._s(e.lastYear))])])],1),e._v(" "),o("div",{class:e.prefixClass+"-calendar-content"},[o("table",{class:e.prefixClass+"-table "+e.prefixClass+"-table-year",on:{click:e.handleClick}},e._l(e.years,function(t,a){return o("tr",{key:a},e._l(t,function(t,i){return o("td",{key:i,staticClass:"cell",class:e.getCellClasses(t),attrs:{"data-year":t}},[o("div",[e._v(e._s(t))])])}),0)}),0)])])},staticRenderFns:[]},void 0,zr,void 0,!1,void 0,!1,void 0,void 0,void 0),Mr={name:"CalendarPanel",inject:{prefixClass:{default:"mx"},dispatchDatePicker:{default:function(){return function(){}}}},props:{value:{},defaultValue:{default:function(){var e=new Date;return e.setHours(0,0,0,0),e}},defaultPanel:{type:String},disabledDate:{type:Function,default:function(){return!1}},type:{type:String,default:"date"},getClasses:{type:Function,default:function(){return[]}},showWeekNumber:{type:Boolean,default:void 0},getYearPanel:{type:Function},titleFormat:{type:String,default:"YYYY-MM-DD"},calendar:Date,partialUpdate:{type:Boolean,default:!1}},data:function(){var e=["date","month","year"],t=r(e.indexOf(this.type),e.indexOf(this.defaultPanel)),o=-1===t?"date":e[t];return{panel:o,innerCalendar:new Date}},computed:{innerValue:function(){var e=Array.isArray(this.value)?this.value:[this.value],t={year:Ta,month:_a,date:$a},o=t[this.type]||t.date;return e.filter(ka).map(function(e){return o(e)})},calendarYear:function(){return this.innerCalendar.getFullYear()},calendarMonth:function(){return this.innerCalendar.getMonth()}},watch:{value:{immediate:!0,handler:"initCalendar"},calendar:{handler:"initCalendar"},defaultValue:{handler:"initCalendar"}},methods:{initCalendar:function(){var e=this.calendar;if(!ka(e)){var t=this.innerValue.length;e=Ba(0<t?this.innerValue[t-1]:this.defaultValue)}this.innerCalendar=_a(e)},isDisabled:function(e){return this.disabledDate(new Date(e),this.innerValue)},emitDate:function(e,t){this.isDisabled(e)||(this.$emit("select",e,t,this.innerValue),this.dispatchDatePicker("pick",e,t))},handleCalendarChange:function(e,t){var o=new Date(this.innerCalendar);this.innerCalendar=e,this.$emit("update:calendar",e),this.dispatchDatePicker("calendar-change",e,o,t)},handelPanelChange:function(e){var t=this.panel;this.panel=e,this.dispatchDatePicker("panel-change",e,t)},handleSelectYear:function(e){if("year"===this.type){var t=this.getYearCellDate(e);this.emitDate(t,"year")}else if(this.handleCalendarChange(xa(e,this.calendarMonth),"year"),this.handelPanelChange("month"),this.partialUpdate&&1===this.innerValue.length){var o=new Date(this.innerValue[0]);o.setFullYear(e),this.emitDate(o,"year")}},handleSelectMonth:function(e){if("month"===this.type){var t=this.getMonthCellDate(e);this.emitDate(t,"month")}else if(this.handleCalendarChange(xa(this.calendarYear,e),"month"),this.handelPanelChange("date"),this.partialUpdate&&1===this.innerValue.length){var o=new Date(this.innerValue[0]);o.setFullYear(this.calendarYear),this.emitDate(Da(o,e),"month")}},handleSelectDate:function(e){this.emitDate(e,"week"===this.type?"week":"date")},getMonthCellDate:function(e){return xa(this.calendarYear,e)},getYearCellDate:function(e){return xa(e,0)},getDateClasses:function(e){var t=e.getMonth()!==this.calendarMonth,o=[];e.getTime()===new Date().setHours(0,0,0,0)&&o.push("today"),t&&o.push("not-current-month");var i=this.getStateClass(e);return"active"===i&&t||o.push(i),o.concat(this.getClasses(e,this.innerValue,o.join(" ")))},getMonthClasses:function(e){if("month"!==this.type)return this.calendarMonth===e?"active":"";var t=[],o=this.getMonthCellDate(e);return t.push(this.getStateClass(o)),t.concat(this.getClasses(o,this.innerValue,t.join(" ")))},getYearClasses:function(e){if("year"!==this.type)return this.calendarYear===e?"active":"";var t=[],o=this.getYearCellDate(e);return t.push(this.getStateClass(o)),t.concat(this.getClasses(o,this.innerValue,t.join(" ")))},getStateClass:function(e){return this.isDisabled(e)?"disabled":this.innerValue.some(function(t){return t.getTime()===e.getTime()})?"active":""},getWeekState:function(e){if("week"!==this.type)return"";var t=e[0].getTime(),o=e[6].getTime(),i=this.innerValue.some(function(e){var i=e.getTime();return i>=t&&i<=o});return i?"".concat(this.prefixClass,"-active-week"):""}},render:function(){var e=arguments[0],t=this.panel,o=this.innerCalendar;return"year"===t?e(Lr,{attrs:{calendar:o,getCellClasses:this.getYearClasses,getYearPanel:this.getYearPanel},on:{select:this.handleSelectYear,changecalendar:this.handleCalendarChange}}):"month"===t?e(Fr,{attrs:{calendar:o,getCellClasses:this.getMonthClasses},on:{select:this.handleSelectMonth,changepanel:this.handelPanelChange,changecalendar:this.handleCalendarChange}}):e(Pr,{class:ca({},"".concat(this.prefixClass,"-calendar-week-mode"),"week"===this.type),attrs:{calendar:o,getCellClasses:this.getDateClasses,getRowClasses:this.getWeekState,titleFormat:this.titleFormat,showWeekNumber:"boolean"==typeof this.showWeekNumber?this.showWeekNumber:"week"===this.type},on:{select:this.handleSelectDate,changepanel:this.handelPanelChange,changecalendar:this.handleCalendarChange}})}},Vr={name:"CalendarRange",components:{CalendarPanel:Mr},provide:function(){return{onDateMouseEnter:this.onDateMouseEnter,onDateMouseLeave:this.onDateMouseLeave}},inject:{prefixClass:{default:"mx"}},props:Aa({},Mr.props),data:function(){return{innerValue:[],calendars:[],hoveredValue:null}},computed:{calendarMinDiff:function(){var e={date:1,month:12,year:120};return e[this.type]||e.date},calendarMaxDiff:function(){return 1/0},defaultValues:function(){return Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue,this.defaultValue]}},watch:{value:{immediate:!0,handler:function(){var e=this;this.innerValue=Ea(this.value)?this.value:[new Date(NaN),new Date(NaN)];var t=this.innerValue.map(function(t,o){return _a(Ba(t,e.defaultValues[o]))});this.updateCalendars(t)}}},methods:{handleSelect:function(e,t){var o=ma(this.innerValue,2),i=o[0],a=o[1];ka(i)&&!ka(a)?(this.innerValue=i.getTime()>e.getTime()?[e,i]:[i,e],this.emitDate(this.innerValue,t)):this.innerValue=[e,new Date(NaN)]},onDateMouseEnter:function(e){this.hoveredValue=e},onDateMouseLeave:function(){this.hoveredValue=null},emitDate:function(e,t){this.$emit("select",e,t)},updateStartCalendar:function(e){this.updateCalendars([e,this.calendars[1]],1)},updateEndCalendar:function(e){this.updateCalendars([this.calendars[0],e],0)},updateCalendars:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,o=this.getCalendarGap(e);if(o){var i=new Date(e[t]);i.setMonth(i.getMonth()+(0===t?-o:o)),e[t]=i}this.calendars=e},getCalendarGap:function(e){var t=ma(e,2),o=t[0],i=t[1],a=i.getFullYear()-o.getFullYear(),l=i.getMonth()-o.getMonth(),n=12*a+l,s=this.calendarMinDiff,r=this.calendarMaxDiff;return n<s?s-n:n>r?r-n:0},getRangeClasses:function(e,t,o){var i=[].concat(this.getClasses(e,t,o));if(/disabled|active/.test(o))return i;var a=function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(e){return e.getTime()},i=o(e),a=t.map(o),l=ma(a,2),n=l[0],s=l[1];if(n>s){var r=[s,n];n=r[0],s=r[1]}return i>n&&i<s};return 2===t.length&&a(e,t)?i.concat("in-range"):1===t.length&&this.hoveredValue&&a(e,[t[0],this.hoveredValue])?i.concat("hover-in-range"):i}},render:function(){var e=this,t=arguments[0],o=this.calendars.map(function(o,i){var a=Aa({},e.$props,{calendar:o,value:e.innerValue,defaultValue:e.defaultValues[i],getClasses:e.getRangeClasses,partialUpdate:!1}),l={select:e.handleSelect,"update:calendar":0===i?e.updateStartCalendar:e.updateEndCalendar};return t("calendar-panel",{props:Aa({},a),on:Aa({},l)})}),i=this.prefixClass;return t("div",{class:"".concat(i,"-range-wrapper")},[o])}},Rr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.prefixClass+"-scrollbar",style:{position:"relative",overflow:"hidden"}},[o("div",{ref:"wrap",class:e.prefixClass+"-scrollbar-wrap",style:{marginRight:"-"+e.scrollbarWidth+"px"},on:{scroll:e.handleScroll}},[e._t("default")],2),e._v(" "),o("div",{class:e.prefixClass+"-scrollbar-track"},[o("div",{ref:"thumb",class:e.prefixClass+"-scrollbar-thumb",style:{height:e.thumbHeight,top:e.thumbTop},on:{mousedown:e.handleDragstart}})])])},staticRenderFns:[]},void 0,{inject:{prefixClass:{default:"mx"}},data:function(){return{scrollbarWidth:0,thumbTop:"",thumbHeight:""}},created:function(){this.scrollbarWidth=Ya(),document.addEventListener("mouseup",this.handleDragend)},beforeDestroy:function(){document.addEventListener("mouseup",this.handleDragend)},mounted:function(){this.$nextTick(this.getThumbSize)},methods:{getThumbSize:function(){var e=this.$refs.wrap;if(e){var t=100*e.clientHeight/e.scrollHeight;this.thumbHeight=100>t?"".concat(t,"%"):""}},handleScroll:function(e){var t=e.currentTarget,o=t.scrollHeight,i=t.scrollTop;this.thumbTop="".concat(100*i/o,"%")},handleDragstart:function(e){e.stopImmediatePropagation(),this._draggable=!0;var t=this.$refs.thumb.offsetTop;this._prevY=e.clientY-t,document.addEventListener("mousemove",this.handleDraging)},handleDraging:function(e){if(this._draggable){var t=e.clientY,o=this.$refs.wrap,i=o.scrollHeight,a=o.clientHeight,l=t-this._prevY;o.scrollTop=l*i/a}},handleDragend:function(){this._draggable&&(this._draggable=!1,document.removeEventListener("mousemove",this.handleDraging))}}},void 0,!1,void 0,!1,void 0,void 0,void 0),Or=function(e){return e=parseInt(e,10),10>e?"0".concat(e):"".concat(e)},Ir=function(e,t,o){if(Array.isArray(o))return o.filter(function(t){return 0<=t&&t<e});0>=t&&(t=1);for(var a=[],l=0;l<e;l+=t)a.push(l);return a},Nr=function e(t,o){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>=i)return void requestAnimationFrame(function(){t.scrollTop=o});var a=o-t.scrollTop;requestAnimationFrame(function(){var l=t.scrollTop+10*(a/i);return l>=o?void(t.scrollTop=o):void(t.scrollTop=l,e(t,o,i-10))})},Hr={name:"ListColumns",components:{ScrollbarVertical:Rr},inject:{prefixClass:{default:"mx"}},props:{date:Date,scrollDuration:{type:Number,default:100},getClasses:{type:Function,default:function(){return[]}},hourOptions:Array,minuteOptions:Array,secondOptions:Array,showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showSecond:{type:Boolean,default:!0},hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},secondStep:{type:Number,default:1},use12h:{type:Boolean,default:!1}},computed:{columns:function(){var e=[];return this.showHour&&e.push({type:"hour",list:this.getHoursList()}),this.showMinute&&e.push({type:"minute",list:this.getMinutesList()}),this.showSecond&&e.push({type:"second",list:this.getSecondsList()}),this.use12h&&e.push({type:"ampm",list:this.getAMPMList()}),e.filter(function(e){return 0<e.list.length})}},watch:{date:{handler:function(){var e=this;this.$nextTick(function(){e.scrollToSelected(e.scrollDuration)})}}},mounted:function(){this.scrollToSelected(0)},methods:{getHoursList:function(){var e=this;return Ir(this.use12h?12:24,this.hourStep,this.hourOptions).map(function(t){var o=new Date(e.date),i=Or(t);e.use12h&&(0===t&&(i="12"),12<=o.getHours()&&(t+=12));var a=o.setHours(t);return{value:a,text:i}})},getMinutesList:function(){var e=this;return Ir(60,this.minuteStep,this.minuteOptions).map(function(t){var o=new Date(e.date).setMinutes(t);return{value:o,text:Or(t)}})},getSecondsList:function(){var e=this;return Ir(60,this.secondStep,this.secondOptions).map(function(t){var o=new Date(e.date).setSeconds(t);return{value:o,text:Or(t)}})},getAMPMList:function(){var e=this;return["AM","PM"].map(function(t,o){var i=new Date(e.date),a=i.setHours(i.getHours()%12+12*o);return{text:t,value:a}})},scrollToSelected:function(e){for(var t=this.$el.querySelectorAll(".active"),o=0;o<t.length;o++){var a=t[o],l=Ua(a,this.$el);if(l){var n=a.offsetTop;Nr(l,n,e)}}},handleSelect:function(e){var t=e.target,o=e.currentTarget;if("LI"===t.tagName.toUpperCase()){var i=o.getAttribute("data-type"),a=parseInt(o.getAttribute("data-index"),10),l=parseInt(t.getAttribute("data-index"),10),n=this.columns[a].list[l].value;this.$emit("select",n,i)}}}},Ur=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.prefixClass+"-time-columns"},e._l(e.columns,function(t,a){return o("scrollbar-vertical",{key:a,class:e.prefixClass+"-time-column"},[o("ul",{class:e.prefixClass+"-time-list",attrs:{"data-type":t.type,"data-index":a},on:{click:e.handleSelect}},e._l(t.list,function(t,i){return o("li",{key:t.value,class:[e.prefixClass+"-time-item",e.getClasses(t.value)],attrs:{"data-index":i}},[e._v("\n        "+e._s(t.text)+"\n      ")])}),0)])}),1)},staticRenderFns:[]},void 0,Hr,void 0,!1,void 0,!1,void 0,void 0,void 0),Wr=function(e,t){e&&(e.scrollTop=t)},Yr={name:"ListOptions",components:{ScrollbarVertical:Rr},inject:{getLocale:{default:function(){return Oa}},prefixClass:{default:"mx"}},props:{date:Date,options:{type:[Object,Function],default:function(){return[]}},format:{type:String,default:"HH:mm:ss"},getClasses:{type:Function,default:function(){return[]}}},computed:{list:function(){var e=[],t=this.options;if("function"==typeof t)return t()||[];var o=qa(t.start),a=qa(t.end),l=qa(t.step),n=t.format||this.format;if(o&&a&&l)for(var s=o.minutes+60*o.hours,r=a.minutes+60*a.hours,c=l.minutes+60*l.hours,p=d((r-s)/c),u=0;u<=p;u++){var A=s+u*c,h=d(A/60),f=new Date(this.date).setHours(h,A%60,0);e.push({value:f,text:this.formatDate(f,n)})}return e}},mounted:function(){this.scrollToSelected()},methods:{formatDate:function(e,t){return Wi(e,t,{locale:this.getLocale().formatLocale})},scrollToSelected:function(){var e=this.$el.querySelector(".active");if(e){var t=Ua(e,this.$el);if(t){var o=e.offsetTop;Wr(t,o)}}},handleSelect:function(e){this.$emit("select",e,"time")}}},qr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("scrollbar-vertical",e._l(e.list,function(t){return o("div",{key:t.value,class:[e.prefixClass+"-time-option",e.getClasses(t.value)],on:{click:function(){return e.handleSelect(t.value)}}},[e._v("\n    "+e._s(t.text)+"\n  ")])}),0)},staticRenderFns:[]},void 0,Yr,void 0,!1,void 0,!1,void 0,void 0,void 0),Kr={name:"TimePanel",components:{ListColumns:Ur,ListOptions:qr},inject:{getLocale:{default:function(){return Oa}},prefixClass:{default:"mx"}},props:{value:{},defaultValue:{default:function(){var e=new Date;return e.setHours(0,0,0,0),e}},format:{default:"HH:mm:ss"},timeTitleFormat:{type:String,default:"YYYY-MM-DD"},showTimeHeader:{type:Boolean,default:!1},disabledTime:{type:Function,default:function(){return!1}},timePickerOptions:{type:[Object,Function],default:function(){return null}},hourOptions:Array,minuteOptions:Array,secondOptions:Array,hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},secondStep:{type:Number,default:1},showHour:{type:Boolean,default:void 0},showMinute:{type:Boolean,default:void 0},showSecond:{type:Boolean,default:void 0},use12h:{type:Boolean,default:void 0},scrollDuration:{type:Number,default:100}},computed:{innerValue:function(){return Ba(this.value,this.defaultValue)},title:function(){var e=this.timeTitleFormat,t=new Date(this.innerValue);return this.formatDate(t,e)},innerForamt:function(){return"string"==typeof this.format?this.format:"HH:mm:ss"},ShowHourMinuteSecondAMPM:function(){var e=this,t=this.innerForamt,o={showHour:/[HhKk]/.test(t),showMinute:/m/.test(t),showSecond:/s/.test(t),use12h:/a/i.test(t)},i={};return Object.keys(o).forEach(function(t){i[t]="boolean"==typeof e[t]?e[t]:o[t]}),i}},methods:{formatDate:function(e,t){return Wi(e,t,{locale:this.getLocale().formatLocale})},isDisabled:function(e){return this.disabledTime(new Date(e))},handleSelect:function(e,t){var o=new Date(e);this.isDisabled(e)||this.$emit("select",o,t)},handleClickTitle:function(){this.$emit("clicktitle")},getClasses:function(e){var t=new Date(e);return this.isDisabled(e)?"disabled":t.getTime()===this.innerValue.getTime()?"active":""}}},jr=Wa({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.prefixClass+"-time"},[e.showTimeHeader?o("div",{class:e.prefixClass+"-time-header"},[o("button",{class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-time-header-title",attrs:{type:"button"},on:{click:e.handleClickTitle}},[e._v("\n      "+e._s(e.title)+"\n    ")])]):e._e(),e._v(" "),o("div",{class:e.prefixClass+"-time-content"},[e.timePickerOptions?o("list-options",{attrs:{date:e.innerValue,"get-classes":e.getClasses,options:e.timePickerOptions,format:e.innerForamt},on:{select:e.handleSelect}}):o("list-columns",e._b({attrs:{date:e.innerValue,"get-classes":e.getClasses,"hour-options":e.hourOptions,"minute-options":e.minuteOptions,"second-options":e.secondOptions,"hour-step":e.hourStep,"minute-step":e.minuteStep,"second-step":e.secondStep,"scroll-duration":e.scrollDuration},on:{select:e.handleSelect}},"list-columns",e.ShowHourMinuteSecondAMPM,!1))],1)])},staticRenderFns:[]},void 0,Kr,void 0,!1,void 0,!1,void 0,void 0,void 0),Xr={name:"TimeRange",inject:{prefixClass:{default:"mx"}},props:Aa({},jr.props),data:function(){return{startValue:new Date(NaN),endValue:new Date(NaN)}},watch:{value:{immediate:!0,handler:function(){if(Ea(this.value)){var e=ma(this.value,2),t=e[0],o=e[1];this.startValue=t,this.endValue=o}else this.startValue=new Date(NaN),this.endValue=new Date(NaN)}}},methods:{emitChange:function(e,t){var o=[this.startValue,this.endValue];this.$emit("select",o,"time"===e?"time-range":e,t)},handleSelectStart:function(e,t){this.startValue=e,this.endValue.getTime()>=e.getTime()||(this.endValue=e),this.emitChange(t,0)},handleSelectEnd:function(e,t){this.endValue=e,this.startValue.getTime()<=e.getTime()||(this.startValue=e),this.emitChange(t,1)},disabledStartTime:function(e){return this.disabledTime(e,0)},disabledEndTime:function(e){return e.getTime()<this.startValue.getTime()||this.disabledTime(e,1)}},render:function(){var e=arguments[0],t=Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue,this.defaultValue],o=this.prefixClass;return e("div",{class:"".concat(o,"-range-wrapper")},[e(jr,{props:Aa({},Aa({},this.$props,{value:this.startValue,defaultValue:t[0],disabledTime:this.disabledStartTime})),on:Aa({},Aa({},this.$listeners,{select:this.handleSelectStart}))}),e(jr,{props:Aa({},Aa({},this.$props,{value:this.endValue,defaultValue:t[1],disabledTime:this.disabledEndTime})),on:Aa({},Aa({},this.$listeners,{select:this.handleSelectEnd}))})])}},Qr={name:"DatetimePanel",inject:{prefixClass:{default:"mx"}},emits:["select","update:show-time-panel"],props:Aa({},Mr.props,{},jr.props,{showTimePanel:{type:Boolean,default:void 0}}),data:function(){return{defaultTimeVisible:!1,currentValue:this.value}},computed:{timeVisible:function(){return"boolean"==typeof this.showTimePanel?this.showTimePanel:this.defaultTimeVisible}},watch:{value:function(e){this.currentValue=e}},methods:{closeTimePanel:function(){this.defaultTimeVisible=!1,this.$emit("update:show-time-panel",!1)},openTimePanel:function(){this.defaultTimeVisible=!0,this.$emit("update:show-time-panel",!0)},emitDate:function(e,t){this.$emit("select",e,t)},handleSelect:function(e,t){"date"===t&&this.openTimePanel();var o=Fa(e,Ba(this.value,this.defaultValue));return this.disabledTime(new Date(o))&&(o=Fa(e,this.defaultValue),this.disabledTime(new Date(o)))?void(this.currentValue=o):void this.emitDate(o,t)}},render:function(){var e=arguments[0],t={props:Aa({},Ma(this.$props,Object.keys(Mr.props)),{type:"date",value:this.currentValue}),on:{select:this.handleSelect}},o={props:Aa({},Ma(this.$props,Object.keys(jr.props)),{showTimeHeader:!0,value:this.currentValue}),on:{select:this.emitDate,clicktitle:this.closeTimePanel}},i=this.prefixClass;return e("div",[e(Mr,yr([{},t])),this.timeVisible&&e(jr,yr([{class:"".concat(i,"-calendar-time")},o]))])}},Gr={name:"DatetimeRange",inject:{prefixClass:{default:"mx"}},emits:["select","update:show-time-panel"],props:Aa({},Vr.props,{},Xr.props,{showTimePanel:{type:Boolean,default:void 0}}),data:function(){return{defaultTimeVisible:!1,currentValue:this.value}},computed:{timeVisible:function(){return"boolean"==typeof this.showTimePanel?this.showTimePanel:this.defaultTimeVisible}},watch:{value:function(e){this.currentValue=e}},methods:{closeTimePanel:function(){this.defaultTimeVisible=!1,this.$emit("update:show-time-panel",!1)},openTimePanel:function(){this.defaultTimeVisible=!0,this.$emit("update:show-time-panel",!0)},emitDate:function(e,t){this.$emit("select",e,t)},handleSelect:function(e,t){var o=this;"date"===t&&this.openTimePanel();var a=Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue,this.defaultValue],l=e.map(function(e,t){var i=Ea(o.value)?o.value[t]:a[t];return Fa(e,i)});return l[1].getTime()<l[0].getTime()&&(l=[l[0],l[0]]),l.some(this.disabledTime)&&(l=e.map(function(e,t){return Fa(e,a[t])}),l.some(this.disabledTime))?void(this.currentValue=l):void this.emitDate(l,t)}},render:function(){var e=arguments[0],t={props:Aa({},Ma(this.$props,Object.keys(Vr.props)),{type:"date",value:this.currentValue}),on:{select:this.handleSelect}},o={props:Aa({},Ma(this.$props,Object.keys(Xr.props)),{value:this.currentValue,showTimeHeader:!0}),on:{select:this.emitDate,clicktitle:this.closeTimePanel}},i=this.prefixClass;return e("div",[e(Vr,yr([{},t])),this.timeVisible&&e(Xr,yr([{class:"".concat(i,"-calendar-time")},o]))])}},Jr={default:Mr,time:jr,datetime:Qr},Zr={default:Vr,time:Xr,datetime:Gr},ed={name:"DatePicker",provide:function(){var e=this;return{getLocale:function(){return e.locale},getWeek:this.getWeek,prefixClass:this.prefixClass,dispatchDatePicker:this.$emit.bind(this)}},props:Aa({},Qr.props,{value:{},valueType:{type:String,default:"date"},type:{type:String,default:"date"},format:{type:String},formatter:{type:Object},range:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},rangeSeparator:{type:String},lang:{type:[String,Object]},placeholder:{type:String,default:""},editable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},prefixClass:{type:String,default:"mx"},inputClass:{},inputAttr:{type:Object,default:function(){return{}}},appendToBody:{type:Boolean,default:!0},open:{type:Boolean,default:void 0},popupClass:{},popupStyle:{type:Object,default:function(){return{}}},inline:{type:Boolean,default:!1},confirm:{type:Boolean,default:!1},confirmText:{type:String,default:"OK"},renderInputText:{type:Function},shortcuts:{type:Array,validator:function(e){return Array.isArray(e)&&e.every(function(e){return La(e)&&"string"==typeof e.text&&"function"==typeof e.onClick})},default:function(){return[]}}}),data:function(){return{currentValue:null,userInput:null,defaultOpen:!1}},computed:{popupVisible:function(){return!this.disabled&&("boolean"==typeof this.open?this.open:this.defaultOpen)},innerRangeSeparator:function(){return this.rangeSeparator||(this.multiple?",":" ~ ")},innerFormat:function(){var e={date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss",year:"YYYY",month:"YYYY-MM",time:"HH:mm:ss",week:"w"};return this.format||e[this.type]||e.date},innerValue:function(){var e=this.value;return this.validMultipleType?(e=Array.isArray(e)?e:[],e.map(this.value2date)):this.range?(e=Array.isArray(e)?e.slice(0,2):[null,null],e.map(this.value2date)):this.value2date(e)},text:function(){var e=this;return null===this.userInput?"function"==typeof this.renderInputText?this.renderInputText(this.innerValue):this.isValidValue(this.innerValue)?Array.isArray(this.innerValue)?this.innerValue.map(function(t){return e.formatDate(t)}).join(this.innerRangeSeparator):this.formatDate(this.innerValue):"":this.userInput},showClearIcon:function(){return!this.disabled&&this.clearable&&this.text},locale:function(){return La(this.lang)?Va(Oa(),this.lang):Oa(this.lang)},validMultipleType:function(){return this.multiple&&!this.range&&-1!==["date","month","year"].indexOf(this.type)}},watch:{innerValue:{immediate:!0,handler:function(e){this.currentValue=e}}},created:function(){"object"===da(this.format)&&console.warn("[vue2-datepicker]: The prop `format` don't support Object any more. You can use the new prop `formatter` to replace it")},methods:{handleClickOutSide:function(e){var t=e.target;this.$el.contains(t)||this.closePopup()},getFormatter:function(e){return La(this.formatter)&&this.formatter[e]||La(this.format)&&this.format[e]},getWeek:function(e,t){return"function"==typeof this.getFormatter("getWeek")?this.getFormatter("getWeek")(e,t):Ni(e,t)},parseDate:function(e,t){if(t=t||this.innerFormat,"function"==typeof this.getFormatter("parse"))return this.getFormatter("parse")(e,t);var o=new Date;return ra(e,t,{locale:this.locale.formatLocale,backupDate:o})},formatDate:function(e,t){return t=t||this.innerFormat,"function"==typeof this.getFormatter("stringify")?this.getFormatter("stringify")(e,t):Wi(e,t,{locale:this.locale.formatLocale})},value2date:function(e){switch(this.valueType){case"date":return e instanceof Date?new Date(e.getTime()):new Date(NaN);case"timestamp":return"number"==typeof e?new Date(e):new Date(NaN);case"format":return"string"==typeof e?this.parseDate(e):new Date(NaN);default:return"string"==typeof e?this.parseDate(e,this.valueType):new Date(NaN);}},date2value:function(e){if(!ka(e))return null;switch(this.valueType){case"date":return e;case"timestamp":return e.getTime();case"format":return this.formatDate(e);default:return this.formatDate(e,this.valueType);}},emitValue:function(e,t){this.userInput=null;var o=Array.isArray(e)?e.map(this.date2value):this.date2value(e);return this.$emit("input",o),this.$emit("change",o,t),this.afterEmitValue(t),o},afterEmitValue:function(e){e&&e!==this.type&&"time"!==e||this.closePopup()},isValidValue:function(e){return this.validMultipleType?Sa(e):this.range?Ea(e):ka(e)},isValidValueAndNotDisabled:function(e){if(!this.isValidValue(e))return!1;var t="function"==typeof this.disabledDate?this.disabledDate:function(){return!1},o="function"==typeof this.disabledTime?this.disabledTime:function(){return!1};return Array.isArray(e)||(e=[e]),e.every(function(e){return!t(e)&&!o(e)})},handleMultipleDates:function(e,t){if(this.validMultipleType&&t){var o=t.filter(function(t){return t.getTime()!==e.getTime()});return o.length===t.length&&o.push(e),o}return e},handleSelectDate:function(e,t,o){e=this.handleMultipleDates(e,o),this.confirm?this.currentValue=e:this.emitValue(e,this.validMultipleType?"multiple-".concat(t):t)},clear:function(){this.emitValue(this.range?[null,null]:null),this.$emit("clear")},handleClear:function(e){e.stopPropagation(),this.clear()},handleConfirmDate:function(){var e=this.emitValue(this.currentValue);this.$emit("confirm",e)},handleSelectShortcut:function(e){var t=e.currentTarget.getAttribute("data-index"),o=this.shortcuts[parseInt(t,10)];if(La(o)&&"function"==typeof o.onClick){var i=o.onClick(this);i&&this.emitValue(i)}},openPopup:function(e){this.popupVisible||(this.defaultOpen=!0,this.$emit("open",e),this.$emit("update:open",!0))},closePopup:function(){this.popupVisible&&(this.defaultOpen=!1,this.$emit("close"),this.$emit("update:open",!1))},blur:function(){this.$refs.input&&this.$refs.input.blur()},focus:function(){this.$refs.input&&this.$refs.input.focus()},handleInputChange:function(){var e=this;if(this.editable&&null!==this.userInput){var t=this.userInput.trim();if(this.userInput=null,""===t)return void this.clear();var o;if(this.validMultipleType)o=t.split(this.innerRangeSeparator).map(function(t){return e.parseDate(t.trim())});else if(this.range){var i=t.split(this.innerRangeSeparator);2!==i.length&&(i=t.split(this.innerRangeSeparator.trim())),o=i.map(function(t){return e.parseDate(t.trim())})}else o=this.parseDate(t);this.isValidValueAndNotDisabled(o)?(this.emitValue(o),this.blur()):this.$emit("input-error",t)}},handleInputInput:function(e){this.userInput="string"==typeof e?e:e.target.value},handleInputKeydown:function(e){var t=e.keyCode;9===t?this.closePopup():13===t&&this.handleInputChange()},handleInputBlur:function(e){this.$emit("blur",e)},handleInputFocus:function(e){this.openPopup(e),this.$emit("focus",e)},hasSlot:function(e){return!!(this.$slots[e]||this.$scopedSlots[e])},renderSlot:function(e,t,o){var i=this.$scopedSlots[e];return i?i(o)||t:this.$slots[e]||t},renderInput:function(){var e=this.$createElement,t=this.prefixClass,o=Aa({name:"date",type:"text",autocomplete:"off",value:this.text,class:this.inputClass||"".concat(this.prefixClass,"-input"),readonly:!this.editable,disabled:this.disabled,placeholder:this.placeholder},this.inputAttr),i=o.value,a=o.class,l=fa(o,["value","class"]),n={keydown:this.handleInputKeydown,focus:this.handleInputFocus,blur:this.handleInputBlur,input:this.handleInputInput,change:this.handleInputChange},s=this.renderSlot("input",e("input",{domProps:{value:i},class:a,attrs:Aa({},l),on:Aa({},n),ref:"input"}),{props:o,events:n}),r="time"===this.type?e(Sr):e(Er);return e("div",{class:"".concat(t,"-input-wrapper"),on:{mousedown:this.openPopup}},[s,this.showClearIcon?e("i",{class:"".concat(t,"-icon-clear"),on:{mousedown:this.handleClear}},[this.renderSlot("icon-clear",e(Br))]):null,e("i",{class:"".concat(t,"-icon-calendar")},[this.renderSlot("icon-calendar",r)])])},renderContent:function(){var e=this.$createElement,t=this.range?Zr:Jr,o=t[this.type]||t.default,i=Aa({},Ma(this.$props,Object.keys(o.props)),{value:this.currentValue}),a=Aa({},Ma(this.$listeners,o.emits||[]),{select:this.handleSelectDate}),l=e(o,yr([{},{props:i,on:a,ref:"picker"}]));return e("div",{class:"".concat(this.prefixClass,"-datepicker-body")},[this.renderSlot("content",l,{value:this.currentValue,emit:this.handleSelectDate})])},renderSidebar:function(){var e=this,t=this.$createElement,o=this.prefixClass;return t("div",{class:"".concat(o,"-datepicker-sidebar")},[this.renderSlot("sidebar",null,{value:this.currentValue,emit:this.handleSelectDate}),this.shortcuts.map(function(a,l){return t("button",{key:l,attrs:{"data-index":l,type:"button"},class:"".concat(o,"-btn ").concat(o,"-btn-text ").concat(o,"-btn-shortcut"),on:{click:e.handleSelectShortcut}},[a.text])})])},renderHeader:function(){var e=this.$createElement;return e("div",{class:"".concat(this.prefixClass,"-datepicker-header")},[this.renderSlot("header",null,{value:this.currentValue,emit:this.handleSelectDate})])},renderFooter:function(){var e=this.$createElement,t=this.prefixClass;return e("div",{class:"".concat(t,"-datepicker-footer")},[this.renderSlot("footer",null,{value:this.currentValue,emit:this.handleSelectDate}),this.confirm?e("button",{attrs:{type:"button"},class:"".concat(t,"-btn ").concat(t,"-datepicker-btn-confirm"),on:{click:this.handleConfirmDate}},[this.confirmText]):null])}},render:function(){var e=arguments[0],t=this.prefixClass,o=this.inline,i=this.disabled,a=this.hasSlot("sidebar")||this.shortcuts.length?this.renderSidebar():null,l=e("div",{class:"".concat(t,"-datepicker-content")},[this.hasSlot("header")?this.renderHeader():null,this.renderContent(),this.hasSlot("footer")||this.confirm?this.renderFooter():null]),n;return e("div",{class:(n={},ca(n,"".concat(t,"-datepicker"),!0),ca(n,"".concat(t,"-datepicker-range"),this.range),ca(n,"".concat(t,"-datepicker-inline"),o),ca(n,"disabled",i),n)},[o?null:this.renderInput(),o?e("div",{class:"".concat(t,"-datepicker-main")},[a,l]):e(kr,{ref:"popup",class:this.popupClass,style:this.popupStyle,attrs:{visible:this.popupVisible,appendToBody:this.appendToBody},on:{clickoutside:this.handleClickOutSide}},[a,l])])}},td;ed.locale=Ra,ed.install=function(e){e.component(ed.name,ed)},"undefined"!=typeof window&&window.Vue&&ed.install(window.Vue),pa(ed,{CalendarPanel:Mr,CalendarRange:Vr,TimePanel:jr,TimeRange:Xr,DatetimePanel:Qr,DatetimeRange:Gr});var od={components:{"vue-excel-filter":Rs,"panel-filter":Ns,"panel-setting":Ws,"panel-find":Ks,"date-picker":ed},props:{disablePanelSetting:{type:Boolean,default(){return!1}},disablePanelFilter:{type:Boolean,default(){return!1}},value:{type:Array,default(){return[]}},rowStyle:{type:Function,default(){return{}}},cellStyle:{type:Function,default(){return{}}},headerLabel:{type:Function,default(e){return e}},recordLabel:{type:Function,default(e){return e}},noFinding:{type:Boolean,default:!1},noFindingNext:{type:Boolean,default:!1},filterRow:{type:Boolean,default:!1},freeSelect:{type:Boolean,default:!1},noFooter:{type:Boolean,default:!1},noPaging:{type:Boolean,default:!1},noNumCol:{type:Boolean,default:!1},noMouseScroll:{type:Boolean,default:!1},page:{type:Number,default:0},enterToSouth:{type:Boolean,default:!1},nFilterCount:{type:Number,default:1e3},height:{type:String,default:""},width:{type:String,default:"100%"},autocomplete:{type:Boolean,default:!1},autocompleteCount:{type:Number,default:50},readonly:{type:Boolean,default:!1},readonlyStyle:{type:Object,default(){return{}}},remember:{type:Boolean,default:!1},register:{type:Function,default:null},allowAddCol:{type:Boolean,default:!1},noHeaderEdit:{type:Boolean,default:!1},addColumn:{type:Function,default:null},spellcheck:{type:Boolean,default:!1},newIfBottom:{type:Boolean,default:!1},validate:{type:Function,default:null},localizedLabel:{type:Object,default(){return{footerLeft:(e,t,o)=>`Record ${e} to ${t} of ${o}`,first:"First",previous:"Previous",next:"Next",last:"Last",footerRight:{selected:"Selected:",filtered:"Filtered:",loaded:"Loaded:"},processing:"Processing",tableSetting:"Table Setting",exportExcel:"Export Excel",importExcel:"Import Excel",back:"Back",reset:"Default",sortingAndFiltering:"Sorting And Filtering",sortAscending:"Sort Ascending",sortDescending:"Sort Descending",near:"\u2252 Near",exactMatch:"= Exact Match",notMatch:"\u2260 Not Match",greaterThan:"&gt; Greater Than",greaterThanOrEqualTo:"\u2265 Greater Than or Equal To",lessThan:"&lt; Less Than",lessThanOrEqualTo:"\u2264 Less Than Or Equal To",regularExpression:"~ Regular Expression",customFilter:"Custom Filter",listFirstNValuesOnly:e=>`List first ${e} values only`,apply:"Apply",noRecordIsRead:"No record is read",readonlyColumnDetected:"Readonly column detected",columnHasValidationError:(e,t)=>`Column ${e} has validation error: ${t}`,rowHasValidationError:(e,t,o)=>`Row ${e} has validation error for column ${t}: ${o}`,noMatchedColumnName:"No matched column name",invalidInputValue:"Invalid input value",missingKeyColumn:"Missing key column",noRecordIndicator:"No record"}}},recordFilter:{type:Function,default(){return!0}}},data(){const e=this.noPaging?999999:20;return{version:"1.3",tableContent:null,systable:null,colgroupTr:null,labelTr:null,filterTr:null,recordBody:null,footer:null,pageSize:e,pageTop:0,selected:{},selectedCount:0,prevSelect:-1,processing:!1,rowIndex:{},currentRecord:null,currentRowPos:0,currentColPos:0,currentField:null,currentCell:null,inputBox:null,inputBoxShow:0,inputSquare:null,autocompleteInputs:[],autocompleteSelect:-1,errmsg:{},rowerr:{},tip:"",colHash:"",fields:[],focused:!1,mousein:!1,inputBoxChanged:!1,columnFilter:{},inputFind:"",calCellLeft:0,calCellTop:0,calCellTop2:29,frontdrop:null,sortPos:0,sortDir:0,redo:[],lazyTimeout:{},lazyBuffer:{},hScroller:{},vScroller:{},leftMost:0,showDatePicker:!1,inputDateTime:"",table:[],filteredValue:[],lastFilterTime:"",summaryRow:!1,summary:{},showFilteredOnly:!0,showSelectedOnly:!1}},computed:{token(){const e=Array.from(document.querySelectorAll(".vue-excel-editor")).indexOf(this.$el);return`vue-excel-editor-${e}`},columnFilterString(){return Object.keys(this.columnFilter).forEach(e=>{""===this.columnFilter[e].trim()&&delete this.columnFilter[e]}),JSON.stringify(this.columnFilter)},pagingTable(){return this.table.slice(this.pageTop,this.pageTop+this.pageSize)},pageBottom(){return 0===this.filteredValue.length?0:this.pageTop+this.pageSize>this.table.length?this.table.length:this.pageTop+this.pageSize},setting:{get(){return null},set(e){if(e.fields){if(e.fields.length!==this.fields.length)return;let t=!0;const o=e.fields.map(e=>{const o=this.fields.find(t=>t.name===e.name);return o?("undefined"!=typeof e.invisible&&(o.invisible=e.invisible),"undefined"!=typeof e.width&&(o.width=e.width),"undefined"!=typeof e.label&&(o.label=e.label)):t=!1,o});t&&(this.fields=o,this.$forceUpdate())}}}},watch:{value(){this.lazy(()=>{this.refresh(),this.pageTop>this.table.length&&this.lastPage()})},columnFilterString(){this.lastFilterTime=new Date().getTime()%1e8+"",this.processing=!0,setTimeout(()=>{this.pageTop=0,this.refresh(),this.processing=!1},0)},fields:{handler(){this.lazy(()=>{const e=this.getSetting();this.remember&&(localStorage[window.location.pathname+"."+this.token]=JSON.stringify(e)),this.$emit("setting",e)})},deep:!0},processing(e){if(e){const e=this.$el.children[0].getBoundingClientRect();this.frontdrop.style.top=e.top+"px",this.frontdrop.style.left=e.left+"px",this.frontdrop.style.height=e.height+"px",this.frontdrop.style.width=e.width+"px"}},pageTop(e){this.$emit("page-changed",e,e+this.pageSize-1)},pageSize(e){this.$emit("page-changed",this.pageTop,this.pageTop+e-1)}},beforeDestroy(){window.removeEventListener("resize",this.winResize),window.removeEventListener("paste",this.winPaste),window.removeEventListener("keydown",this.winKeydown),window.removeEventListener("keyup",this.winKeyup),window.removeEventListener("scroll",this.winScroll),window.removeEventListener("wheel",this.mousewheel)},mounted(){if(this.tableContent=this.$refs.tableContent,this.systable=this.$refs.systable,this.colgroupTr=this.systable.children[0],this.labelTr=this.systable.children[1].children[0],this.filterTr=this.systable.children[1].children[1],this.recordBody=this.systable.children[2],this.footer=this.$refs.footer,this.inputSquare=this.$refs.inputSquare,this.inputBox=this.$refs.inputBox,this.frontdrop=this.$refs.frontdrop,this.height&&(this.systable.parentNode.style.height=this.height),this.reset(),this.lazy(()=>{this.labelTr.children[0].style.height=this.labelTr.offsetHeight+"px",this.calCellTop2=this.labelTr.offsetHeight,this.refreshPageSize(),this.tableContent.scrollTo(0,this.tableContent.scrollTop),this.calStickyLeft()},200),window.addEventListener("resize",this.winResize),window.addEventListener("paste",this.winPaste),window.addEventListener("keydown",this.winKeydown),window.addEventListener("keyup",this.winKeyup),window.addEventListener("scroll",this.winScroll),window.addEventListener("wheel",this.mousewheel,{passive:!1}),this.remember){const e=localStorage[window.location.pathname+"."+this.token];if(e){const t=JSON.parse(e);t.colHash===this.colHash&&(this.setting=t)}}},methods:{componentTabInto(t){9!==t.keyCode||this.moveInputSquare(this.currentRowPos,this.currentColPos)||this.moveInputSquare(0,0)},reset(){this.errmsg={},this.redo=[],this.showFilteredOnly=!0,this.showSelectedOnly=!1,this.columnFilter={},this.sortPos=0,this.sortDir=0,this.inputFind="",this.pageTop=0,this.selected={},this.selectedCount=0,this.prevSelect=-1,this.processing=!1,this.rowIndex={},this.refresh()},toggleSelectView(t){return t&&t.stopPropagation(),this.showSelectedOnly=!this.showSelectedOnly,this.refresh()},toggleFilterView(t){return t&&t.stopPropagation(),this.showFilteredOnly=!this.showFilteredOnly,this.refresh()},resetColumn(){this.fields=[],this.$slots.default.forEach(e=>e.componentInstance?e.componentInstance.init():0),this.tableContent.scrollTo(0,this.tableContent.scrollTop),this.calStickyLeft()},registerColumn(e){let t=this.fields.findIndex(t=>t.pos>e.pos);-1===t&&(t=this.fields.length),this.fields.splice(t,0,e),this.register&&this.register(e,t),e.register&&e.register(e,t),e.summary&&(this.summaryRow=!0),this.colHash=this.hashCode(this.version+JSON.stringify(this.fields))},insertColumn(e){const t="COL-"+Math.random().toString().slice(2,6);let o={name:t,label:t,type:"string",width:"100px",validate:null,change:null,link:null,sort:null,keyField:!1,sticky:!1,allowKeys:null,mandatory:!1,lengthLimit:0,autocomplete:this.autocomplete,textTransform:null,initStyle:"left",invisible:!1,readonly:this.readonly,pos:0,options:null,summary:null,toValue:e=>e,toText:e=>e,register:null};this.addColumn&&(o=this.addColumn(o)),this.newColumn(o,e)},newColumn(e,t){this.fields.splice(t,0,e),this.register&&this.register(e,t),e.register&&e.register(e,t),e.summary&&(this.summaryRow=!0),this.colHash=this.hashCode(this.version+JSON.stringify(this.fields))},autoRegisterAllColumns(e){const t=e.slice(0,25).reduce((e,t)=>Object.keys(t).map((o,a)=>!e||t[o].length>e[a]?t[o].length:e[a]),0).map(e=>a(r(8.2*e,55),250));Object.keys(e[0]).forEach((e,o)=>{"$id"===e||this.registerColumn({name:e,label:e,type:t[o]?"string":"number",width:(t[o]?t[o]:75)+"px",validate:null,change:null,link:null,keyField:!1,sticky:!1,tabStop:!0,allowKeys:null,mandatory:!1,lengthLimit:0,autocomplete:this.autocomplete,initStyle:{textAlign:t[o]?"left":"right"},invisible:!1,readonly:this.readonly,pos:0,options:null,summary:null,sort:null,toValue:e=>e,toText:e=>e,register:null})})},refresh(){this.prevSelect=-1,0===this.fields.length&&this.value.length&&Object.keys(this.value[0])&&this.autoRegisterAllColumns(this.value),this.calTable(),this.refreshPageSize()},calTable(){let e=new Date().getTime()%1e8+"";if(this.value.forEach((t,o)=>{t.$id||(t.$id=e+"-"+("000000"+o).slice(-7))}),!1===this.showFilteredOnly)this.table=this.value;else{const e=Object.keys(this.columnFilter),t={};e.forEach(e=>{switch(!0){case this.columnFilter[e].startsWith("<="):t[e]={type:1,value:this.columnFilter[e].slice(2).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith("<>"):t[e]={type:9,value:this.columnFilter[e].slice(2).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("<"):t[e]={type:2,value:this.columnFilter[e].slice(1).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith(">="):t[e]={type:3,value:this.columnFilter[e].slice(2).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith(">"):t[e]={type:4,value:this.columnFilter[e].slice(1).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith("="):t[e]={type:0,value:this.columnFilter[e].slice(1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("*")&&this.columnFilter[e].endsWith("*"):t[e]={type:5,value:this.columnFilter[e].slice(1).slice(0,-1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("*")&&!this.columnFilter[e].slice(1).includes("*"):t[e]={type:6,value:this.columnFilter[e].slice(1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("~"):t[e]={type:8,value:this.columnFilter[e].slice(1).trim()};break;case this.columnFilter[e].endsWith("*")&&!this.columnFilter[e].slice(0,-1).includes("*"):t[e]={type:7,value:this.columnFilter[e].slice(0,-1).trim().toUpperCase()};break;case this.columnFilter[e].includes("*")||this.columnFilter[e].includes("?"):t[e]={type:8,value:"^"+this.columnFilter[e].replace(/\*/g,".*").replace(/\?/g,".").trim()+"$"};break;default:t[e]={type:5,value:this.columnFilter[e].trim().toUpperCase()};}}),this.filteredValue=this.value.filter(e=>this.recordFilter(e)),this.table=0===e.length?this.filteredValue:this.filteredValue.filter(o=>{if(o.$id>this.lastFilterTime)return!0;const i={};e.forEach(e=>{const a=o[this.fields[e].name];i[e]="number"===this.fields[e].type&&4>=t[e].type?a:"undefined"==typeof a||null===a?"":(a+"").toUpperCase()});for(let a=0;a<e.length;a++){const o=e[a];switch(t[o].type){case 0:if(`${i[o]}`!=`${t[o].value}`)return!1;break;case 1:if(t[o].value<i[o])return!1;break;case 2:if(t[o].value<=i[o])return!1;break;case 3:if(t[o].value>i[o])return!1;break;case 4:if(t[o].value>=i[o])return!1;break;case 5:if(!i[o].includes(t[o].value))return!1;break;case 6:if(!i[o].endsWith(t[o].value))return!1;break;case 7:if(!i[o].startsWith(t[o].value))return!1;break;case 8:if(!new RegExp(t[o].value,"i").test(i[o]))return!1;break;case 9:if(`${i[o]}`==`${t[o].value}`)return!1;}}return!0})}this.reviseSelectedAfterTableChange(),this.showSelectedOnly&&(this.table=this.table.filter((e,t)=>this.selected[t]),this.reviseSelectedAfterTableChange()),this.calSummary()},calStickyLeft(){let e=0,t=0;this.leftMost=-1,Array.from(this.labelTr.children).forEach(o=>{e+=o.offsetWidth;const i=this.fields[t++];i&&(i.sticky?(i.left=e+"px",this.leftMost=-1):-1===this.leftMost&&(this.leftMost=e))}),this.$forceUpdate()},renderColumnCellStyle(e){let t=e.initStyle;return e.readonly&&(t=Object.assign(t,this.readonlyStyle)),e.left&&(t=Object.assign(t,{left:e.left})),t},localeDate(e){"undefined"==typeof e&&(e=new Date);const t=e=>10>e?"0"+e:e;return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},calSummary(e){this.fields.forEach(t=>{if(!t.summary)return;const o=t.name;if(e&&e!==o)return;let i="";const l=new Date().getTime(),s=this.localeDate(),r=s.slice(0,19),d=s.slice(0,10);switch(t.summary){case"sum":i=this.table.reduce((e,t)=>e+ +(t[o]?t[o]:0),0),i=+(n(i+"e+5")+"e-5");break;case"avg":i=this.table.reduce((e,t)=>e+ +(t[o]?t[o]:0),0)/this.table.length,i=+(n(i+"e+5")+"e-5");break;case"max":i=this.table.reduce((e,t)=>e>t[o]?e:t[o],Number.MIN_VALUE);break;case"min":i=this.table.reduce((e,t)=>e<t[o]?e:t[o],Number.MAX_VALUE);break;case"count":switch(t.type){case"checkYN":i=this.table.reduce((e,t)=>e+("Y"===t[o]?1:0),0);break;case"check10":i=this.table.reduce((e,t)=>e+("1"===t[o]?1:0),0);break;case"checkTF":i=this.table.reduce((e,t)=>e+("T"===t[o]?1:0),0);break;case"date":return i=this.table.reduce((e,t)=>e+(t[o]>=d?1:0),0),void(this.summary[o]=i);case"datetime":return i=this.table.reduce((e,t)=>e+(t[o]>=r?1:0),0),void(this.summary[o]=i);case"datetimesec":return i=this.table.reduce((e,t)=>e+(t[o]>=s?1:0),0),void(this.summary[o]=i);case"datetick":case"datetimetick":case"datetimesectick":return i=this.table.reduce((e,t)=>e+(t[o]>=l?1:0),0),void(this.summary[o]=i);default:i=this.table.reduce((e,t)=>e+(t[o]?1:0),0);}}"number"===t.type&&isNaN(i)||(this.summary[o]=t.toText(i))})},getKeys(e){e||(e=this.currentRecord);const t=this.fields.filter(e=>e.keyField).map(t=>e[t.name]);return t.length&&""!==t.join()?t:[e.$id]},setFilter(e,t){const o=this.$refs[`filter-${e}`][0];o.$el.textContent=t,o.$emit("input",t)},clearFilter(e){e?this.setFilter(e,""):this.columnFilter={}},columnSuppress(){if(0===this.table.length)return;const e={};this.table.forEach(t=>{Object.keys(t).forEach(o=>{t[o]&&(e[o]=1)})});const t=Object.keys(e);this.fields.forEach(e=>{t.includes(e.name)||(e.invisible=!0)})},columnAutoWidth(e){if(0===this.table.length)return;let t=this.fields;e&&(t=[this.fields.find(t=>t.name===e)]);const o={};this.table.forEach(e=>{t.forEach(t=>{e[t.name]&&(!o[t.name]||o[t.name]<e[t.name].length)&&(o[t.name]=e[t.name].length)})}),t.forEach(e=>{let t=12*o[e.name];450<t&&(t=450),e.width=t+"px"})},showDatePickerDiv(){if(!this.$refs.dpContainer)return;const e=this.currentCell.getBoundingClientRect();this.$refs.dpContainer.style.left=e.left+"px",this.$refs.dpContainer.style.top=e.bottom+"px",this.inputDateTime=this.currentCell.textContent,this.showDatePicker=!0,this.lazy(()=>{if(this.$refs.dpContainer){const t=this.$refs.dpContainer.getBoundingClientRect();t.bottom>window.innerHeight&&(this.$refs.dpContainer.style.top=e.top-t.height+"px"),t.right>window.innerWidth&&(this.$refs.dpContainer.style.left=window.innerWidth-t.width+"px")}})},datepickerClick(){this.inputBox.value=this.inputDateTime,this.inputBoxShow=0,this.inputCellWrite(this.inputDateTime),this.showDatePicker=!1,this.focused=!0},calVScroll(){let e=this.labelTr.getBoundingClientRect().height;this.filterRow&&(e+=29),this.vScroller.top=e,this.noFooter||(e+=25),this.summaryRow&&(e+=27);const t=this.$el.getBoundingClientRect().height;this.vScroller.height=t-e;const o=this.vScroller.height/(24*this.table.length);this.vScroller.buttonHeight=r(24,this.vScroller.height*o);const i=(this.tableContent.scrollTop+24*this.pageTop)/(24*this.table.length-this.vScroller.height);this.vScroller.buttonTop=(this.vScroller.height-this.vScroller.buttonHeight)*i,this.$forceUpdate()},vsMouseDown(t){t.stopPropagation();const e=t.offsetY-this.vScroller.buttonHeight/2;let o=r(0,e);o=a(o,this.vScroller.height-this.vScroller.buttonHeight),o/=this.vScroller.height-this.vScroller.buttonHeight,this.noPaging?this.tableContent.scrollTo(this.tableContent.scrollLeft,24*this.table.length*o):(this.vScroller.buttonTop=o*(this.vScroller.height-this.vScroller.buttonHeight),this.$refs.vScrollButton.style.marginTop=this.vScroller.buttonTop+"px",this.pageTop=n((this.table.length-this.pageSize)*o))},vsbMouseDown(t){t.stopPropagation(),this.vScroller.mouseY||(this.vScroller.saveButtonTop=this.vScroller.buttonTop,this.vScroller.mouseY=t.clientY,window.addEventListener("mousemove",this.vsbMouseMove),window.addEventListener("mouseup",this.vsbMouseUp),this.$refs.vScrollButton.classList.add("focus"))},vsbMouseUp(){if(window.removeEventListener("mousemove",this.vsbMouseMove),window.removeEventListener("mouseup",this.vsbMouseUp),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")}),this.vScroller.mouseY=0,!this.noPaging){const e=this.vScroller.buttonTop/(this.vScroller.height-this.vScroller.buttonHeight);this.pageTop=n((this.table.length-this.pageSize)*e)}this.vScroller.runner="",this.$forceUpdate()},vsbMouseMove(t){if(0===t.buttons)this.vsbMouseUp();else{const e=t.clientY-this.vScroller.mouseY;if(this.noPaging){const t=(this.vScroller.saveButtonTop+e)/(this.vScroller.height-this.vScroller.buttonHeight);this.tableContent.scrollTo(this.tableContent.scrollLeft,24*this.table.length*t)}else{this.vScroller.buttonTop=r(0,a(this.vScroller.height-this.vScroller.buttonHeight,this.vScroller.saveButtonTop+e)),this.$refs.vScrollButton.style.marginTop=this.vScroller.buttonTop+"px";const t=this.vScroller.buttonTop/(this.vScroller.height-this.vScroller.buttonHeight),o=n((this.table.length-this.pageSize)*t)+1,i=this.table[o];this.vScroller.runner=o+"<br>"+this.fields.filter((e,t)=>e.keyField||e.sticky||this.sortPos===t).map(e=>e.label+": "+i[e.name]).join("<br>"),this.$forceUpdate()}}},ftMouseDown(t){const e=this.footer.getBoundingClientRect(),o=(t.x-e.left-40)/(e.width-40),i=this.systable.getBoundingClientRect().width,a=this.tableContent.getBoundingClientRect().width;this.tableContent.scrollTo(i*o-a/2,this.tableContent.scrollTop)},sbMouseDown(t){if(t.stopPropagation(),!this.hScroller.mouseX){const e=this.$refs.hScroll.getBoundingClientRect().left,o=this.footer.getBoundingClientRect().left+40;this.hScroller.left=e-o,this.hScroller.mouseX=t.clientX,window.addEventListener("mousemove",this.sbMouseMove),window.addEventListener("mouseup",this.sbMouseUp),this.$refs.hScroll.classList.add("focus")}},sbMouseUp(){window.removeEventListener("mousemove",this.sbMouseMove),window.removeEventListener("mouseup",this.sbMouseUp),this.lazy(()=>{this.$refs.hScroll&&this.$refs.hScroll.classList.remove("focus")}),this.hScroller.mouseX=0,this.$forceUpdate()},sbMouseMove(t){if(0===t.buttons)this.sbMouseUp();else{const e=t.clientX-this.hScroller.mouseX,o=(this.hScroller.left+e)/this.hScroller.scrollerUnseenWidth;this.tableContent.scrollTo(this.hScroller.tableUnseenWidth*o,this.tableContent.scrollTop)}},tableScroll(){if(this.showDatePicker=!1,this.autocompleteInputs=[],this.focused&&this.currentField&&(this.inputSquare.style.marginLeft=(this.currentField.sticky?this.tableContent.scrollLeft-this.squareSavedLeft:0)+"px"),this.tableContent.scrollTop!==this.vScroller.lastTop&&(this.calVScroll(),this.$refs.vScrollButton&&(this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3))),this.vScroller.lastTop=this.tableContent.scrollTop,this.tableContent.scrollLeft!==this.hScroller.lastLeft&&this.$refs.hScroll&&this.hScroller.tableUnseenWidth){this.$refs.hScroll.classList.add("focus"),this.lazy(()=>this.$refs.hScroll.classList.remove("focus"),1e3);const e=this.tableContent.scrollLeft/this.hScroller.tableUnseenWidth;this.$refs.hScroll.style.left=this.hScroller.scrollerUnseenWidth*e+"px"}this.hScroller.lastLeft=this.tableContent.scrollLeft},winScroll(){this.showDatePicker=!1,this.autocompleteInputs=[]},mousewheel(t){if(this.noMouseScroll||!this.mousein||!t.deltaY)return;let e=0;return 30<t.deltaY&&this.pageTop+this.pageSize<this.table.length?e=1:-30>t.deltaY&&0<this.pageTop&&(e=-1),e&&(this.pageTop+=e,setTimeout(this.calVScroll),this.$refs.vScrollButton&&(this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3))),t.preventDefault(),t.stopPropagation(),!1},winResize(){this.lazy(this.refreshPageSize,200)},winPaste(t){if("TEXTAREA"===t.target.tagName&&(this.mousein||this.focused)&&this.currentField&&!this.currentField.readonly){if(this.inputBoxShow)return void(this.inputBoxChanged=!0);const e=(t.originalEvent||t).clipboardData.getData("text/plain");this.inputCellWrite(e),t.preventDefault()}},winKeyup(t){t.altKey||this.systable.classList.remove("alt")},winKeydown(t){if(t.altKey&&this.systable.classList.add("alt"),this.mousein||this.focused)if(t.ctrlKey||t.metaKey)switch(t.keyCode){case 90:this.undoTransaction(),t.preventDefault();break;case 65:this.toggleSelectAllRecords(),t.preventDefault();break;case 67:this.inputBox.value=this.currentCell.textContent,this.inputBox.focus(),this.inputBox.select(),document.execCommand("copy"),t.preventDefault();break;case 70:this.noFinding||(this.$refs.panelFind.showPanel(),t.preventDefault());break;case 71:this.noFindingNext||""===this.inputFind||(this.doFindNext(),t.preventDefault());break;case 76:t.preventDefault(),this.calAutocompleteList(!0);}else{if(0>this.currentRowPos)return;switch(t.keyCode){case 37:if(!this.focused)return;this.inputBoxShow?0===this.inputBox.selectionStart&&(this.moveWest(t),t.preventDefault()):(this.moveWest(t),t.preventDefault());break;case 38:if(!this.focused)return;if(t.preventDefault(),0===this.autocompleteInputs.length)this.moveNorth();else if(0<this.autocompleteSelect){this.autocompleteSelect--;const e=23*this.autocompleteSelect;e<this.$refs.autocomplete.scrollTop&&(this.$refs.autocomplete.scrollTop=e)}else-1===this.autocompleteSelect&&(this.autocompleteSelect=0);break;case 9:if(!this.focused)return;if(t.shiftKey){if(!this.moveWest(t))if(this.moveNorth(t))this.moveToEast(t);else return this.inputBoxBlur();}else if(!this.moveEast(t))if(this.moveSouth(t))this.moveToWest(t);else return this.inputBoxBlur();t.preventDefault();break;case 39:if(!this.focused)return;this.inputBoxShow?this.inputBox.selectionEnd===this.inputBox.value.length&&(this.moveEast(t),t.preventDefault()):(this.moveEast(t),t.preventDefault());break;case 40:if(!this.focused)return;if(t.preventDefault(),0===this.autocompleteInputs.length)this.moveSouth(t);else if(this.autocompleteSelect<this.autocompleteInputs.length-1&&(this.autocompleteSelect++,10<=this.autocompleteSelect)){const e=23*this.autocompleteSelect-206,t=this.$refs.autocomplete.scrollTop;t<e&&(this.$refs.autocomplete.scrollTop=e)}break;case 13:if(!this.focused)return;t.preventDefault(),0===this.autocompleteInputs.length||-1===this.autocompleteSelect?this.enterToSouth?this.moveSouth(t):this.moveEast(t):-1!==this.autocompleteSelect&&this.autocompleteSelect<this.autocompleteInputs.length?this.inputAutocompleteText(this.autocompleteInputs[this.autocompleteSelect]):(this.inputBox.value=this.currentCell.textContent,this.inputBoxShow=0,this.inputBoxChanged=!1),this.inputBoxComplete();break;case 27:if(!this.focused)return;this.showDatePicker=!1,this.autocompleteInputs=[],this.autocompleteSelect=-1,this.inputBoxShow&&(t.preventDefault(),this.inputBox.value=this.currentCell.textContent,this.inputBoxShow=0,this.inputBoxChanged=!1);break;case 33:this.prevPage(),t.preventDefault();break;case 34:this.nextPage(),t.preventDefault();break;case 8:case 46:if(!this.focused)return;if(this.inputBoxShow)return this.inputBoxChanged=!0,void setTimeout(()=>this.calAutocompleteList(!0));if(this.currentField.readonly)return;if(this.autocompleteInputs.length)return;this.inputBoxChanged=!0,this.inputBox.value="",this.inputBoxComplete();break;default:if(!this.focused)return;if(this.currentField.readonly)return;if(t.altKey)return;if("Process"!==t.key&&1<t.key.length)return;if(!this.inputBoxShow&&"date"===this.currentField.type)return void this.showDatePickerDiv();if(this.currentField.allowKeys)if("Function"===this.currentField.allowKeys.constructor.name){if(!this.currentField.allowKeys(t.key.toUpperCase()))return t.preventDefault();}else if(-1===this.currentField.allowKeys.indexOf(t.key.toUpperCase()))return t.preventDefault();if(this.currentField.lengthLimit&&this.inputBox.value.length>this.currentField.lengthLimit)return t.preventDefault();if(!this.inputBoxShow){if("select"===this.currentField.type||"map"===this.currentField.type)return(setTimeout(()=>this.calAutocompleteList(!0)),32===t.keyCode)?t.preventDefault():(this.inputBox.value="",this.inputBoxShow=1,void this.inputBox.focus());this.inputBox.value="",this.inputBoxShow=1,this.inputBox.focus(),setTimeout(this.calAutocompleteList)}else setTimeout(()=>this.calAutocompleteList(this.autocompleteInputs.length));this.inputBoxChanged=!0;}}},colSepMouseDown(t){if(t.preventDefault(),t.stopPropagation(),this.allowAddCol&&!t.target.classList.contains("col-sep")){t.target.style.display="none";const e=t.target.parentElement.parentElement,o=Array.from(e.parentElement.children).findIndex(t=>t===e);this.insertColumn(o)}this.focused=!1;const e=(e,t)=>{window.getComputedStyle(e,null).getPropertyValue(t)};this.sep={},this.sep.curCol=this.colgroupTr.children[Array.from(this.labelTr.children).indexOf(t.target.parentElement)],this.sep.pageX=t.pageX;let o=0;if("border-box"!==e(this.sep.curCol,"box-sizing")){const t=e(this.sep.curCol,"padding-left"),i=e(this.sep.curCol,"padding-right");t&&i&&(o=parseInt(t)+parseInt(i))}this.sep.curColWidth=t.target.parentElement.offsetWidth-o,window.addEventListener("mousemove",this.colSepMouseMove),window.addEventListener("mouseup",this.colSepMouseUp)},colSepMouseOver(t){t.target.classList.contains("col-sep")?(t.target.style.borderRight="5px solid #cccccc",t.target.style.height=this.systable.getBoundingClientRect().height+"px",this.allowAddCol&&(t.target.children[0].style.display="block")):(this.addColBtnTimeout&&clearTimeout(this.addColBtnTimeout),this.allowAddCol&&(t.target.style.display="block"))},colSepMouseOut(t){t.target.classList.contains("col-sep")?(t.target.style.borderRight="5px solid transparent",t.target.style.height="100%",this.addColBtnTimeout=setTimeout(()=>{t.target.children[0].style.display="none"},500)):t.target.style.display="none"},colSepMouseMove(t){if(this.sep&&this.sep.curCol){const e=t.pageX-this.sep.pageX;this.sep.curCol.style.width=this.sep.curColWidth+e+"px",this.lazy(this.calStickyLeft,200)}},colSepMouseUp(t){t.preventDefault(),t.stopPropagation(),delete this.sep,window.removeEventListener("mousemove",this.colSepMouseMove),window.removeEventListener("mouseup",this.colSepMouseUp);const e=this.getSetting();this.remember&&(localStorage[window.location.pathname+"."+this.token]=JSON.stringify(e)),this.$emit("setting",e)},doFindNext(){return this.doFind()},doFind(e){"undefined"==typeof e?e=this.inputFind:this.inputFind=e,e=e.toUpperCase();const t=r(0,this.currentRowPos);for(let o=t+this.pageTop;o<this.table.length;o++){const i=this.table[o];for(let a=o===t+this.pageTop?this.currentColPos+1:0;a<this.fields.length;a++){const t=this.fields[a].name;if("undefined"!=typeof i[t]&&0<=(i[t]+"").toUpperCase().indexOf(e))return this.pageTop=this.findPageTop(o),setTimeout(()=>{this.moveInputSquare(o-this.pageTop,a),setTimeout(()=>this.inputBox.focus()),this.focused=!0}),!0}}for(let o=0;o<=t+this.pageTop;o++){const i=this.table[o];for(let a=0;a<(o===t+this.pageTop?this.currentColPos:this.fields.length);a++){const t=this.fields[a].name;if("undefined"!=typeof i[t]&&0<=(i[t]+"").toUpperCase().indexOf(e))return this.pageTop=this.findPageTop(o),this.moveInputSquare(o-this.pageTop,a),setTimeout(()=>{this.focused=!0}),!0}}return!1},findPageTop(e){for(let t=this.pageTop;t<this.table.length;t+=this.pageSize)if(e>=t&&e<t+this.pageSize)return t;for(let t=this.pageTop;0<t;t-=this.pageSize)if(e>=t&&e<t+this.pageSize)return t;return this.pageTop},headerClick(t,e){return this.noHeaderEdit||"SPAN"!==t.target.tagName?void(1===t.which&&(t.preventDefault(),this.sortPos===e&&0<this.sortDir?this.sort(-1,e):this.sort(1,e))):(t.target.contentEditable=!0,void t.target.addEventListener("focusout",this.completeHeaderChange))},completeHeaderChange(t){const e=t.target.parentElement.parentElement,o=Array.from(e.parentElement.children).findIndex(t=>t===e);this.fields[o-1].label=t.target.textContent},sort(e,t){this.processing=!0;const o="undefined"==typeof t?this.columnFilterRef.colPos:t,i=this.fields[o],l=i.name;setTimeout(()=>{let t=i.sort;null===t&&("number"===i.type?t=(e,t)=>+e[l]>+t[l]?1:+e[l]<+t[l]?-1:0:t=(e,t)=>(e[l]+"").localeCompare(t[l]+"")),this.value.sort((o,i)=>t(o,i)*e),this.sortPos=o,this.sortDir=e,this.$forceUpdate(),this.processing=!1},0)},refreshPageSize(){if(this.$refs.hScroll){const e=this.systable.getBoundingClientRect().width,t=this.tableContent.getBoundingClientRect().width;this.hScroller.tableUnseenWidth=e-t,this.$refs.hScroll.style.width=100*t/e+"%";const o=this.$refs.hScroll.getBoundingClientRect().width;this.hScroller.scrollerUnseenWidth=this.footer.getBoundingClientRect().width-40-o}if(!this.noPaging){const e=this.summaryRow?60:35;let t=window.innerHeight-this.recordBody.getBoundingClientRect().top-e;const o=1*this.height.replace(/px/,"")+this.systable.getBoundingClientRect().top-this.recordBody.getBoundingClientRect().top;this.height&&t>o&&(t=o),this.pageSize=this.page||d(t/24)}else if("auto"===this.height){let e=d(window.innerHeight-this.tableContent.getBoundingClientRect().top-25),t=4;this.filterRow&&(t+=29),this.summaryRow&&(t+=25),this.footerRow||(t+=25),e=a(24*(this.table.length-this.pageTop)+t,e),this.systable.parentNode.style.height=e+"px"}setTimeout(this.calVScroll)},firstPage(t){t&&t.stopPropagation(),this.pageTop=0,this.calVScroll(),this.$refs.vScrollButton&&setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")},1e3)})},lastPage(t){t&&t.stopPropagation(),this.pageTop=0>this.table.length-this.pageSize?0:this.table.length-this.pageSize,this.calVScroll(),this.$refs.vScrollButton&&setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")},1e3)})},prevPage(t){t&&t.stopPropagation(),this.pageTop=this.pageTop<this.pageSize?0:this.pageTop-this.pageSize,this.calVScroll(),this.$refs.vScrollButton&&setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")},1e3)})},nextPage(t){t&&t.stopPropagation(),this.pageTop+this.pageSize<this.table.length&&(this.pageTop=a(this.pageTop+this.pageSize,this.table.length-this.pageSize)),this.calVScroll(),this.$refs.vScrollButton&&setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")},1e3)})},getSetting(){const e=Array.from(this.colgroupTr.children).map(e=>e.style.width),t=this.fields.map((t,o)=>({name:t.name,invisible:t.invisible,width:e[o+1],label:t.label}));return{colHash:this.colHash,fields:t}},settingClick(){this.disablePanelSetting||this.$refs.panelSetting.showPanel()},panelFilterClick(e){this.disablePanelFilter||this.$refs.panelFilter.showPanel(this.$refs[`filter-${e.name}`][0])},importTable(e,t){this.$refs.importFile.click(),this.importCallback=e,this.importErrorCallback=t},doImport(t){this.processing=!0,this.clearAllSelected(),setTimeout(()=>{const e=t.target.files;if(!e||0===e.length)return;const i=e[0],a=new FileReader;a.onload=async t=>{try{const e=t.target.result,i=o.read(e,{type:"binary",cellDates:!0,cellStyle:!1}),a=i.SheetNames[0];let l=o.utils.sheet_to_row_object_array(i.Sheets[a]);l=l.filter(e=>0<Object.keys(e).length).map(e=>(e.key_1&&(e.key=e.key_1,delete e.key_1),Object.keys(e).forEach(t=>{"string"==typeof e[t]&&(e[t]=e[t].replace(/[ \r\n\t]+$/g,""))}),e));const n=new Date().getTime()%1e8+"";if(0===l.length)throw this.importErrorCallback&&this.importErrorCallback("noRecordIsRead"),new Error("VueExcelEditor: "+this.localizedLabel.noRecordIsRead);if(0<this.fields.filter(e=>e.keyField).filter(e=>"undefined"==typeof l[0][e.name]&&"undefined"==typeof l[0][e.label]).length)throw this.importErrorCallback&&this.importErrorCallback("missingKeyColumn"),new Error(`VueExcelEditor: ${this.localizedLabel.missingKeyColumn}`);let s=0,r=0,d=0;for(;2>s;){const e=this.fields.filter(e=>e.keyField);let t=[];await Promise.all(l.map(async(o,a)=>{let i=-1;if(e.length&&(i=this.table.findIndex(t=>e.filter(e=>"undefined"!=typeof t[e.name]&&(t[e.name]===o[e.name]||t[e.name]===o[e.label])).length===e.length),-1===i)){const i=e.map(e=>o[e.name]||o[e.label]).join(":");if(i){if(t.includes(i))return;t.push(i)}}-1===i&&(i=this.table.findIndex(e=>0===Object.keys(e).filter(e=>!e.startsWith("$")).length));const l={$id:"undefined"==typeof o.$id?n+"-"+("000000"+a).slice(-7):o.$id};await Promise.all(this.fields.map(async e=>{if(e.name.startsWith("$"))return;let t=o[e.name];if("undefined"==typeof t&&(t=o[e.label]),"undefined"==typeof t)t=null;else{if(e.readonly)throw this.importErrorCallback&&this.importErrorCallback("readonlyColumnDetected",a+1),new Error(`VueExcelEditor: [row=${a+1}] `+this.localizedLabel.readonlyColumnDetected+": "+e.name);if(e.change){let o=await e.change(t,l[e.name],l,e);if(!1===o)throw this.importErrorCallback&&this.importErrorCallback("columnHasValidationError",a+1),new Error(`VueExcelEditor: [row=${a+1}, val=${t}] `+this.localizedLabel.columnHasValidationError(e.name,""))}if(e.validate){let o;if(o=e.validate(t,l[e.name],l,e))throw this.importErrorCallback&&this.importErrorCallback("columnHasValidationError",a+1,t),new Error(`VueExcelEditor: [row=${a+1}, val=${t}] `+this.localizedLabel.columnHasValidationError(e.name,o))}if(this.validate){let o;if(o=this.validate(t,l[e.name],l,e))throw this.importErrorCallback&&this.importErrorCallback("rowHasValidationError",a+1,t),new Error(`VueExcelEditor: [row=${a+1}, val=${t}] `+this.localizedLabel.rowHasValidationError(a+1,e.name,o))}}if(null!==t)l[e.name]=t;else if(e.mandatory)throw this.importErrorCallback&&this.importErrorCallback(e.mandatory,a+1,t),new Error(`VueExcelEdutor: [row=${a+1}, val=${t}] `+e.mandatory)})),1===s&&(0<=i?(d++,Object.keys(l).forEach(e=>{e.startsWith("$")||this.updateCell(i,e,l[e])}),this.selected[i]=this.table[i].$id):(this.newRecord(l,!0),r++))})),s++}2==s&&this.importCallback&&this.importCallback({inserted:r,updated:d,recordAffected:r+d})}catch(t){throw this.importErrorCallback&&this.importErrorCallback(t.message),new Error("VueExcelEditor: "+t.stack)}finally{this.processing=!1,this.$refs.importFile.value=""}},a.onerror=t=>{throw this.processing=!1,this.$refs.importFile.value="",this.importErrorCallback&&this.importErrorCallback(t.message),new Error("VueExcelEditor: "+t.stack)},a.readAsBinaryString(i)},500)},exportTable(e,t,i){this.processing=!0,setTimeout(()=>{const a=o.utils.book_new();let l=null,n=this.table;t&&(n=this.table.filter((e,t)=>this.selected[t]));const s=n.map(e=>{const t={};return this.fields.forEach(o=>t[o.name]=e[o.name]),t});l=o.utils.json_to_sheet(s,{header:this.fields.map(e=>e.name)});const r=Array.from(this.labelTr.children).slice(1).map(e=>e.children[0].innerText);switch(o.utils.sheet_add_aoa(l,[r],{origin:0}),l["!cols"]=Array.from(this.labelTr.children).slice(1).map(e=>({width:e.getBoundingClientRect().width/6.5})),o.utils.book_append_sheet(a,l,"Sheet1"),i=i||"export",e){case"csv":i.endsWith(".csv")||(i+=".csv");break;case"xls":i.endsWith(".xls")||(i+=".xls");break;case"xlsx":case"excel":default:i.endsWith(".xlsx")||(i+=".xlsx");}i.endsWith(".xlsx")?o.writeFile(a,i,{compression:"DEFLATE",compressionOptions:{level:6}}):o.writeFile(a,i),this.processing=!1},500)},getSelectedRecords(){return this.table.filter((e,t)=>this.selected[t])},rowLabelClick(t){let e=t.target;for(;"TD"!==e.tagName;)e=e.parentNode;const o=+e.getAttribute("pos")+this.pageTop;if(!t.shiftKey){const e=this.selected[o];this.freeSelect||t.ctrlKey||t.metaKey||this.clearAllSelected(),e?this.unSelectRecord(o):this.selectRecord(o)}else if(document.getSelection().removeAllRanges(),-1!==this.prevSelect&&this.prevSelect!==o)if(t.preventDefault(),o>this.prevSelect)for(let e=this.prevSelect;e<=o;e++)this.selectRecord(e);else for(let e=o;e<=this.prevSelect;e++)this.selectRecord(e);this.prevSelect=o},selectAllClick(){this.toggleSelectAllRecords()},reviseSelectedAfterTableChange(){this.rowIndex={},this.table.forEach((e,t)=>this.rowIndex[e.$id]=t);const e=Object.assign(this.selected);this.selected={},Object.keys(e).forEach(t=>{const o=e[t];"undefined"!=typeof this.rowIndex[o]&&(this.selected[this.rowIndex[o]]=o)}),this.selectedCount=Object.keys(this.selected).length},toggleSelectRecord(e){"undefined"==typeof this.selected[e]?this.selectRecord(e):this.unSelectRecord(e)},selectRecord(e){"undefined"==typeof this.selected[e]&&(this.selectedCount++,this.selected[e]=this.table[e].$id,this.recordBody.children[e-this.pageTop]&&this.recordBody.children[e-this.pageTop].classList.add("select"),this.lazy(e,e=>{this.$emit("select",e,!0)}))},selectRecordByKeys(e){const t=this.table.findIndex(t=>this.fields.filter(e=>e.keyField).filter(o=>t[o.name]===e[o.name]).length===e.length);0<=t&&this.selectRecord(t)},selectRecordById(e){const t=this.table.findIndex(t=>t.$id===e);0<=t&&this.selectRecord(t)},unSelectRecord(e){"undefined"!=typeof this.selected[e]&&(delete this.selected[e],this.selectedCount--,this.recordBody.children[e-this.pageTop]&&this.recordBody.children[e-this.pageTop].classList.remove("select"),this.lazy(e,e=>{this.$emit("select",e,!1)}))},toggleSelectAllRecords(t){if(t&&t.preventDefault(),0<this.selectedCount)this.clearAllSelected();else{for(let e=0;e<this.table.length;e++)this.selectRecord(e);this.selectedCount=this.table.length}},clearAllSelected(){0<this.selectedCount&&this.$emit("select",Object.keys(this.selected).map(e=>+e),!1),this.selected={},this.selectedCount=0},moveTo(e,t){t=t||0;const o=this.moveInputSquare(e-this.pageTop,t);return this.focused=!0,setTimeout(()=>this.inputBox.focus()),o},moveToNorthWest(){let e=0;for(;this.fields[e].invisible&&e<this.fields.length-1;)e++;return this.moveTo(0,e)},moveToNorthEast(){let e=this.fields.length-1;for(;this.fields[e].invisible&&0<e;)e--;return this.moveTo(0,e)},moveToSouthWest(){let e=this.table.length-1,t=0;for(;this.fields[t].invisible&&t<this.fields.length-1;)t++;return this.moveTo(e,t)},moveToSouthEast(){let e=this.table.length-1,t=this.fields.length-1;for(;this.fields[t].invisible&&0<t;)t--;return this.moveTo(e,t)},moveToWest(){let e=this.currentRowPos,t=0;for(;this.fields[t].invisible&&t<this.fields.length-1;)t++;return this.moveTo(e,t)},moveToEast(){let e=this.currentRowPos,t=this.fields.length-1;for(;this.fields[t].invisible&&0<t;)t--;return this.moveTo(e,t)},moveWest(){if(this.focused&&0<this.currentColPos){let e=this.currentColPos-1;for(;this.fields[e].invisible&&0<e;)e--;return!(-1==e||this.fields[e].invisible)&&this.moveInputSquare(this.currentRowPos,e)}return!1},moveEast(){if(this.focused&&this.currentColPos<this.fields.length-1){let e=this.currentColPos+1;for(;this.fields[e].invisible&&e<this.fields.length-1;)e++;return!(e===this.fields.length||this.fields[e].invisible)&&this.moveInputSquare(this.currentRowPos,e)}return!1},moveNorth(){if(this.focused){const e=this.moveInputSquare(this.currentRowPos-1,this.currentColPos);return this.calVScroll(),this.$refs.vScrollButton&&setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")},1e3)}),e}return!1},moveSouth(){if(this.focused){if(this.currentRowPos+1>=this.table.length)return!this.readonly&&!!this.newIfBottom&&(this.newRecord({},!1,!0),setTimeout(this.moveSouth,0),!0);const e=this.moveInputSquare(this.currentRowPos+1,this.currentColPos);return this.calVScroll(),this.$refs.vScrollButton&&setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>{this.$refs.vScrollButton&&this.$refs.vScrollButton.classList.remove("focus")},1e3)}),e}return!1},mouseDown(t){if("TBODY"===t.target.parentNode.parentNode.tagName&&!t.target.classList.contains("first-col")){t.preventDefault(),setTimeout(()=>this.inputBox.focus()),this.focused=!0;const e=t.target.parentNode,o=Array.from(e.children).indexOf(t.target)-1,i=Array.from(e.parentNode.children).indexOf(e);if(this.$emit("cell-click",{rowPos:i,colPos:o}),this.moveInputSquare(i,o),this.currentField&&this.currentField.link&&t.altKey&&setTimeout(()=>this.currentField.link(this.currentCell.textContent,this.currentRecord,i,o,this.currentField,this)),15<t.target.offsetWidth-t.offsetX)return;if(this.currentField.readonly)return;this.inputBox.value=this.currentCell.textContent,t.target.classList.contains("select")&&this.calAutocompleteList(!0),t.target.classList.contains("datepick")&&this.showDatePickerDiv()}},cellMouseMove(t){let e="cell";this.inputBoxShow&&(e="default"),!t.target.classList.contains("readonly")&&(t.target.classList.contains("select")||t.target.classList.contains("datepick"))&&15>t.target.offsetWidth-t.offsetX&&(e="pointer"),t.target.style.cursor=e},cellMouseOver(t){const e=t.target;if(e.classList.contains("error")&&(this.tipTimeout&&clearTimeout(this.tipTimeout),""!==(this.tip=this.errmsg[e.getAttribute("id")]))){const t=e.getBoundingClientRect();this.$refs.tooltip.style.top=t.top-14+"px",this.$refs.tooltip.style.left=t.right+8+"px",e.addEventListener("mouseout",this.cellMouseOut)}},numcolMouseOver(t){const e=t.target;if(e.classList.contains("error")&&(this.tipTimeout&&clearTimeout(this.tipTimeout),""!==(this.tip=this.rowerr[e.getAttribute("id")]))){const t=e.getBoundingClientRect();this.$refs.tooltip.style.top=t.top-14+"px",this.$refs.tooltip.style.left=t.right+8+"px",e.addEventListener("mouseout",this.cellMouseOut)}},cellMouseOut(t){this.tipTimeout=setTimeout(()=>{this.tip=""},1e3),t.target.removeEventListener(t.type,this.cellMouseOut)},mouseOver(){this.mousein=!0,this.systable.classList.add("mouseover")},mouseOut(){this.mousein=!1,this.systable.classList.remove("mouseover")},moveInputSquare(e,t){if(0>t)return!1;const o=this.pageTop;let i=this.recordBody.children[e];if(!i)if(e>this.currentRowPos){if(this.pageTop+this.pageSize<this.table.length)this.pageTop+=1;else return!1;i=this.recordBody.children[--e]}else{if(0<=this.pageTop-1)this.pageTop-=1;else return!1;i=this.recordBody.children[++e]}this.labelTr.children[this.currentColPos+1].classList.remove("focus"),0<=this.currentRowPos&&this.currentRowPos<this.pagingTable.length&&this.recordBody.children[this.currentRowPos].children[0].classList.remove("focus"),this.inputBoxShow&&(this.inputBoxShow=0),this.inputBoxChanged&&(this.inputCellWrite(this.inputBox.value,this.currentColPos,o+this.currentRowPos),this.inputBoxChanged=!1);const a=i.children[t+1];if(!a)return!1;this.currentField=this.fields[t];const l=a.getBoundingClientRect(),n=this.systable.getBoundingClientRect();if(this.squareSavedLeft=this.tableContent.scrollLeft,this.inputSquare.style.marginLeft=0,this.inputSquare.style.left=l.left-n.left-1+"px",this.inputSquare.style.top=l.top-n.top-1+"px",this.inputSquare.style.width=l.width+1+"px",this.inputSquare.style.height=l.height+1+"px",this.inputSquare.style.zIndex=this.currentField.sticky?3:1,!this.currentField.sticky){const e=this.$el.getBoundingClientRect();l.right>=e.right-12&&this.tableContent.scrollBy(l.right-e.right+13,0),l.left<=e.left+this.leftMost&&this.tableContent.scrollBy(l.left-e.left-this.leftMost-1,0)}return this.currentRowPos=e,this.currentColPos=t,this.currentCell=a,this.currentRecord=this.table[o+e],this.$emit("cell-focus",{rowPos:e,colPos:t,cell:a,record:this.currentRecord}),this.showDatePicker&&(this.showDatePicker=!1),this.autocompleteInputs.length&&(this.autocompleteInputs=[],this.autocompleteSelect=-1),this.recalAutoCompleteList&&clearTimeout(this.recalAutoCompleteList),0<=this.currentRowPos&&this.currentRowPos<this.pagingTable.length&&(this.inputBox.value=this.currentCell.textContent,this.inputBox.focus(),this.focused=!0,i.children[0].classList.add("focus"),this.labelTr.children[t+1].classList.add("focus")),!0},inputSquareClick(){this.currentField.readonly||this.inputBoxShow||"select"===this.currentField.type||(this.inputBox.value=this.currentCell.textContent,this.inputBoxShow=1,this.inputBox.focus(),this.inputBoxChanged=!1,this.focused=!0)},inputBoxMouseMove(t){let e="text";!this.currentField.readonly&&(this.currentField.options||"date"===this.currentField.type)&&15>t.target.offsetWidth-t.offsetX&&(e="pointer"),t.target.style.cursor=e},inputBoxMouseDown(t){15<t.target.offsetWidth-t.offsetX||this.currentField.readonly||(this.currentField.options&&(t.preventDefault(),this.calAutocompleteList(!0)),"date"===this.currentField.type&&(t.preventDefault(),this.showDatePickerDiv()))},inputCellWrite(e,t,o){let i=this.currentField;"undefined"!=typeof t&&(i=this.fields[t]),"undefined"==typeof o&&(o=this.pageTop+this.currentRowPos),"undefined"==typeof this.selected[o]?this.updateCell(o,i,i.toValue(e)):this.updateSelectedRows(i,i.toValue(e))},inputBoxBlur(){!this.$refs.dpContainer||this.$refs.dpContainer.querySelector(":hover")||(this.inputBoxComplete(),this.focused=!1,-1!==this.currentRowPos&&this.currentRowPos<this.recordBody.children.length&&(this.recordBody.children[this.currentRowPos].children[0].classList.remove("focus"),this.labelTr.children[this.currentColPos+1].classList.remove("focus")))},inputBoxComplete(){this.inputBoxChanged&&(this.inputCellWrite(this.inputBox.value),this.inputBoxChanged=!1),this.inputBoxShow=0,this.showDatePicker=!1,this.focused=!1,this.focused=!0},undoTransaction(t){if(t&&t.preventDefault(),0!==this.redo.length){const e=this.redo.pop();e.every(e=>{try{if("d"===e.type)this.newRecord(e.rec,!1,!0,!0);else if(e.field&&e.field.keyField&&e.oldKeys.includes(e.newVal)){const t=this.value.findIndex(t=>t.$id===e.$id);0<=t&&this.deleteRecord(t,!0)}else this.updateCell(e.$id,e.field.name,e.oldVal,!0);return!0}catch(t){return!1}})}},newRecord(e,t,o,i){"undefined"==typeof e&&(e={}),this.fields.map(t=>{"undefined"==typeof e[t.name]&&(t.keyField?e[t.name]="\xA7"+this.tempKey():e[t.name]=null)});const a=e.$id||this.tempKey();e.$id=a,this.value.push(e);const l=this.table.push(e)-1;return t&&(this.selected[l]=a),Object.keys(e).forEach(t=>{const o=this.fields.find(e=>e.name===t);o&&this.updateCell(e,o,e[t],i)}),o||this.lazy(()=>{this.lastPage(),this.moveToSouthWest()}),e},deleteSelectedRecords(){Object.values(this.selected).forEach(e=>{const t=this.value.findIndex(t=>t.$id===e);0<=t&&this.deleteRecord(t)}),this.selected={},this.selectedCount=0},deleteRecord(e,t){this.currentRowPos===e&&this.moveNorth();const o=this.value.splice(e,1)[0];setTimeout(()=>{this.lazy(o,e=>{this.$emit("delete",e),t||this.redo.push(e.map(e=>({type:"d",rec:e})))})},100)},async updateCell(e,t,o,i){switch(e.constructor.name){case"String":e=this.value.find(t=>t.$id===e);break;case"Number":e=this.table[e];break;case"Object":break;default:throw new Error("Invalid row argument type");}switch(t.constructor.name){case"String":t=this.fields.find(e=>e.name===t);break;case"Number":t=this.fields[t];break;case"Object":break;default:throw new Error("Invalid field argument type");}if(!t)throw new Error("Invalid field argument");if(!e)return;const a=e[t.name],l=this.getKeys(e);if(t.change){let i=await t.change(o,a,e,t);if(!1===i)return}e[t.name]=o,setTimeout(()=>{const n={$id:e.$id,keys:this.getKeys(e),oldKeys:l,name:t.name,field:t,oldVal:"undefined"==typeof a?"":a,newVal:o,err:""},s=`id-${e.$id}-${t.name}`;if(null!==t.validate&&(n.err=t.validate(o,a,e,t)),t.mandatory&&""===o&&(n.err+=(n.err?"\n":"")+t.mandatory),n.err){this.errmsg[s]=n.err;const e=this.systable.querySelector("td#"+s);e&&e.classList.add("error")}else if(this.errmsg[s]){delete this.errmsg[s];const e=this.systable.querySelector("td#"+s);e&&e.classList.remove("error")}if(null!==this.validate){const i=`rid-${e.$id}`;if(n.rowerr=this.validate(o,a,e,t),n.rowerr){this.rowerr[i]=n.rowerr;const e=this.systable.querySelector("td#"+i);e&&e.classList.add("error")}else if(this.rowerr[i]){delete this.rowerr[i];const e=this.systable.querySelector("td#"+i);e&&e.classList.remove("error")}}t.summary&&this.calSummary(t.name),this.lazy(n,e=>{this.$emit("update",e),i||this.redo.push(e)},50)})},updateSelectedRows(e,t){this.processing=!0,setTimeout(()=>{Object.keys(this.selected).forEach(o=>this.updateCell(parseInt(o),e,t)),this.processing=!1},0)},async calAutocompleteList(e){if((e||this.currentField.autocomplete)&&(e||this.inputBoxChanged&&0<this.inputBox.value.length)){"undefined"!=typeof this.recalAutoCompleteList&&clearTimeout(this.recalAutoCompleteList);const t=async()=>{if(!e&&(!this.focused||!this.inputBoxShow||!this.inputBoxChanged||!this.inputBox.value.length))return void(this.autocompleteInputs=[]);const t=this.currentField,o=t.name,a=this.inputBox.value.toUpperCase(),l=this.autocompleteCount;let n=[];if(t.options)t.options.constructor.name.endsWith("Function")?(n=await t.options(a,this.currentRecord),n="map"===t.type?Object.values(n):n.slice(),this.inputBoxShow&&(n=n.filter(e=>e.toUpperCase().includes(a))),n.sort().splice(l)):0<Object.values(t.options).length&&(n=t.options,n="map"===t.type?Object.values(n):n.slice(),this.inputBoxShow&&(n=n.filter(e=>e.toUpperCase().includes(a))),n.sort().splice(l));else{for(let e=0;e<this.value.length;e++){const t=this.value[e];if("undefined"!=typeof t[o]&&t[o].toString().toUpperCase().startsWith(a)&&-1===n.indexOf(t[o])&&n.push(t[o]),n.length>=l)break}n.sort()}this.autocompleteSelect=n.findIndex(e=>e.toUpperCase().includes(a)),this.autocompleteInputs=n;const s=this.currentCell.getBoundingClientRect();return this.lazy(()=>{if(this.$refs.autocomplete){this.$refs.autocomplete.style.minWidth=s.width+"px";const e=this.$refs.autocomplete.getBoundingClientRect();s.bottom+e.height>window.innerHeight?(this.autocompleteInputs.reverse(),this.autocompleteSelect=this.autocompleteInputs.length-this.autocompleteSelect-1,this.$refs.autocomplete.style.top=s.top-e.height+"px"):this.$refs.autocomplete.style.top=s.bottom+"px",s.left+e.width>window.innerWidth?this.$refs.autocomplete.style.top=window.innerWidth-e.width+"px":this.$refs.autocomplete.style.left=s.left+"px";const t=23*this.autocompleteSelect-206;this.$refs.autocomplete.scrollTop=0<t?t:0}}),this.autocompleteSelect};e?t():this.lazy(t,700)}},inputAutocompleteText(t,o){o&&o.preventDefault(),this.autocompleteInputs=[],this.autocompleteSelect=-1,this.inputBoxShow=0,this.inputBoxChanged=!1,setTimeout(()=>{this.inputCellWrite(t)})},tempKey(){return new Date().getTime()%1e8+"-"+Math.random().toString().slice(2,7)},hashCode(e){return e.split("").reduce((e,t)=>e=0|(e<<5)-e+t.charCodeAt(0),0)},lazy(e,t,o){if("function"!=typeof e)return this.lazyBuf(e,t,o);t||(t=20);const i=this.hashCode(e.name+e.toString());this.lazyTimeout[i]&&clearTimeout(this.lazyTimeout[i]),this.lazyTimeout[i]=setTimeout(()=>{e(),delete this.lazyTimeout[i]},t)},lazyBuf(e,t,o){o||(o=20);const i=this.hashCode(t.name+t.toString());this.lazyBuffer[i]?this.lazyBuffer[i].push(e):this.lazyBuffer[i]=[e],this.lazyTimeout[i]&&clearTimeout(this.lazyTimeout[i]),this.lazyTimeout[i]=setTimeout(()=>{ro.nextTick(()=>{t(this.lazyBuffer[i]),delete this.lazyTimeout[i],delete this.lazyBuffer[i]})},o)}}};/* script */ /* template */var id=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"vue-excel-editor",style:{display:"inline-block","max-width":e.width}},[o("div",{staticClass:"component-content"},[e.localizedLabel.noRecordIndicator&&0==e.pagingTable.length?o("div",{staticClass:"norecord",style:{bottom:e.noFooter?"12px":"37px"}},[e._v("\n      "+e._s(e.localizedLabel.noRecordIndicator)+"\n    ")]):e._e(),e._v(" "),o("div",{ref:"tableContent",staticClass:"table-content",class:{"no-footer":e.noFooter},on:{scroll:e.tableScroll,mouseover:e.mouseOver,mouseout:e.mouseOut}},[o("table",{ref:"systable",staticClass:"systable",class:{"no-number":e.noNumCol},staticStyle:{"table-layout":"fixed",width:"0"},attrs:{id:"systable",ondragenter:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",ondragover:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'"}},[o("colgroup",[o("col",{staticStyle:{width:"40px"}}),e._v(" "),e._l(e.fields,function(e,t){return o("col",{directives:[{name:"show",rawName:"v-show",value:!e.invisible,expression:"!item.invisible"}],key:t,style:{width:e.width}})}),e._v(" "),e.vScroller.buttonHeight<e.vScroller.height?o("col",{staticStyle:{width:"12px"}}):e._e()],2),e._v(" "),o("thead",{staticClass:"center-text"},[o("tr",[o("th",{staticClass:"center-text first-col tl-setting",class:{hide:e.noNumCol},staticStyle:{top:"0"},on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.selectAllClick.apply(null,arguments)},contextmenu:function(t){return t.preventDefault(),e.settingClick.apply(null,arguments)}}},[o("span",{staticStyle:{width:"100%"}},[0<e.selectedCount?o("svg",{staticClass:"svg-inline--fa fa-times-circle fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"times-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"}})]):o("svg",{staticClass:"svg-inline--fa fa-bars fa-w-14 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"bars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"}})])])]),e._v(" "),e._l(e.fields,function(t,i){return o("th",{directives:[{name:"show",rawName:"v-show",value:!t.invisible,expression:"!item.invisible"}],key:"th-"+i,class:{"sort-asc-sign":e.sortPos==i&&1==e.sortDir,"sort-des-sign":e.sortPos==i&&-1==e.sortDir,"sticky-column":t.sticky},style:{left:t.left},attrs:{colspan:i===e.fields.length-1&&e.vScroller.buttonHeight<e.vScroller.height?2:1},on:{mousedown:function(t){return e.headerClick(t,i)},contextmenu:function(o){return o.preventDefault(),e.panelFilterClick(t)}}},[o("div",{class:{"filter-sign":e.columnFilter[i]}},[o("span",{class:{"table-col-header":!e.noHeaderEdit},domProps:{innerHTML:e._s(e.headerLabel(t.label,t))}})]),e._v(" "),o("div",{staticClass:"col-sep",on:{mousedown:e.colSepMouseDown,mouseover:e.colSepMouseOver,mouseout:e.colSepMouseOut}},[o("div",{staticClass:"add-col-btn"},[e._v("+")])])])})],2),e._v(" "),o("tr",{class:{hide:!e.filterRow}},[o("td",{staticClass:"center-text first-col tl-filter",class:{hide:e.noNumCol},staticStyle:{"vertical-align":"middle",padding:"0"},style:{top:e.calCellTop2+"px"},on:{click:function(){e.columnFilter={}}}},[0<Object.keys(e.columnFilter).length?o("span",[o("svg",{staticClass:"svg-inline--fa fa-eraser fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"eraser",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"}})])]):e._e()]),e._v(" "),e._l(e.fields,function(t,i){return o("vue-excel-filter",{directives:[{name:"show",rawName:"v-show",value:!t.invisible,expression:"!item.invisible"}],key:"th2-"+i,ref:"filter-"+t.name,refInFor:!0,staticClass:"column-filter",class:{"sticky-column":t.sticky},style:{left:t.left},attrs:{colspan:i===e.fields.length-1?2:1},model:{value:e.columnFilter[i],callback:function(t){e.$set(e.columnFilter,i,t)},expression:"columnFilter[p]"}})})],2)]),e._v(" "),o("tbody",{on:{mousedown:e.mouseDown}},[e.localizedLabel.noRecordIndicator&&0==e.pagingTable.length?o("tr",[o("td",{staticStyle:{height:"40px","vertical-align":"middle","text-align":"center"},attrs:{colspan:"100%"}})]):e._l(e.pagingTable,function(t,i){return o("tr",{key:i,class:{select:"undefined"!=typeof e.selected[e.pageTop+i]},style:e.rowStyle(t)},[o("td",{staticClass:"center-text first-col",class:{hide:e.noNumCol,error:e.rowerr["rid-"+t.$id]},attrs:{id:"rid-"+t.$id,pos:i},on:{mouseover:e.numcolMouseOver,click:e.rowLabelClick}},[o("span",{domProps:{innerHTML:e._s(e.recordLabel(e.pageTop+i+1,t))}})]),e._v(" "),e._l(e.fields,function(a,l){return[o("td",{directives:[{name:"show",rawName:"v-show",value:!a.invisible,expression:"!item.invisible"}],key:l,class:{readonly:a.readonly,error:e.errmsg["id-"+t.$id+"-"+a.name],link:a.link,select:a.options,datepick:"date"==a.type,"sticky-column":a.sticky},style:Object.assign(e.cellStyle(t,a),e.renderColumnCellStyle(a)),attrs:{id:"id-"+t.$id+"-"+a.name,"cell-RC":i+"-"+a.name},on:{mouseover:e.cellMouseOver,mousemove:e.cellMouseMove}},[e._v("\n                "+e._s(a.toText(t[a.name]))+"\n              ")])]}),e._v(" "),e.vScroller.buttonHeight<e.vScroller.height?o("td",{staticClass:"last-col"}):e._e()],2)})],2),e._v(" "),o("tfoot",[o("tr",{directives:[{name:"show",rawName:"v-show",value:e.pagingTable.length&&e.summaryRow,expression:"pagingTable.length && summaryRow"}]},[o("td",{staticClass:"row-summary first-col"},[e._v("\xA0")]),e._v(" "),e._l(e.fields,function(t,i){return[o("td",{directives:[{name:"show",rawName:"v-show",value:!t.invisible,expression:"!field.invisible"}],key:"f"+i,staticClass:"row-summary",class:{"sticky-column":t.sticky,"summary-column1":i+1<e.fields.length&&e.fields[i+1].summary,"summary-column2":t.summary},style:e.renderColumnCellStyle(t),attrs:{colspan:i===e.fields.length-1&&e.vScroller.buttonHeight<e.vScroller.height?2:1}},[e._v("\n                "+e._s(e.summary[t.name])+"\n              ")])]})],2)]),e._v(" "),e._t("default")],2),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.tip,expression:"tip"}],ref:"tooltip",staticClass:"tool-tip"},[e._v(e._s(e.tip))]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.focused,expression:"focused"}],ref:"inputSquare",staticClass:"input-square",on:{mousedown:e.inputSquareClick}},[o("div",{staticStyle:{position:"relative",height:"100%",padding:"2px 2px 1px"}},[o("div",{staticClass:"rb-square"}),e._v(" "),o("textarea",{ref:"inputBox",staticClass:"input-box",style:{opacity:e.inputBoxShow},attrs:{id:"inputBox",trim:"",autocomplete:"off",autocorrect:"off",autocompitaize:"off",spellcheck:e.spellcheck},on:{blur:e.inputBoxBlur,mousemove:e.inputBoxMouseMove,mousedown:e.inputBoxMouseDown}})])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.showDatePicker,expression:"showDatePicker"}],ref:"dpContainer",staticStyle:{"z-index":"20",position:"fixed"}},[o("date-picker",{ref:"datepicker",attrs:{inline:"",valueType:"format"},on:{input:e.datepickerClick},model:{value:e.inputDateTime,callback:function(t){e.inputDateTime=t},expression:"inputDateTime"}})],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.processing,expression:"processing"}],ref:"frontdrop",staticClass:"front-drop"},[o("svg",{staticClass:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-3x",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}})])])]),e._v(" "),e.vScroller.buttonHeight<e.vScroller.height?o("div",{ref:"vScroll",staticClass:"v-scroll",style:{top:e.vScroller.top+"px",height:e.vScroller.height+"px"},on:{mousedown:e.vsMouseDown}},[o("div",{ref:"vScrollButton",staticClass:"v-scroll-button",style:{marginTop:e.vScroller.buttonTop+"px",height:e.vScroller.buttonHeight+"px"},on:{mousedown:e.vsbMouseDown}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.vScroller.runner,expression:"vScroller.runner"}],staticClass:"runner",domProps:{innerHTML:e._s(e.vScroller.runner)}})])]):e._e(),e._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:e.focused&&e.autocompleteInputs.length,expression:"focused && autocompleteInputs.length"}],ref:"autocomplete",staticClass:"autocomplete-results"},e._l(e.autocompleteInputs,function(t,a){return o("li",{key:a,staticClass:"autocomplete-result",class:{select:e.autocompleteSelect===a},on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:(t.preventDefault(),e.inputAutocompleteText(t.target.textContent,t))}}},[e._v("\n        "+e._s(t)+"\n      ")])}),0),e._v(" "),o("div",{ref:"footer",staticClass:"footer center-text",class:{hide:e.noFooter},staticStyle:{position:"relative"},on:{mousedown:e.ftMouseDown}},[o("div",{ref:"hScroll",staticClass:"h-scroll",on:{mousedown:e.sbMouseDown}}),e._v(" "),o("span",{staticClass:"left-block"}),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.noPaging,expression:"!noPaging"}],staticStyle:{position:"absolute",left:"46px"}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerLeft(e.pageTop+1,e.pageBottom,e.table.length))}})]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.noPaging&&e.pageBottom-e.pageTop<e.table.length,expression:"!noPaging && pageBottom - pageTop < table.length"}]},[e.processing?[o("svg",{staticClass:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}})]),e._v("\n          \xA0\n          "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.processing)}})]:[o("a",{class:{disabled:0>=e.pageTop},on:{mousedown:e.firstPage}},[o("svg",{staticClass:"svg-inline--fa fa-step-backward fa-w-14 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"step-backward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"}})]),e._v("\n            \xA0\n            "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.first)}})]),e._v("\n          \xA0|\xA0\n          "),o("a",{class:{disabled:0>=e.pageTop},on:{mousedown:e.prevPage}},[o("svg",{staticClass:"svg-inline--fa fa-backward fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"backward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z"}})]),e._v("\n            \xA0\n            "),o("span",{domProps:{innerHTML:e._s(e.localizedLabel.previous)}})]),e._v("\n          \xA0|\xA0\n          "),o("a",{class:{disabled:e.pageTop+e.pageSize>=e.table.length},on:{mousedown:e.nextPage}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.next)}}),e._v("\n            \xA0\n            "),o("svg",{staticClass:"svg-inline--fa fa-forward fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"forward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z"}})])]),e._v("\n          \xA0|\xA0\n          "),o("a",{class:{disabled:e.pageTop+e.pageSize>=e.table.length},on:{mousedown:e.lastPage}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.last)}}),e._v("\n            \xA0\n            "),o("svg",{staticClass:"svg-inline--fa fa-step-forward fa-w-14 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"step-forward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[o("path",{attrs:{fill:"currentColor",d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"}})])])]],2),e._v(" "),o("span",{staticStyle:{position:"absolute",right:"6px"}},[o("a",{class:{disabled:!e.showSelectedOnly&&1>=e.selectedCount},on:{mousedown:e.toggleSelectView}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerRight.selected)}}),e._v(" "),o("span",{style:{color:0<e.selectedCount?"red":"inherit"}},[e._v(e._s(e.selectedCount))])]),e._v("\n        \xA0|\xA0\n        "),o("a",{class:{disabled:"{}"===e.columnFilterString},on:{mousedown:e.toggleFilterView}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerRight.filtered)}}),e._v(" "),o("span",{style:{color:e.table.length===e.filteredValue.length?"inherit":"red"}},[e._v(e._s(e.table.length))])]),e._v("\n        \xA0|\xA0\n        "),o("a",{class:{disabled:!0}},[o("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerRight.loaded)}}),e._v(" "),o("span",[e._v(e._s(e.filteredValue.length))])])])]),e._v(" "),o("input",{ref:"importFile",staticStyle:{position:"absolute",top:"0",left:"0",width:"0",height:"0",opacity:"0","z-index":"-1"},attrs:{type:"file",accept:".xlsx, .xls, xlsm, .csv"},on:{keyup:e.componentTabInto,change:e.doImport}}),e._v(" "),o("panel-filter",{ref:"panelFilter",attrs:{"n-filter-count":e.nFilterCount,"localized-label":e.localizedLabel}}),e._v(" "),o("panel-setting",{ref:"panelSetting",attrs:{"localized-label":e.localizedLabel},model:{value:e.fields,callback:function(t){e.fields=t},expression:"fields"}}),e._v(" "),o("panel-find",{ref:"panelFind",attrs:{"localized-label":e.localizedLabel}})],1)])};id._withStripped=!0;/* style */const ad=/*#__PURE__*/Fi({render:id,staticRenderFns:[]},function(e){e&&e("data-v-1f0c18b7_0",{source:"\ninput[data-v-1f0c18b7]:focus,\r\ninput[data-v-1f0c18b7]:active:focus,\r\ninput.active[data-v-1f0c18b7]:focus {\r\n  outline: none;\r\n  box-shadow: inset 0 -1px 0 #ddd;\n}\n*[data-v-1f0c18b7],\r\n*[data-v-1f0c18b7]::before,\r\n*[data-v-1f0c18b7]::after {\r\n  box-sizing: border-box;\n}\n.input-square[data-v-1f0c18b7] {\r\n  position: absolute;\r\n  padding: 0;\r\n  z-index: 4;\r\n  border: 2px solid rgb(108, 143, 108);\r\n  /* transition: all 0.04s linear; */\n}\n.no-transition[data-v-1f0c18b7] {\r\n  transition: none !important;\n}\n.autocomplete-results[data-v-1f0c18b7] {\r\n  z-index: 15;\r\n  position: fixed;\r\n  padding: 3px;\r\n  margin: -1px;\r\n  background-color: lightyellow;\r\n  border: 1px solid rgb(108, 143, 108);\r\n  /*height: fit-content;*/\r\n  overflow-y: scroll;\r\n  font-size: 0.88rem;\r\n  max-width: 300px;\r\n  max-height: 235px;\n}\n.autocomplete-result[data-v-1f0c18b7] {\r\n  list-style: none;\r\n  text-align: left;\r\n  padding: 4px 2px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  cursor: pointer;\n}\n.autocomplete-result.select[data-v-1f0c18b7] {\r\n  background-color: lightsteelblue;\n}\n.rb-square[data-v-1f0c18b7] {\r\n  width: 9px;\r\n  height: 9px;\r\n  border-top: 2px solid white;\r\n  border-left: 2px solid white;\r\n  border-bottom: 0;\r\n  border-right: 0;\r\n  background-color: rgb(108, 143, 108);\r\n  position: absolute;\r\n  bottom: -3px;\r\n  right: -2px;\r\n  cursor: crosshair;\n}\n.input-box[data-v-1f0c18b7] {\r\n  opacity: 0;\r\n  font-family: inherit;\r\n  color: inherit;\r\n  text-shadow: inherit;\r\n  font-size: 0.88rem;\r\n  width: 100%;\r\n  height: 100%;\r\n  border: 0;\r\n  resize: none;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  background: white;\n}\n.component-content[data-v-1f0c18b7] {\r\n  display: flex;\r\n  flex-flow: column;\r\n  position: relative;\r\n  max-width: fit-content;\r\n  word-spacing: 0.02rem;\r\n  line-height: 1.1;\r\n  overflow: hidden;\r\n  border: 1px solid lightgray;\n}\n.center-text[data-v-1f0c18b7] {\r\n  text-align: center;\n}\n.table-content[data-v-1f0c18b7] {\r\n  flex: 1 1 auto;\r\n  font-size: 1rem;\r\n  text-shadow: 0.3px 0.3px 1px #ccc;\r\n  overflow: scroll;\r\n  -webkit-touch-callout: none;\r\n  -webkit-user-select: none;\r\n  -khtml-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n  position: relative;\r\n  width: 100%;\r\n  scrollbar-width: none;\n}\n.table-content[data-v-1f0c18b7] :focus {\r\n  outline: none;\n}\n.table-content[data-v-1f0c18b7]::-webkit-scrollbar {\r\n  background: white;\r\n  width: 0;\r\n  height: 0;\n}\n.table-content.no-footer[data-v-1f0c18b7] {\r\n  border-bottom: 0;\n}\n.table-content.no-footer[data-v-1f0c18b7]::-webkit-scrollbar {\r\n  height: 0;\n}\n.table-content[data-v-1f0c18b7]::-webkit-scrollbar-thumb {\r\n  background: #eeee;\n}\n.table-content[data-v-1f0c18b7]::-webkit-scrollbar-thumb:hover {\r\n  background: #9999;\n}\n.table-col-header[data-v-1f0c18b7] {\r\n  cursor: text;\n}\n.systable[data-v-1f0c18b7] {\r\n  z-index: -1;\r\n  width: fit-content;\r\n  border: 0;\r\n  border-collapse: separate;\r\n  border-spacing: 0;\r\n  /*\r\n  margin-bottom: -1px;\r\n  border-bottom: 1px solid lightgray;\r\n  */\n}\n.systable .last-col[data-v-1f0c18b7] {\r\n  width: 12px;\n}\n.systable.no-number[data-v-1f0c18b7] {\r\n  margin-left: 0 !important;\n}\n.systable tbody tr[data-v-1f0c18b7] {\r\n  background-color: white;\r\n  text-align: left;\n}\n.systable tr.select td[data-v-1f0c18b7] {\r\n  background-color: #bbb !important;\n}\n.systable th[data-v-1f0c18b7],\r\n.systable td[data-v-1f0c18b7] {\r\n  vertical-align: bottom;\r\n  padding: 0.2rem 0.3rem;\r\n  font-size: 0.88rem;\r\n  height: 24px;\r\n  border-top: 0;\r\n  border-left: 0;\n}\n.systable th[data-v-1f0c18b7]:not(:last-child) {\r\n  border-right: 1px solid lightgray;\n}\n.systable tbody td[data-v-1f0c18b7] {\r\n  cursor: cell;\r\n  white-space: nowrap;\r\n  overflow-x: hidden;\r\n  text-overflow: ellipsis;\r\n  /* animation: fadein 0.2s; */\n}\n.systable.alt tbody td.link[data-v-1f0c18b7]:hover {\r\n  color: blue;\r\n  text-decoration: underline;\r\n  cursor: pointer !important;\n}\n.systable tbody td.error[data-v-1f0c18b7] {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAAAGZJREFUOBGlzjsOgDAMA9CwcQSO0PtP3K64Qyugv8S2ZMXTUw5DstmFk8qWAuhEbzSzbQ+oWIPKULAPpGAdxGJDiMGmUBRbQhFsC3kxF+TB3NAOC0ErLAzNMAoaYTT0xyTojclQxR5H5B1HhuS+WAAAAABJRU5ErkJggg==\") !important;\r\n  background-repeat: no-repeat !important;\r\n  background-size: 8px 8px !important;\r\n  background-position: right 0px top 0px !important;\n}\n.systable tbody tr:not(:last-child) td[data-v-1f0c18b7] {\r\n  border-bottom: 1px solid lightgray;\n}\n.systable tbody tr:last-child td[data-v-1f0c18b7] {\r\n  border-bottom: 1px solid transparent;\n}\n.systable td[data-v-1f0c18b7]:not(:last-child) {\r\n  border-right: 1px solid lightgray;\n}\n.systable thead th[data-v-1f0c18b7],\r\n.systable thead td[data-v-1f0c18b7] {\r\n  padding: 0.4rem 0.3rem;\r\n  font-weight: 400;\r\n  top: 0;\r\n  height: 29px;\r\n  position: sticky;\r\n  z-index: 5;\r\n  border-bottom: 1px solid lightgray;\n}\n.systable thead th[data-v-1f0c18b7] {\r\n  background-color: #e9ecef;\r\n  cursor: s-resize;\r\n  z-index: 6;\n}\n.systable thead td.column-filter[data-v-1f0c18b7] {\r\n  text-align: left;\r\n  background-color: #fffff2;\r\n  white-space: nowrap;\r\n  overflow-x: hidden;\r\n  text-overflow: ellipsis;\n}\n.systable th.focus[data-v-1f0c18b7] {\r\n  border-bottom: 1px solid rgb(61, 85, 61) !important;\n}\n.systable td.first-col.focus[data-v-1f0c18b7] {\r\n  border-right: 1px solid rgb(61, 85, 61) !important;\n}\n.systable tbody td.select[data-v-1f0c18b7]:not(.readonly) {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC\");\r\n  background-repeat: no-repeat;\r\n  background-size: 8px 8px;\r\n  background-position: right 5px top 8px;\n}\n.systable tbody td.datepick[data-v-1f0c18b7]:not(.readonly) {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC\");\r\n  background-repeat: no-repeat;\r\n  background-size: 8px 8px;\r\n  background-position: right 5px top 8px;\n}\n.systable .first-col[data-v-1f0c18b7] {\r\n  background: #e9ecef;\r\n  width: 40px;\r\n  position: sticky;\r\n  left: 0;\r\n  top: auto;\r\n  cursor: e-resize !important;\r\n  text-overflow: inherit !important;\r\n  text-align: center;\r\n  padding-left: 0;\r\n  padding-right: 0;\r\n  overflow: hidden;\r\n  z-index: 5;\n}\n.systable .sticky-column[data-v-1f0c18b7] {\r\n  position: sticky;\r\n  z-index: 2;\n}\n.systable tbody td.sticky-column[data-v-1f0c18b7] {\r\n  background-color: white;\n}\n.systable thead th.sticky-column[data-v-1f0c18b7] {\r\n  z-index: 7;\n}\n.systable thead td.sticky-column[data-v-1f0c18b7] {\r\n  z-index: 6;\n}\n.systable thead td.first-col[data-v-1f0c18b7],\r\n.systable thead th.first-col[data-v-1f0c18b7] {\r\n  cursor: pointer !important;\r\n  z-index: 10;\n}\n.systable tfoot .row-summary[data-v-1f0c18b7] {\r\n  height: 25px;\r\n  border-right: 0;\r\n  border-top: 1px solid lightgray;\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 4;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  background: #fffff2;\n}\n.systable tfoot .row-summary.sticky-column[data-v-1f0c18b7] {\r\n  z-index: 5;\n}\n.systable tfoot .row-summary.summary-column1[data-v-1f0c18b7] {\r\n  border-right: 1px solid lightgray;\n}\n.systable tfoot .row-summary.summary-column2[data-v-1f0c18b7] {\r\n  border-right: 1px solid lightgray;\r\n  background: white;\n}\n.systable tfoot .row-summary[data-v-1f0c18b7]:last-child {\r\n  border-right: 0 !important;\n}\n.systable tfoot .row-summary.first-col[data-v-1f0c18b7] {\r\n  height: 25px;\r\n  border-top: 1px solid lightgray;\r\n  border-right: 1px solid lightgray;\r\n  background: #e9ecef;\r\n  position: sticky;\r\n  left: 0;\r\n  top: auto;\r\n  z-index: 6;\n}\n.footer[data-v-1f0c18b7] {\r\n  z-index: 5;\r\n  padding: 0;\r\n  font-size: 12px;\r\n  color: dimgray;\r\n  background-color: white;\r\n  width: 100%;\r\n  height: 25px;\r\n  line-height: 2.3;\r\n  border-top: 1px solid lightgray;\r\n  user-select: none;\n}\n.footer .left-block[data-v-1f0c18b7] {\r\n  position: absolute;\r\n  left: 0;\r\n  height: 25px;\r\n  width: 40px;\r\n  background-color: #e9ecef;\r\n  border-right: 1px solid lightgray;\n}\n.h-scroll[data-v-1f0c18b7] {\r\n  z-index: -1;\r\n  position: absolute;\r\n  background-color: #f4f6f9;\r\n  height: 25px;\r\n  margin-left: 40px;\r\n  width: 65%;\r\n  cursor: pointer;\n}\n.h-scroll[data-v-1f0c18b7]:hover,\r\n.h-scroll.focus[data-v-1f0c18b7],\r\n.footer:hover .h-scroll[data-v-1f0c18b7] {\r\n  background-color: lightgray;\n}\n.footer a[data-v-1f0c18b7] {\r\n  cursor: pointer;\r\n  color: #007bff;\n}\n.footer a.disabled[data-v-1f0c18b7] {\r\n  cursor: not-allowed;\r\n  color: gray;\r\n  pointer-events: none;\n}\n.footer a[data-v-1f0c18b7]:hover {\r\n  text-decoration: underline;\n}\n.v-scroll[data-v-1f0c18b7] {\r\n  display: inline-block;\r\n  position: absolute;\r\n  right: 0;\r\n  width: 13px;\r\n  z-index: 5;\r\n  background-color: white;\r\n  border-left: 1px solid lightgray;\r\n  user-select: none;\n}\n.v-scroll-button[data-v-1f0c18b7] {\r\n  position: relative;\r\n  display: inline-block;\r\n  width: 100%;\r\n  z-index: 10;\r\n  background-color: #f4f6f9;\r\n  cursor: pointer;\n}\n.v-scroll-button.focus[data-v-1f0c18b7],\r\n.v-scroll-button[data-v-1f0c18b7]:hover,\r\n.v-scroll:hover .v-scroll-button[data-v-1f0c18b7] {\r\n  background-color: lightgray;\n}\n.runner[data-v-1f0c18b7] {\r\n  font-size: 0.88rem;\r\n  padding: 0.5rem;\r\n  position: absolute;\r\n  right: 23px;\r\n  top: 4px;\r\n  display: inline-block;\r\n  width: fit-content;\r\n  z-index: 10;\r\n  background-color: #e9ecef;\r\n  border-radius: 3px;\r\n  white-space: nowrap;\n}\n.runner[data-v-1f0c18b7]:before {\r\n  content: \"\";\r\n  display: block;\r\n  width: 0;\r\n  height: 0;\r\n  position: absolute;\r\n  border-top: 4px solid transparent;\r\n  border-bottom: 8px solid transparent;\r\n  border-left: 8px solid #e9ecef;\r\n  right: -8px;\r\n  top: 4px;\n}\n.front-drop[data-v-1f0c18b7] {\r\n  position: fixed;\r\n  opacity: 0.4;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: #55555555;\r\n  color: white;\r\n  z-index: 1000;\n}\na[data-v-1f0c18b7]:disabled {\r\n  cursor: not-allowed;\r\n  color: gray;\r\n  pointer-events: none;\n}\n.col-sep[data-v-1f0c18b7] {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  border-right: 5px solid transparent;\r\n  width: 5px;\r\n  cursor: col-resize;\r\n  height: 100%;\r\n  z-index: 15;\n}\n.add-col-btn[data-v-1f0c18b7] {\r\n  display: none;\r\n  position: absolute;\r\n  top: 12px;\r\n  right: 8px;\r\n  width: 20px;\r\n  height: 20px;\r\n  background-color: #2222;\r\n  z-index: 15;\r\n  border: solid 1px #2222;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  color: white;\n}\n.add-col-btn[data-v-1f0c18b7]:hover {\r\n  background-color: #7777;\n}\n.sort-asc-sign[data-v-1f0c18b7] {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAMAAADzN3VRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAeUExURQAAAK+np6+qqq+rq62pqa+rq6+rq6+srK+rq6+rq2v5ERwAAAAJdFJOUwAgYHCAv8/f71KXockAAAAJcEhZcwAAFxEAABcRAcom8z8AAABNSURBVChT7clRAoAgCATRtTLq/hcuBEN0j9B8zoNV76j6s37hsh+a+NWknQ3l8pGTAk4KlAwIdVgoYKIREmUYaIaPVnBi0IjDS2cA8AC8JAq/VhDqzAAAAABJRU5ErkJggg==\");\r\n  background-repeat: no-repeat;\r\n  background-size: 9px 9px;\r\n  background-position: right 5px top 3px;\n}\n.sort-des-sign[data-v-1f0c18b7] {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAYCAMAAAA4a6b0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAkUExURQAAAK+np6+qqq+rq6+pqa+qqq+rq6+rq6+rq6+srK+rq6+rqzDc2iQAAAALdFJOUwAgMEBQYHC/z9/v4u0IugAAAAlwSFlzAAAXEQAAFxEByibzPwAAAFVJREFUKFPtyVEWgCAIRFHC1HL2v98o53SEWELvC+bK0nYor5CeGCkZICUdBhkRjAoX9oLlqCzgyAOwc5caAKgT2gdIGQDNgGfM6Knzv+vcZr8kInIBUrIMxVKQeVsAAAAASUVORK5CYII=\");\r\n  background-repeat: no-repeat;\r\n  background-size: 9px 9px;\r\n  background-position: right 5px top 3px;\n}\n.filter-sign[data-v-1f0c18b7] {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAlCAMAAABiU6n+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAhUExURQAAAK+vr6+np6+qqq+pqa+qqq2pqa+srK+srK+rq6+rq01/tHwAAAAKdFJOUwAQIDBQYICv3+8SoWj4AAAACXBIWXMAABcRAAAXEQHKJvM/AAAAiUlEQVQ4T+3OOxaAMAhEUfwmsv8FazLjMRBiZ+er4ExzJelLSSZeUccisvMO2uUq8+nKU5lXfl1bWWWkS1gHuuJCoa66UKCDCwU6ulCnu13I6x4XcrrGhYyudSGjMy7U6KwLPTrvQhwDV42jaueqcVTl7+L4zzaO386Zv+teZ/6u9xXzcK2zXUVOdLIT4IImCksAAAAASUVORK5CYII=\");\r\n  background-repeat: no-repeat;\r\n  background-size: 9px 9px;\r\n  background-position: right 0px bottom 0px;\n}\n.hide[data-v-1f0c18b7] {\r\n  display: none !important;\n}\n@keyframes fadein-data-v-1f0c18b7 {\nfrom {\r\n    opacity: 0;\n}\nto {\r\n    opacity: 1;\n}\n}\n.fa-spin[data-v-1f0c18b7] {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-1f0c18b7] {\r\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-1f0c18b7] {\r\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-1f0c18b7] {\r\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-1f0c18b7] {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-1f0c18b7] {\r\n  text-align: center;\r\n  width: 1.25em;\n}\n.fa-xs[data-v-1f0c18b7] {\r\n  font-size: 0.75em;\n}\n.fa-sm[data-v-1f0c18b7] {\r\n  font-size: 0.875em;\n}\n.fa-3x[data-v-1f0c18b7] {\r\n  font-size: 3em;\n}\n.tool-tip[data-v-1f0c18b7] {\r\n  display: inline-block;\r\n  position: fixed;\r\n  color: white;\r\n  background-color: red;\r\n  padding: 0.5rem;\r\n  min-height: 1rem;\r\n  max-width: 200px;\r\n  word-wrap: break-word;\r\n  border-radius: 4px;\r\n  z-index: 50;\n}\n.tool-tip[data-v-1f0c18b7]:before {\r\n  content: \"\";\r\n  display: block;\r\n  width: 0;\r\n  height: 0;\r\n  position: absolute;\r\n  border-top: 8px solid transparent;\r\n  border-bottom: 8px solid transparent;\r\n  border-right: 8px solid red;\r\n  left: -8px;\r\n  top: 8px;\n}\n.norecord[data-v-1f0c18b7] {\r\n  z-index: 1;\r\n  font-size: smaller;\r\n  position: absolute;\r\n  left: 50%;\r\n  transform: translate(-50%, 0%);\n}\r\n",map:{version:3,sources:["C:\\Projects\\vue-excel-editor\\src\\VueExcelEditor.vue"],names:[],mappings:";AAm3GA;;;EAGA,aAAA;EACA,+BAAA;AACA;AACA;;;EAGA,sBAAA;AACA;AACA;EACA,kBAAA;EACA,UAAA;EACA,UAAA;EACA,oCAAA;EACA,kCAAA;AACA;AACA;EACA,2BAAA;AACA;AACA;EACA,WAAA;EACA,eAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,oCAAA;EACA,uBAAA;EACA,kBAAA;EACA,kBAAA;EACA,gBAAA;EACA,iBAAA;AACA;AACA;EACA,gBAAA;EACA,gBAAA;EACA,gBAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;EACA,eAAA;AACA;AACA;EACA,gCAAA;AACA;AACA;EACA,UAAA;EACA,WAAA;EACA,2BAAA;EACA,4BAAA;EACA,gBAAA;EACA,eAAA;EACA,oCAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,iBAAA;AACA;AACA;EACA,UAAA;EACA,oBAAA;EACA,cAAA;EACA,oBAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,SAAA;EACA,YAAA;EACA,mBAAA;EACA,gBAAA;EACA,iBAAA;AACA;AACA;EACA,aAAA;EACA,iBAAA;EACA,kBAAA;EACA,sBAAA;EACA,qBAAA;EACA,gBAAA;EACA,gBAAA;EACA,2BAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;EACA,eAAA;EACA,iCAAA;EACA,gBAAA;EACA,2BAAA;EACA,yBAAA;EACA,wBAAA;EACA,sBAAA;EACA,qBAAA;EACA,iBAAA;EACA,kBAAA;EACA,WAAA;EACA,qBAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,iBAAA;EACA,QAAA;EACA,SAAA;AACA;AACA;EACA,gBAAA;AACA;AACA;EACA,SAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,YAAA;AACA;AACA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;EACA,iBAAA;EACA;;;GAGA;AACA;AACA;EACA,WAAA;AACA;AACA;EACA,yBAAA;AACA;AACA;EACA,uBAAA;EACA,gBAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;;EAEA,sBAAA;EACA,sBAAA;EACA,kBAAA;EACA,YAAA;EACA,aAAA;EACA,cAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;EACA,YAAA;EACA,mBAAA;EACA,kBAAA;EACA,uBAAA;EACA,4BAAA;AACA;AACA;EACA,WAAA;EACA,0BAAA;EACA,0BAAA;AACA;AACA;EACA,8TAAA;EACA,uCAAA;EACA,mCAAA;EACA,iDAAA;AACA;AACA;EACA,kCAAA;AACA;AACA;EACA,oCAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;;EAEA,sBAAA;EACA,gBAAA;EACA,MAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;EACA,kCAAA;AACA;AACA;EACA,yBAAA;EACA,gBAAA;EACA,UAAA;AACA;AACA;EACA,gBAAA;EACA,yBAAA;EACA,mBAAA;EACA,kBAAA;EACA,uBAAA;AACA;AACA;EACA,mDAAA;AACA;AACA;EACA,kDAAA;AACA;AACA;EACA,2VAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,2VAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,mBAAA;EACA,WAAA;EACA,gBAAA;EACA,OAAA;EACA,SAAA;EACA,2BAAA;EACA,iCAAA;EACA,kBAAA;EACA,eAAA;EACA,gBAAA;EACA,gBAAA;EACA,UAAA;AACA;AACA;EACA,gBAAA;EACA,UAAA;AACA;AACA;EACA,uBAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,UAAA;AACA;AACA;;EAEA,0BAAA;EACA,WAAA;AACA;AACA;EACA,YAAA;EACA,eAAA;EACA,+BAAA;EACA,gBAAA;EACA,SAAA;EACA,UAAA;EACA,gBAAA;EACA,uBAAA;EACA,mBAAA;EACA,mBAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;EACA,iCAAA;EACA,iBAAA;AACA;AACA;EACA,0BAAA;AACA;AACA;EACA,YAAA;EACA,+BAAA;EACA,iCAAA;EACA,mBAAA;EACA,gBAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AACA;AACA;EACA,UAAA;EACA,UAAA;EACA,eAAA;EACA,cAAA;EACA,uBAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,+BAAA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;EACA,OAAA;EACA,YAAA;EACA,WAAA;EACA,yBAAA;EACA,iCAAA;AACA;AACA;EACA,WAAA;EACA,kBAAA;EACA,yBAAA;EACA,YAAA;EACA,iBAAA;EACA,UAAA;EACA,eAAA;AACA;AACA;;;EAGA,2BAAA;AACA;AAEA;EACA,eAAA;EACA,cAAA;AACA;AACA;EACA,mBAAA;EACA,WAAA;EACA,oBAAA;AACA;AACA;EACA,0BAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;EACA,UAAA;EACA,uBAAA;EACA,gCAAA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;EACA,qBAAA;EACA,WAAA;EACA,WAAA;EACA,yBAAA;EACA,eAAA;AACA;AACA;;;EAGA,2BAAA;AACA;AACA;EACA,kBAAA;EACA,eAAA;EACA,kBAAA;EACA,WAAA;EACA,QAAA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;EACA,mBAAA;AACA;AACA;EACA,WAAA;EACA,cAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,iCAAA;EACA,oCAAA;EACA,8BAAA;EACA,WAAA;EACA,QAAA;AACA;AAEA;EACA,eAAA;EACA,YAAA;EACA,aAAA;EACA,uBAAA;EACA,mBAAA;EACA,2BAAA;EACA,YAAA;EACA,aAAA;AACA;AACA;EACA,mBAAA;EACA,WAAA;EACA,oBAAA;AACA;AACA;EACA,kBAAA;EACA,MAAA;EACA,QAAA;EACA,mCAAA;EACA,UAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;AACA;AACA;EACA,aAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,uBAAA;EACA,WAAA;EACA,uBAAA;EACA,kBAAA;EACA,eAAA;EACA,YAAA;AACA;AACA;EACA,uBAAA;AACA;AACA;EACA,2XAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,+YAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,+cAAA;EACA,4BAAA;EACA,wBAAA;EACA,yCAAA;AACA;AACA;EACA,wBAAA;AACA;AACA;AACA;IACA,UAAA;AACA;AACA;IACA,UAAA;AACA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;EACA,qBAAA;EACA,eAAA;EACA,gBAAA;EACA,gBAAA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;AACA;AACA;EACA,WAAA;EACA,cAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,iCAAA;EACA,oCAAA;EACA,2BAAA;EACA,UAAA;EACA,QAAA;AACA;AACA;EACA,UAAA;EACA,kBAAA;EACA,kBAAA;EACA,SAAA;EACA,8BAAA;AACA",file:"VueExcelEditor.vue",sourcesContent:["<template>\r\n  <div\r\n    class=\"vue-excel-editor\"\r\n    :style=\"{ display: 'inline-block', 'max-width': width }\"\r\n  >\r\n    <div class=\"component-content\">\r\n      <!-- No record -->\r\n      <div\r\n        v-if=\"localizedLabel.noRecordIndicator && pagingTable.length == 0\"\r\n        class=\"norecord\"\r\n        :style=\"{ bottom: noFooter ? '12px' : '37px' }\"\r\n      >\r\n        {{ localizedLabel.noRecordIndicator }}\r\n      </div>\r\n\r\n      <div\r\n        ref=\"tableContent\"\r\n        class=\"table-content\"\r\n        :class=\"{ 'no-footer': noFooter }\"\r\n        @scroll=\"tableScroll\"\r\n        @mouseover=\"mouseOver\"\r\n        @mouseout=\"mouseOut\"\r\n      >\r\n        <!-- Main Table -->\r\n        <table\r\n          ref=\"systable\"\r\n          id=\"systable\"\r\n          style=\"table-layout: fixed; width: 0\"\r\n          class=\"systable\"\r\n          :class=\"{ 'no-number': noNumCol }\"\r\n          ondragenter=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\r\n          ondragover=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\r\n        >\r\n          <colgroup>\r\n            <col style=\"width: 40px\" />\r\n            <col\r\n              v-for=\"(item, p) in fields\"\r\n              v-show=\"!item.invisible\"\r\n              :key=\"p\"\r\n              :style=\"{ width: item.width }\"\r\n            />\r\n            <col\r\n              v-if=\"vScroller.buttonHeight < vScroller.height\"\r\n              style=\"width: 12px\"\r\n            />\r\n          </colgroup>\r\n          <thead class=\"center-text\">\r\n            <tr>\r\n              <th\r\n                class=\"center-text first-col tl-setting\"\r\n                :class=\"{ hide: noNumCol }\"\r\n                style=\"top: 0\"\r\n                @mousedown.left=\"selectAllClick\"\r\n                @contextmenu.prevent=\"settingClick\"\r\n              >\r\n                <span style=\"width: 100%\">\r\n                  <svg\r\n                    v-if=\"selectedCount > 0\"\r\n                    aria-hidden=\"true\"\r\n                    focusable=\"false\"\r\n                    data-prefix=\"fas\"\r\n                    data-icon=\"times-circle\"\r\n                    role=\"img\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 512 512\"\r\n                    class=\"svg-inline--fa fa-times-circle fa-w-16 fa-sm\"\r\n                  >\r\n                    <path\r\n                      fill=\"currentColor\"\r\n                      d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z\"\r\n                    ></path>\r\n                  </svg>\r\n                  <svg\r\n                    v-else\r\n                    aria-hidden=\"true\"\r\n                    focusable=\"false\"\r\n                    data-prefix=\"fas\"\r\n                    data-icon=\"bars\"\r\n                    role=\"img\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 448 512\"\r\n                    class=\"svg-inline--fa fa-bars fa-w-14 fa-sm\"\r\n                  >\r\n                    <path\r\n                      fill=\"currentColor\"\r\n                      d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"\r\n                    ></path>\r\n                  </svg>\r\n                  <!--\r\n                  <svg v-if=\"processing\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"spinner\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm\"><path fill=\"currentColor\" d=\"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z\"></path></svg>\r\n                  <svg v-else aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"bars\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-bars fa-w-14 fa-sm\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"></path></svg>\r\n                  -->\r\n                </span>\r\n              </th>\r\n              <th\r\n                v-for=\"(item, p) in fields\"\r\n                v-show=\"!item.invisible\"\r\n                :key=\"`th-${p}`\"\r\n                :colspan=\"\r\n                  p === fields.length - 1 &&\r\n                  vScroller.buttonHeight < vScroller.height\r\n                    ? 2\r\n                    : 1\r\n                \"\r\n                :class=\"{\r\n                  'sort-asc-sign': sortPos == p && sortDir == 1,\r\n                  'sort-des-sign': sortPos == p && sortDir == -1,\r\n                  'sticky-column': item.sticky,\r\n                }\"\r\n                :style=\"{ left: item.left }\"\r\n                @mousedown=\"headerClick($event, p)\"\r\n                @contextmenu.prevent=\"panelFilterClick(item)\"\r\n              >\r\n                <div :class=\"{ 'filter-sign': columnFilter[p] }\">\r\n                  <span\r\n                    :class=\"{ 'table-col-header': !noHeaderEdit }\"\r\n                    v-html=\"headerLabel(item.label, item)\"\r\n                  ></span>\r\n                </div>\r\n                <div\r\n                  class=\"col-sep\"\r\n                  @mousedown=\"colSepMouseDown\"\r\n                  @mouseover=\"colSepMouseOver\"\r\n                  @mouseout=\"colSepMouseOut\"\r\n                >\r\n                  <div class=\"add-col-btn\">+</div>\r\n                </div>\r\n              </th>\r\n            </tr>\r\n            <tr :class=\"{ hide: !filterRow }\">\r\n              <td\r\n                class=\"center-text first-col tl-filter\"\r\n                :class=\"{ hide: noNumCol }\"\r\n                style=\"vertical-align: middle; padding: 0\"\r\n                :style=\"{ top: calCellTop2 + 'px' }\"\r\n                @click=\"columnFilter = {}\"\r\n              >\r\n                <span v-if=\"Object.keys(columnFilter).length > 0\">\r\n                  <svg\r\n                    aria-hidden=\"true\"\r\n                    focusable=\"false\"\r\n                    data-prefix=\"fas\"\r\n                    data-icon=\"eraser\"\r\n                    role=\"img\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 512 512\"\r\n                    class=\"svg-inline--fa fa-eraser fa-w-16 fa-sm\"\r\n                  >\r\n                    <path\r\n                      fill=\"currentColor\"\r\n                      d=\"M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z\"\r\n                    ></path>\r\n                  </svg>\r\n                </span>\r\n                <!--\r\n                <svg v-if=\"selectedCount==table.length\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"times-circle\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-times-circle fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z\"></path></svg>\r\n                <svg v-else aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"check-circle\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-check-circle fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z\"></path></svg>\r\n                -->\r\n              </td>\r\n              <vue-excel-filter\r\n                v-for=\"(item, p) in fields\"\r\n                v-show=\"!item.invisible\"\r\n                :ref=\"`filter-${item.name}`\"\r\n                :colspan=\"p === fields.length - 1 ? 2 : 1\"\r\n                :key=\"`th2-${p}`\"\r\n                v-model=\"columnFilter[p]\"\r\n                :class=\"{ 'sticky-column': item.sticky }\"\r\n                :style=\"{ left: item.left }\"\r\n                class=\"column-filter\"\r\n              />\r\n            </tr>\r\n          </thead>\r\n          <tbody @mousedown=\"mouseDown\">\r\n            <tr\r\n              v-if=\"localizedLabel.noRecordIndicator && pagingTable.length == 0\"\r\n            >\r\n              <td\r\n                colspan=\"100%\"\r\n                style=\"height: 40px; vertical-align: middle; text-align: center\"\r\n              ></td>\r\n            </tr>\r\n            <tr\r\n              v-else\r\n              v-for=\"(record, rowPos) in pagingTable\"\r\n              :key=\"rowPos\"\r\n              :class=\"{\r\n                select: typeof selected[pageTop + rowPos] !== 'undefined',\r\n              }\"\r\n              :style=\"rowStyle(record)\"\r\n            >\r\n              <td\r\n                class=\"center-text first-col\"\r\n                :id=\"`rid-${record.$id}`\"\r\n                :class=\"{\r\n                  hide: noNumCol,\r\n                  error: rowerr[`rid-${record.$id}`],\r\n                }\"\r\n                :pos=\"rowPos\"\r\n                @mouseover=\"numcolMouseOver\"\r\n                @click=\"rowLabelClick\"\r\n              >\r\n                <span v-html=\"recordLabel(pageTop + rowPos + 1, record)\"></span>\r\n              </td>\r\n              <template v-for=\"(item, p) in fields\">\r\n                <td\r\n                  v-show=\"!item.invisible\"\r\n                  :id=\"`id-${record.$id}-${item.name}`\"\r\n                  :cell-RC=\"`${rowPos}-${item.name}`\"\r\n                  :class=\"{\r\n                    readonly: item.readonly,\r\n                    error: errmsg[`id-${record.$id}-${item.name}`],\r\n                    link: item.link,\r\n                    select: item.options,\r\n                    datepick: item.type == 'date',\r\n                    'sticky-column': item.sticky,\r\n                  }\"\r\n                  :style=\"\r\n                    Object.assign(\r\n                      cellStyle(record, item),\r\n                      renderColumnCellStyle(item)\r\n                    )\r\n                  \"\r\n                  :key=\"p\"\r\n                  @mouseover=\"cellMouseOver\"\r\n                  @mousemove=\"cellMouseMove\"\r\n                >\r\n                  {{ item.toText(record[item.name]) }}\r\n                </td>\r\n              </template>\r\n              <td\r\n                v-if=\"vScroller.buttonHeight < vScroller.height\"\r\n                class=\"last-col\"\r\n              ></td>\r\n            </tr>\r\n          </tbody>\r\n          <tfoot>\r\n            <tr v-show=\"pagingTable.length && summaryRow\">\r\n              <td class=\"row-summary first-col\">&nbsp;</td>\r\n              <template v-for=\"(field, p) in fields\">\r\n                <td\r\n                  v-show=\"!field.invisible\"\r\n                  class=\"row-summary\"\r\n                  :colspan=\"\r\n                    p === fields.length - 1 &&\r\n                    vScroller.buttonHeight < vScroller.height\r\n                      ? 2\r\n                      : 1\r\n                  \"\r\n                  :class=\"{\r\n                    'sticky-column': field.sticky,\r\n                    'summary-column1':\r\n                      p + 1 < fields.length && fields[p + 1].summary,\r\n                    'summary-column2': field.summary,\r\n                  }\"\r\n                  :style=\"renderColumnCellStyle(field)\"\r\n                  :key=\"`f${p}`\"\r\n                >\r\n                  {{ summary[field.name] }}\r\n                </td>\r\n              </template>\r\n            </tr>\r\n          </tfoot>\r\n          <slot></slot>\r\n        </table>\r\n\r\n        <!-- Tool Tip -->\r\n        <div v-show=\"tip\" ref=\"tooltip\" class=\"tool-tip\">{{ tip }}</div>\r\n\r\n        <!-- Editor Square -->\r\n        <div\r\n          v-show=\"focused\"\r\n          ref=\"inputSquare\"\r\n          class=\"input-square\"\r\n          @mousedown=\"inputSquareClick\"\r\n        >\r\n          <div style=\"position: relative; height: 100%; padding: 2px 2px 1px\">\r\n            <div class=\"rb-square\" />\r\n            <textarea\r\n              ref=\"inputBox\"\r\n              id=\"inputBox\"\r\n              class=\"input-box\"\r\n              :style=\"{ opacity: inputBoxShow }\"\r\n              @blur=\"inputBoxBlur\"\r\n              @mousemove=\"inputBoxMouseMove\"\r\n              @mousedown=\"inputBoxMouseDown\"\r\n              trim\r\n              autocomplete=\"off\"\r\n              autocorrect=\"off\"\r\n              autocompitaize=\"off\"\r\n              :spellcheck=\"spellcheck\"\r\n            ></textarea>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Date Picker -->\r\n        <div\r\n          ref=\"dpContainer\"\r\n          v-show=\"showDatePicker\"\r\n          style=\"z-index: 20; position: fixed\"\r\n        >\r\n          <date-picker\r\n            ref=\"datepicker\"\r\n            inline\r\n            v-model=\"inputDateTime\"\r\n            @input=\"datepickerClick\"\r\n            valueType=\"format\"\r\n          ></date-picker>\r\n        </div>\r\n\r\n        <!-- Waiting scene -->\r\n        <div v-show=\"processing\" ref=\"frontdrop\" class=\"front-drop\">\r\n          <svg\r\n            aria-hidden=\"true\"\r\n            focusable=\"false\"\r\n            data-prefix=\"fas\"\r\n            data-icon=\"spinner\"\r\n            role=\"img\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            viewBox=\"0 0 512 512\"\r\n            class=\"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-3x\"\r\n          >\r\n            <path\r\n              fill=\"currentColor\"\r\n              d=\"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z\"\r\n            ></path>\r\n          </svg>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Vertical Scroll Bar -->\r\n      <div\r\n        v-if=\"vScroller.buttonHeight < vScroller.height\"\r\n        ref=\"vScroll\"\r\n        class=\"v-scroll\"\r\n        :style=\"{ top: `${vScroller.top}px`, height: `${vScroller.height}px` }\"\r\n        @mousedown=\"vsMouseDown\"\r\n      >\r\n        <div\r\n          ref=\"vScrollButton\"\r\n          class=\"v-scroll-button\"\r\n          :style=\"{\r\n            marginTop: `${vScroller.buttonTop}px`,\r\n            height: `${vScroller.buttonHeight}px`,\r\n          }\"\r\n          @mousedown=\"vsbMouseDown\"\r\n        >\r\n          <div\r\n            v-show=\"vScroller.runner\"\r\n            class=\"runner\"\r\n            v-html=\"vScroller.runner\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Autocomplete List -->\r\n      <ul\r\n        ref=\"autocomplete\"\r\n        v-show=\"focused && autocompleteInputs.length\"\r\n        class=\"autocomplete-results\"\r\n      >\r\n        <li\r\n          v-for=\"(item, i) in autocompleteInputs\"\r\n          :key=\"i\"\r\n          :class=\"{ select: autocompleteSelect === i }\"\r\n          @mousedown.left.prevent=\"\r\n            inputAutocompleteText($event.target.textContent, $event)\r\n          \"\r\n          class=\"autocomplete-result\"\r\n        >\r\n          {{ item }}\r\n        </li>\r\n      </ul>\r\n\r\n      <!-- Footer -->\r\n      <div\r\n        ref=\"footer\"\r\n        class=\"footer center-text\"\r\n        :class=\"{ hide: noFooter }\"\r\n        style=\"position: relative\"\r\n        @mousedown=\"ftMouseDown\"\r\n      >\r\n        <div ref=\"hScroll\" class=\"h-scroll\" @mousedown=\"sbMouseDown\" />\r\n        <span class=\"left-block\"></span>\r\n        <span v-show=\"!noPaging\" style=\"position: absolute; left: 46px\">\r\n          <span\r\n            v-html=\"\r\n              localizedLabel.footerLeft(pageTop + 1, pageBottom, table.length)\r\n            \"\r\n          ></span>\r\n        </span>\r\n        <span v-show=\"!noPaging && pageBottom - pageTop < table.length\">\r\n          <template v-if=\"processing\">\r\n            <svg\r\n              aria-hidden=\"true\"\r\n              focusable=\"false\"\r\n              data-prefix=\"fas\"\r\n              data-icon=\"spinner\"\r\n              role=\"img\"\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              viewBox=\"0 0 512 512\"\r\n              class=\"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm\"\r\n            >\r\n              <path\r\n                fill=\"currentColor\"\r\n                d=\"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z\"\r\n              ></path>\r\n            </svg>\r\n            &nbsp;\r\n            <span v-html=\"localizedLabel.processing\" />\r\n          </template>\r\n          <template v-else>\r\n            <a :class=\"{ disabled: pageTop <= 0 }\" @mousedown=\"firstPage\">\r\n              <svg\r\n                aria-hidden=\"true\"\r\n                focusable=\"false\"\r\n                data-prefix=\"fas\"\r\n                data-icon=\"step-backward\"\r\n                role=\"img\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 448 512\"\r\n                class=\"svg-inline--fa fa-step-backward fa-w-14 fa-sm\"\r\n              >\r\n                <path\r\n                  fill=\"currentColor\"\r\n                  d=\"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z\"\r\n                ></path>\r\n              </svg>\r\n              &nbsp;\r\n              <span v-html=\"localizedLabel.first\" />\r\n            </a>\r\n            &nbsp;|&nbsp;\r\n            <a :class=\"{ disabled: pageTop <= 0 }\" @mousedown=\"prevPage\">\r\n              <svg\r\n                aria-hidden=\"true\"\r\n                focusable=\"false\"\r\n                data-prefix=\"fas\"\r\n                data-icon=\"backward\"\r\n                role=\"img\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 512 512\"\r\n                class=\"svg-inline--fa fa-backward fa-w-16 fa-sm\"\r\n              >\r\n                <path\r\n                  fill=\"currentColor\"\r\n                  d=\"M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z\"\r\n                ></path>\r\n              </svg>\r\n              &nbsp;\r\n              <span v-html=\"localizedLabel.previous\" />\r\n            </a>\r\n            &nbsp;|&nbsp;\r\n            <a\r\n              :class=\"{ disabled: pageTop + pageSize >= table.length }\"\r\n              @mousedown=\"nextPage\"\r\n            >\r\n              <span v-html=\"localizedLabel.next\" />\r\n              &nbsp;\r\n              <svg\r\n                aria-hidden=\"true\"\r\n                focusable=\"false\"\r\n                data-prefix=\"fas\"\r\n                data-icon=\"forward\"\r\n                role=\"img\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 512 512\"\r\n                class=\"svg-inline--fa fa-forward fa-w-16 fa-sm\"\r\n              >\r\n                <path\r\n                  fill=\"currentColor\"\r\n                  d=\"M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z\"\r\n                ></path>\r\n              </svg>\r\n            </a>\r\n            &nbsp;|&nbsp;\r\n            <a\r\n              :class=\"{ disabled: pageTop + pageSize >= table.length }\"\r\n              @mousedown=\"lastPage\"\r\n            >\r\n              <span v-html=\"localizedLabel.last\" />\r\n              &nbsp;\r\n              <svg\r\n                aria-hidden=\"true\"\r\n                focusable=\"false\"\r\n                data-prefix=\"fas\"\r\n                data-icon=\"step-forward\"\r\n                role=\"img\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 448 512\"\r\n                class=\"svg-inline--fa fa-step-forward fa-w-14 fa-sm\"\r\n              >\r\n                <path\r\n                  fill=\"currentColor\"\r\n                  d=\"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z\"\r\n                ></path>\r\n              </svg>\r\n            </a>\r\n          </template>\r\n        </span>\r\n        <span style=\"position: absolute; right: 6px\">\r\n          <a\r\n            :class=\"{ disabled: !showSelectedOnly && selectedCount <= 1 }\"\r\n            @mousedown=\"toggleSelectView\"\r\n          >\r\n            <span v-html=\"localizedLabel.footerRight.selected\" />\r\n            <span :style=\"{ color: selectedCount > 0 ? 'red' : 'inherit' }\">{{\r\n              selectedCount\r\n            }}</span>\r\n          </a>\r\n          &nbsp;|&nbsp;\r\n          <a\r\n            :class=\"{ disabled: columnFilterString === '{}' }\"\r\n            @mousedown=\"toggleFilterView\"\r\n          >\r\n            <span v-html=\"localizedLabel.footerRight.filtered\" />\r\n            <span\r\n              :style=\"{\r\n                color:\r\n                  table.length !== filteredValue.length ? 'red' : 'inherit',\r\n              }\"\r\n              >{{ table.length }}</span\r\n            >\r\n          </a>\r\n          &nbsp;|&nbsp;\r\n          <a :class=\"{ disabled: true }\">\r\n            <span v-html=\"localizedLabel.footerRight.loaded\" />\r\n            <span>{{ filteredValue.length }}</span>\r\n          </a>\r\n        </span>\r\n      </div>\r\n\r\n      <input\r\n        type=\"file\"\r\n        ref=\"importFile\"\r\n        accept=\".xlsx, .xls, xlsm, .csv\"\r\n        style=\"\r\n          position: absolute;\r\n          top: 0;\r\n          left: 0;\r\n          width: 0;\r\n          height: 0;\r\n          opacity: 0;\r\n          z-index: -1;\r\n        \"\r\n        @keyup=\"componentTabInto\"\r\n        @change=\"doImport\"\r\n      />\r\n\r\n      <panel-filter\r\n        ref=\"panelFilter\"\r\n        :n-filter-count=\"nFilterCount\"\r\n        :localized-label=\"localizedLabel\"\r\n      />\r\n      <panel-setting\r\n        ref=\"panelSetting\"\r\n        v-model=\"fields\"\r\n        :localized-label=\"localizedLabel\"\r\n      />\r\n      <panel-find ref=\"panelFind\" :localized-label=\"localizedLabel\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue\";\r\nimport VueExcelFilter from \"./VueExcelFilter.vue\";\r\nimport PanelFilter from \"./panelFilter.vue\";\r\nimport PanelSetting from \"./panelSetting.vue\";\r\nimport PanelFind from \"./panelFind.vue\";\r\nimport DatePicker from \"vue2-datepicker\";\r\nimport XLSX from \"xlsx\";\r\n\r\nimport \"vue2-datepicker/index.css\";\r\n\r\nexport default {\r\n  components: {\r\n    \"vue-excel-filter\": VueExcelFilter,\r\n    \"panel-filter\": PanelFilter,\r\n    \"panel-setting\": PanelSetting,\r\n    \"panel-find\": PanelFind,\r\n    \"date-picker\": DatePicker,\r\n  },\r\n  props: {\r\n    disablePanelSetting: {\r\n      type: Boolean,\r\n      default() {\r\n        return false;\r\n      },\r\n    },\r\n    disablePanelFilter: {\r\n      type: Boolean,\r\n      default() {\r\n        return false;\r\n      },\r\n    },\r\n    value: {\r\n      type: Array,\r\n      default() {\r\n        return [];\r\n      },\r\n    },\r\n    rowStyle: {\r\n      type: Function,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n    cellStyle: {\r\n      type: Function,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n    headerLabel: {\r\n      type: Function,\r\n      default(label) {\r\n        return label;\r\n      },\r\n    },\r\n    recordLabel: {\r\n      // return the row header\r\n      type: Function,\r\n      default(pos) {\r\n        return pos;\r\n      },\r\n    },\r\n    noFinding: { type: Boolean, default: false },\r\n    noFindingNext: { type: Boolean, default: false },\r\n    filterRow: { type: Boolean, default: false },\r\n    freeSelect: { type: Boolean, default: false },\r\n    noFooter: { type: Boolean, default: false },\r\n    noPaging: { type: Boolean, default: false },\r\n    noNumCol: { type: Boolean, default: false },\r\n    noMouseScroll: { type: Boolean, default: false },\r\n    page: { type: Number, default: 0 }, // prefer page size, auto-cal if not provided\r\n    enterToSouth: { type: Boolean, default: false }, // default enter to south\r\n    nFilterCount: { type: Number, default: 1000 }, // show top n values in filter dialog\r\n    height: { type: String, default: \"\" },\r\n    width: { type: String, default: \"100%\" },\r\n    autocomplete: { type: Boolean, default: false }, // Default autocomplete of all columns\r\n    autocompleteCount: { type: Number, default: 50 },\r\n    readonly: { type: Boolean, default: false },\r\n    readonlyStyle: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n    remember: { type: Boolean, default: false },\r\n    register: { type: Function, default: null },\r\n    allowAddCol: { type: Boolean, default: false },\r\n    noHeaderEdit: { type: Boolean, default: false },\r\n    addColumn: { type: Function, default: null },\r\n    spellcheck: { type: Boolean, default: false },\r\n    newIfBottom: { type: Boolean, default: false },\r\n    validate: { type: Function, default: null },\r\n    localizedLabel: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          footerLeft: (top, bottom, total) =>\r\n            `Record ${top} to ${bottom} of ${total}`,\r\n          first: \"First\",\r\n          previous: \"Previous\",\r\n          next: \"Next\",\r\n          last: \"Last\",\r\n          footerRight: {\r\n            selected: \"Selected:\",\r\n            filtered: \"Filtered:\",\r\n            loaded: \"Loaded:\",\r\n          },\r\n          processing: \"Processing\",\r\n          tableSetting: \"Table Setting\",\r\n          exportExcel: \"Export Excel\",\r\n          importExcel: \"Import Excel\",\r\n          back: \"Back\",\r\n          reset: \"Default\",\r\n          sortingAndFiltering: \"Sorting And Filtering\",\r\n          sortAscending: \"Sort Ascending\",\r\n          sortDescending: \"Sort Descending\",\r\n          near: \"\u2252 Near\",\r\n          exactMatch: \"= Exact Match\",\r\n          notMatch: \"\u2260 Not Match\",\r\n          greaterThan: \"&gt; Greater Than\",\r\n          greaterThanOrEqualTo: \"\u2265 Greater Than or Equal To\",\r\n          lessThan: \"&lt; Less Than\",\r\n          lessThanOrEqualTo: \"\u2264 Less Than Or Equal To\",\r\n          regularExpression: \"~ Regular Expression\",\r\n          customFilter: \"Custom Filter\",\r\n          listFirstNValuesOnly: (n) => `List first ${n} values only`,\r\n          apply: \"Apply\",\r\n          noRecordIsRead: \"No record is read\",\r\n          readonlyColumnDetected: \"Readonly column detected\",\r\n          columnHasValidationError: (name, err) =>\r\n            `Column ${name} has validation error: ${err}`,\r\n          rowHasValidationError: (row, name, err) =>\r\n            `Row ${row} has validation error for column ${name}: ${err}`,\r\n          noMatchedColumnName: \"No matched column name\",\r\n          invalidInputValue: \"Invalid input value\",\r\n          missingKeyColumn: \"Missing key column\",\r\n          noRecordIndicator: \"No record\",\r\n        };\r\n      },\r\n    },\r\n    recordFilter: {\r\n      type: Function,\r\n      default() {\r\n        return true;\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    const pageSize = this.noPaging ? 999999 : 20;\r\n    const dataset = {\r\n      version: \"1.3\",\r\n      tableContent: null, // Table parent\r\n      systable: null, // TABLE dom node\r\n      colgroupTr: null, // colgroup TR dom node\r\n      labelTr: null, // THEAD label dom node\r\n      filterTr: null, // THEAD filter dom node\r\n      recordBody: null, // TBODY dom node\r\n      footer: null, // TFOOTER dom node\r\n\r\n      pageSize: pageSize,\r\n      pageTop: 0, // Current page top pos of [table] array\r\n\r\n      selected: {}, // selected storage in hash, key is the pos of [table] array\r\n      selectedCount: 0, // selected row count\r\n      prevSelect: -1, // previous select pos of [table] array\r\n      processing: false, // current general-purpose processing status\r\n\r\n      rowIndex: {}, // index of the record key to pos of [table] array\r\n\r\n      currentRecord: null, // focusing row content\r\n      currentRowPos: 0, // focusing array pos of [table] array\r\n      currentColPos: 0, // focusing pos of column/field\r\n      currentField: null, // focusing field object\r\n      currentCell: null,\r\n      inputBox: null,\r\n      inputBoxShow: 0,\r\n      inputSquare: null,\r\n      autocompleteInputs: [],\r\n      autocompleteSelect: -1,\r\n\r\n      errmsg: {},\r\n      rowerr: {},\r\n      tip: \"\",\r\n\r\n      colHash: \"\",\r\n      fields: [],\r\n      focused: false,\r\n      mousein: false,\r\n      inputBoxChanged: false,\r\n\r\n      columnFilter: {}, // set filter storage in hash, key is the column pos\r\n\r\n      inputFind: \"\",\r\n      calCellLeft: 0,\r\n      calCellTop: 0,\r\n      calCellTop2: 29,\r\n\r\n      frontdrop: null, // frontdrop dom node\r\n\r\n      sortPos: 0, // Sort column position\r\n      sortDir: 0, // Sort direction, 1=Ascending, -1=Descending\r\n      redo: [], // redo log\r\n\r\n      lazyTimeout: {},\r\n      lazyBuffer: {},\r\n      hScroller: {},\r\n      vScroller: {},\r\n      leftMost: 0,\r\n\r\n      showDatePicker: false,\r\n      inputDateTime: \"\",\r\n\r\n      table: [],\r\n      filteredValue: [],\r\n      lastFilterTime: \"\",\r\n      summaryRow: false,\r\n      summary: {},\r\n      showFilteredOnly: true,\r\n      showSelectedOnly: false,\r\n    };\r\n    return dataset;\r\n  },\r\n  computed: {\r\n    token() {\r\n      const id = Array.from(\r\n        document.querySelectorAll(\".vue-excel-editor\")\r\n      ).indexOf(this.$el);\r\n      return `vue-excel-editor-${id}`;\r\n    },\r\n    columnFilterString() {\r\n      Object.keys(this.columnFilter).forEach((key) => {\r\n        if (this.columnFilter[key].trim() === \"\") delete this.columnFilter[key];\r\n      });\r\n      return JSON.stringify(this.columnFilter);\r\n    },\r\n    pagingTable() {\r\n      return this.table.slice(this.pageTop, this.pageTop + this.pageSize);\r\n    },\r\n    pageBottom() {\r\n      if (this.filteredValue.length === 0) return 0;\r\n      else\r\n        return this.pageTop + this.pageSize > this.table.length\r\n          ? this.table.length\r\n          : this.pageTop + this.pageSize;\r\n    },\r\n    setting: {\r\n      get() {\r\n        return null;\r\n      },\r\n      set(setter) {\r\n        if (setter.fields) {\r\n          // ignore if fields counts are different\r\n          if (setter.fields.length !== this.fields.length) return;\r\n          let valid = true;\r\n          const newFields = setter.fields.map((local) => {\r\n            const current = this.fields.find((f) => f.name === local.name);\r\n            if (!current) valid = false;\r\n            else {\r\n              if (typeof local.invisible !== \"undefined\")\r\n                current.invisible = local.invisible;\r\n              if (typeof local.width !== \"undefined\")\r\n                current.width = local.width;\r\n              if (typeof local.label !== \"undefined\")\r\n                current.label = local.label;\r\n            }\r\n            return current;\r\n          });\r\n          if (valid) {\r\n            this.fields = newFields;\r\n            this.$forceUpdate();\r\n          }\r\n        }\r\n      },\r\n    },\r\n  },\r\n  watch: {\r\n    value() {\r\n      this.lazy(() => {\r\n        this.refresh();\r\n        if (this.pageTop > this.table.length) this.lastPage();\r\n      });\r\n    },\r\n    columnFilterString() {\r\n      this.lastFilterTime = String(new Date().getTime() % 1e8);\r\n      this.processing = true;\r\n      setTimeout(() => {\r\n        this.pageTop = 0;\r\n        this.refresh();\r\n        this.processing = false;\r\n      }, 0);\r\n    },\r\n    fields: {\r\n      handler() {\r\n        this.lazy(() => {\r\n          const setting = this.getSetting();\r\n          if (this.remember)\r\n            localStorage[\r\n              window.location.pathname + \".\" + this.token\r\n            ] = JSON.stringify(setting);\r\n          this.$emit(\"setting\", setting);\r\n        });\r\n      },\r\n      deep: true,\r\n    },\r\n    processing(newVal) {\r\n      if (newVal) {\r\n        const rect = this.$el.children[0].getBoundingClientRect();\r\n        this.frontdrop.style.top = rect.top + \"px\";\r\n        this.frontdrop.style.left = rect.left + \"px\";\r\n        this.frontdrop.style.height = rect.height + \"px\";\r\n        this.frontdrop.style.width = rect.width + \"px\";\r\n      }\r\n    },\r\n    pageTop(newVal) {\r\n      this.$emit(\"page-changed\", newVal, newVal + this.pageSize - 1);\r\n    },\r\n    pageSize(newVal) {\r\n      this.$emit(\"page-changed\", this.pageTop, this.pageTop + newVal - 1);\r\n    },\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener(\"resize\", this.winResize);\r\n    window.removeEventListener(\"paste\", this.winPaste);\r\n    window.removeEventListener(\"keydown\", this.winKeydown);\r\n    window.removeEventListener(\"keyup\", this.winKeyup);\r\n    window.removeEventListener(\"scroll\", this.winScroll);\r\n    window.removeEventListener(\"wheel\", this.mousewheel);\r\n  },\r\n  mounted() {\r\n    this.tableContent = this.$refs.tableContent;\r\n    this.systable = this.$refs.systable;\r\n    this.colgroupTr = this.systable.children[0];\r\n    this.labelTr = this.systable.children[1].children[0];\r\n    this.filterTr = this.systable.children[1].children[1];\r\n    this.recordBody = this.systable.children[2];\r\n    this.footer = this.$refs.footer;\r\n    this.inputSquare = this.$refs.inputSquare;\r\n    this.inputBox = this.$refs.inputBox;\r\n    this.frontdrop = this.$refs.frontdrop;\r\n\r\n    if (this.height) this.systable.parentNode.style.height = this.height;\r\n\r\n    this.reset();\r\n    this.lazy(() => {\r\n      this.labelTr.children[0].style.height = this.labelTr.offsetHeight + \"px\";\r\n      this.calCellTop2 = this.labelTr.offsetHeight;\r\n      this.refreshPageSize();\r\n      this.tableContent.scrollTo(0, this.tableContent.scrollTop);\r\n      this.calStickyLeft();\r\n    }, 200);\r\n\r\n    window.addEventListener(\"resize\", this.winResize);\r\n    window.addEventListener(\"paste\", this.winPaste);\r\n    window.addEventListener(\"keydown\", this.winKeydown);\r\n    window.addEventListener(\"keyup\", this.winKeyup);\r\n    window.addEventListener(\"scroll\", this.winScroll);\r\n    window.addEventListener(\"wheel\", this.mousewheel, { passive: false });\r\n\r\n    if (this.remember) {\r\n      const saved = localStorage[window.location.pathname + \".\" + this.token];\r\n      if (saved) {\r\n        const data = JSON.parse(saved);\r\n        if (data.colHash === this.colHash) this.setting = data;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    componentTabInto(e) {\r\n      if (e.keyCode === 9) {\r\n        if (!this.moveInputSquare(this.currentRowPos, this.currentColPos))\r\n          this.moveInputSquare(0, 0);\r\n      }\r\n    },\r\n    reset() {\r\n      this.errmsg = {};\r\n      this.redo = [];\r\n      this.showFilteredOnly = true;\r\n      this.showSelectedOnly = false;\r\n      this.columnFilter = {};\r\n      this.sortPos = 0;\r\n      this.sortDir = 0;\r\n      this.inputFind = \"\";\r\n      this.pageTop = 0;\r\n      this.selected = {};\r\n      this.selectedCount = 0;\r\n      this.prevSelect = -1;\r\n      this.processing = false;\r\n      this.rowIndex = {};\r\n      this.refresh();\r\n    },\r\n    toggleSelectView(e) {\r\n      if (e) e.stopPropagation();\r\n      this.showSelectedOnly = !this.showSelectedOnly;\r\n      return this.refresh();\r\n    },\r\n    toggleFilterView(e) {\r\n      if (e) e.stopPropagation();\r\n      this.showFilteredOnly = !this.showFilteredOnly;\r\n      return this.refresh();\r\n    },\r\n    resetColumn() {\r\n      this.fields = [];\r\n      this.$slots.default.forEach((col) =>\r\n        col.componentInstance ? col.componentInstance.init() : 0\r\n      );\r\n      this.tableContent.scrollTo(0, this.tableContent.scrollTop);\r\n      this.calStickyLeft();\r\n    },\r\n    registerColumn(field) {\r\n      let pos = this.fields.findIndex((item) => item.pos > field.pos);\r\n      if (pos === -1) pos = this.fields.length;\r\n      this.fields.splice(pos, 0, field);\r\n      if (this.register) this.register(field, pos);\r\n      if (field.register) field.register(field, pos);\r\n      if (field.summary) this.summaryRow = true;\r\n      this.colHash = this.hashCode(this.version + JSON.stringify(this.fields));\r\n    },\r\n    insertColumn(pos) {\r\n      const colname =\r\n        \"COL-\" +\r\n        Math.random()\r\n          .toString()\r\n          .slice(2, 6);\r\n      let colDef = {\r\n        name: colname,\r\n        label: colname,\r\n        type: \"string\",\r\n        width: \"100px\",\r\n\r\n        validate: null,\r\n        change: null,\r\n        link: null,\r\n        sort: null,\r\n\r\n        keyField: false,\r\n        sticky: false,\r\n        // tabStop: true,\r\n        allowKeys: null,\r\n        mandatory: false,\r\n        lengthLimit: 0,\r\n\r\n        autocomplete: this.autocomplete,\r\n        textTransform: null,\r\n        initStyle: \"left\",\r\n        invisible: false,\r\n        readonly: this.readonly,\r\n        pos: 0,\r\n        options: null,\r\n        summary: null,\r\n        toValue: (t) => t,\r\n        toText: (t) => t,\r\n        register: null,\r\n      };\r\n      if (this.addColumn) colDef = this.addColumn(colDef);\r\n      this.newColumn(colDef, pos);\r\n    },\r\n    newColumn(field, pos) {\r\n      this.fields.splice(pos, 0, field);\r\n      if (this.register) this.register(field, pos);\r\n      if (field.register) field.register(field, pos);\r\n      if (field.summary) this.summaryRow = true;\r\n      this.colHash = this.hashCode(this.version + JSON.stringify(this.fields));\r\n    },\r\n    autoRegisterAllColumns(rows) {\r\n      // If no field is defined, this function will help to create all fields based on provided row sample argument\r\n      const widths = rows\r\n        .slice(0, 25)\r\n        .reduce(\r\n          (t, v) =>\r\n            Object.keys(v).map((s, i) =>\r\n              !t || v[s].length > t[i] ? v[s].length : t[i]\r\n            ),\r\n          0\r\n        )\r\n        .map((v) => Math.min(Math.max(v * 8.2, 55), 250));\r\n\r\n      Object.keys(rows[0]).forEach((col, i) => {\r\n        if (col === \"$id\") return;\r\n        this.registerColumn({\r\n          name: col,\r\n          label: col,\r\n          type: widths[i] ? \"string\" : \"number\",\r\n          width: (widths[i] ? widths[i] : 75) + \"px\",\r\n          validate: null,\r\n          change: null,\r\n          link: null,\r\n          keyField: false,\r\n          sticky: false,\r\n          tabStop: true,\r\n          allowKeys: null,\r\n          mandatory: false,\r\n          lengthLimit: 0,\r\n          autocomplete: this.autocomplete,\r\n          initStyle: { textAlign: widths[i] ? \"left\" : \"right\" },\r\n          invisible: false,\r\n          readonly: this.readonly,\r\n          pos: 0,\r\n          options: null,\r\n          summary: null,\r\n          sort: null,\r\n          toValue: (t) => t,\r\n          toText: (t) => t,\r\n          register: null,\r\n        });\r\n      });\r\n    },\r\n    refresh() {\r\n      // this.pageTop = 0\r\n      this.prevSelect = -1;\r\n      if (\r\n        this.fields.length === 0 &&\r\n        this.value.length &&\r\n        Object.keys(this.value[0])\r\n      ) {\r\n        this.autoRegisterAllColumns(this.value);\r\n      }\r\n      this.calTable();\r\n      this.refreshPageSize();\r\n    },\r\n    calTable() {\r\n      // add unique key to each row if no key is provided\r\n      let seed = String(new Date().getTime() % 1e8);\r\n      this.value.forEach((rec, i) => {\r\n        if (!rec.$id) rec.$id = seed + \"-\" + (\"000000\" + i).slice(-7);\r\n      });\r\n\r\n      if (this.showFilteredOnly === false) {\r\n        this.table = this.value;\r\n      } else {\r\n        const filterColumnList = Object.keys(this.columnFilter);\r\n        const filter = {};\r\n        filterColumnList.forEach((k) => {\r\n          switch (true) {\r\n            case this.columnFilter[k].startsWith(\"<=\"):\r\n              filter[k] = {\r\n                type: 1,\r\n                value: this.columnFilter[k]\r\n                  .slice(2)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              if (this.fields[k].type === \"number\")\r\n                filter[k].value = Number(filter[k].value);\r\n              break;\r\n            case this.columnFilter[k].startsWith(\"<>\"):\r\n              filter[k] = {\r\n                type: 9,\r\n                value: this.columnFilter[k]\r\n                  .slice(2)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              break;\r\n            case this.columnFilter[k].startsWith(\"<\"):\r\n              filter[k] = {\r\n                type: 2,\r\n                value: this.columnFilter[k]\r\n                  .slice(1)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              if (this.fields[k].type === \"number\")\r\n                filter[k].value = Number(filter[k].value);\r\n              break;\r\n            case this.columnFilter[k].startsWith(\">=\"):\r\n              filter[k] = {\r\n                type: 3,\r\n                value: this.columnFilter[k]\r\n                  .slice(2)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              if (this.fields[k].type === \"number\")\r\n                filter[k].value = Number(filter[k].value);\r\n              break;\r\n            case this.columnFilter[k].startsWith(\">\"):\r\n              filter[k] = {\r\n                type: 4,\r\n                value: this.columnFilter[k]\r\n                  .slice(1)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              if (this.fields[k].type === \"number\")\r\n                filter[k].value = Number(filter[k].value);\r\n              break;\r\n            case this.columnFilter[k].startsWith(\"=\"):\r\n              filter[k] = {\r\n                type: 0,\r\n                value: this.columnFilter[k]\r\n                  .slice(1)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              break;\r\n            case this.columnFilter[k].startsWith(\"*\") &&\r\n              this.columnFilter[k].endsWith(\"*\"):\r\n              filter[k] = {\r\n                type: 5,\r\n                value: this.columnFilter[k]\r\n                  .slice(1)\r\n                  .slice(0, -1)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              break;\r\n            case this.columnFilter[k].startsWith(\"*\") &&\r\n              !this.columnFilter[k].slice(1).includes(\"*\"):\r\n              filter[k] = {\r\n                type: 6,\r\n                value: this.columnFilter[k]\r\n                  .slice(1)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              break;\r\n            case this.columnFilter[k].startsWith(\"~\"):\r\n              filter[k] = {\r\n                type: 8,\r\n                value: this.columnFilter[k].slice(1).trim(),\r\n              };\r\n              break;\r\n            case this.columnFilter[k].endsWith(\"*\") &&\r\n              !this.columnFilter[k].slice(0, -1).includes(\"*\"):\r\n              filter[k] = {\r\n                type: 7,\r\n                value: this.columnFilter[k]\r\n                  .slice(0, -1)\r\n                  .trim()\r\n                  .toUpperCase(),\r\n              };\r\n              break;\r\n            case this.columnFilter[k].includes(\"*\") ||\r\n              this.columnFilter[k].includes(\"?\"):\r\n              filter[k] = {\r\n                type: 8,\r\n                value:\r\n                  \"^\" +\r\n                  this.columnFilter[k]\r\n                    .replace(/\\*/g, \".*\")\r\n                    .replace(/\\?/g, \".\")\r\n                    .trim() +\r\n                  \"$\",\r\n              };\r\n              break;\r\n            default:\r\n              filter[k] = {\r\n                type: 5,\r\n                value: this.columnFilter[k].trim().toUpperCase(),\r\n              };\r\n              break;\r\n          }\r\n        });\r\n        this.filteredValue = this.value.filter((record) =>\r\n          this.recordFilter(record)\r\n        );\r\n        if (filterColumnList.length === 0) this.table = this.filteredValue;\r\n        else {\r\n          this.table = this.filteredValue.filter((record) => {\r\n            // Record is created after the filter time\r\n            if (record.$id > this.lastFilterTime) return true;\r\n\r\n            // Assume new record contains \xA7 in any of the key fields\r\n            /*\r\n            const isNew = this.fields.filter((field) => {\r\n              return field.keyField && record[field.name] && record[field.name].startsWith('\xA7')\r\n            }).length > 0\r\n            if (isNew) return true // Always show new record in filter mode\r\n            */\r\n\r\n            const content = {};\r\n            filterColumnList.forEach((k) => {\r\n              const val = record[this.fields[k].name];\r\n              if (this.fields[k].type === \"number\" && filter[k].type <= 4)\r\n                content[k] = val;\r\n              else\r\n                content[k] =\r\n                  typeof val === \"undefined\" || val === null\r\n                    ? \"\"\r\n                    : String(val).toUpperCase();\r\n            });\r\n\r\n            for (let i = 0; i < filterColumnList.length; i++) {\r\n              const k = filterColumnList[i];\r\n              switch (filter[k].type) {\r\n                case 0:\r\n                  if (`${content[k]}` !== `${filter[k].value}`) return false;\r\n                  break;\r\n                case 1:\r\n                  if (filter[k].value < content[k]) return false;\r\n                  break;\r\n                case 2:\r\n                  if (filter[k].value <= content[k]) return false;\r\n                  break;\r\n                case 3:\r\n                  if (filter[k].value > content[k]) return false;\r\n                  break;\r\n                case 4:\r\n                  if (filter[k].value >= content[k]) return false;\r\n                  break;\r\n                case 5:\r\n                  if (!content[k].includes(filter[k].value)) return false;\r\n                  break;\r\n                case 6:\r\n                  if (!content[k].endsWith(filter[k].value)) return false;\r\n                  break;\r\n                case 7:\r\n                  if (!content[k].startsWith(filter[k].value)) return false;\r\n                  break;\r\n                case 8:\r\n                  if (!new RegExp(filter[k].value, \"i\").test(content[k]))\r\n                    return false;\r\n                  break;\r\n                case 9:\r\n                  if (`${content[k]}` === `${filter[k].value}`) return false;\r\n                  break;\r\n              }\r\n            }\r\n            return true;\r\n          });\r\n        }\r\n      }\r\n\r\n      this.reviseSelectedAfterTableChange();\r\n      if (this.showSelectedOnly) {\r\n        this.table = this.table.filter((rec, i) => this.selected[i]);\r\n        this.reviseSelectedAfterTableChange();\r\n      }\r\n      this.calSummary();\r\n    },\r\n    calStickyLeft() {\r\n      let left = 0,\r\n        n = 0;\r\n      this.leftMost = -1;\r\n      // this.tableContent.scrollTo(0, this.tableContent.scrollTop)\r\n      Array.from(this.labelTr.children).forEach((th) => {\r\n        left += th.offsetWidth;\r\n        const field = this.fields[n++];\r\n        if (field) {\r\n          if (field.sticky) {\r\n            field.left = left + \"px\";\r\n            this.leftMost = -1; // Reset the leftMost, so it will equal to the next non-sticky col\r\n          } else if (this.leftMost === -1) this.leftMost = left;\r\n        }\r\n      });\r\n      this.$forceUpdate();\r\n    },\r\n    renderColumnCellStyle(field) {\r\n      let result = field.initStyle;\r\n      if (field.readonly) result = Object.assign(result, this.readonlyStyle);\r\n      if (field.left) result = Object.assign(result, { left: field.left });\r\n      return result;\r\n    },\r\n    localeDate(d) {\r\n      if (typeof d === \"undefined\") d = new Date();\r\n      const pad = (n) => (n < 10 ? \"0\" + n : n);\r\n      return (\r\n        d.getFullYear() +\r\n        \"-\" +\r\n        pad(d.getMonth() + 1) +\r\n        \"-\" +\r\n        pad(d.getDate()) +\r\n        \" \" +\r\n        pad(d.getHours()) +\r\n        \":\" +\r\n        pad(d.getMinutes()) +\r\n        \":\" +\r\n        pad(d.getSeconds())\r\n      );\r\n    },\r\n    calSummary(name) {\r\n      this.fields.forEach((field) => {\r\n        if (!field.summary) return;\r\n        const i = field.name;\r\n        if (name && name !== i) return;\r\n        let result = \"\";\r\n        const currentTick = new Date().getTime();\r\n        const currentDateTimeSec = this.localeDate();\r\n        const currentDateTime = currentDateTimeSec.slice(0, 19);\r\n        const currentDate = currentDateTimeSec.slice(0, 10);\r\n        switch (field.summary) {\r\n          case \"sum\":\r\n            result = this.table.reduce(\r\n              (a, b) => a + Number(b[i] ? b[i] : 0),\r\n              0\r\n            );\r\n            result = Number(Math.round(result + \"e+5\") + \"e-5\"); // solve the infinite .9 issue of javascript\r\n            break;\r\n          case \"avg\":\r\n            result =\r\n              this.table.reduce((a, b) => a + Number(b[i] ? b[i] : 0), 0) /\r\n              this.table.length;\r\n            result = Number(Math.round(result + \"e+5\") + \"e-5\"); // solve the infinite .9 issue of javascript\r\n            break;\r\n          case \"max\":\r\n            result = this.table.reduce(\r\n              (a, b) => (a > b[i] ? a : b[i]),\r\n              Number.MIN_VALUE\r\n            );\r\n            break;\r\n          case \"min\":\r\n            result = this.table.reduce(\r\n              (a, b) => (a < b[i] ? a : b[i]),\r\n              Number.MAX_VALUE\r\n            );\r\n            break;\r\n          case \"count\":\r\n            switch (field.type) {\r\n              case \"checkYN\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] === \"Y\" ? 1 : 0),\r\n                  0\r\n                );\r\n                break;\r\n              case \"check10\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] === \"1\" ? 1 : 0),\r\n                  0\r\n                );\r\n                break;\r\n              case \"checkTF\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] === \"T\" ? 1 : 0),\r\n                  0\r\n                );\r\n                break;\r\n              case \"date\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] >= currentDate ? 1 : 0),\r\n                  0\r\n                );\r\n                this.summary[i] = result;\r\n                return;\r\n              case \"datetime\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] >= currentDateTime ? 1 : 0),\r\n                  0\r\n                );\r\n                this.summary[i] = result;\r\n                return;\r\n              case \"datetimesec\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] >= currentDateTimeSec ? 1 : 0),\r\n                  0\r\n                );\r\n                this.summary[i] = result;\r\n                return;\r\n              case \"datetick\":\r\n              case \"datetimetick\":\r\n              case \"datetimesectick\":\r\n                result = this.table.reduce(\r\n                  (a, b) => a + (b[i] >= currentTick ? 1 : 0),\r\n                  0\r\n                );\r\n                this.summary[i] = result;\r\n                return;\r\n              default:\r\n                result = this.table.reduce((a, b) => a + (b[i] ? 1 : 0), 0);\r\n                break;\r\n            }\r\n            break;\r\n        }\r\n        if (field.type === \"number\" && isNaN(result)) return;\r\n        this.summary[i] = field.toText(result);\r\n      });\r\n    },\r\n    getKeys(rec) {\r\n      if (!rec) rec = this.currentRecord;\r\n      const key = this.fields\r\n        .filter((field) => field.keyField)\r\n        .map((field) => rec[field.name]);\r\n      if (key.length && key.join() !== \"\") return key;\r\n      return [rec.$id];\r\n    },\r\n\r\n    /* *** Customization **************************************************************************************\r\n     */\r\n    setFilter(name, filterText) {\r\n      const ref = this.$refs[`filter-${name}`][0];\r\n      ref.$el.textContent = filterText;\r\n      ref.$emit(\"input\", filterText);\r\n    },\r\n\r\n    clearFilter(name) {\r\n      if (!name) this.columnFilter = {};\r\n      else this.setFilter(name, \"\");\r\n    },\r\n\r\n    columnSuppress() {\r\n      if (this.table.length === 0) return;\r\n      const cols = {};\r\n      this.table.forEach((row) => {\r\n        Object.keys(row).forEach((field) => {\r\n          if (row[field]) cols[field] = 1;\r\n        });\r\n      });\r\n      const showCols = Object.keys(cols);\r\n      this.fields.forEach((field) => {\r\n        if (!showCols.includes(field.name)) field.invisible = true;\r\n      });\r\n      // this.refresh()\r\n    },\r\n\r\n    /* Still evaluating */\r\n    columnAutoWidth(name) {\r\n      if (this.table.length === 0) return;\r\n      let doFields = this.fields;\r\n      if (name) doFields = [this.fields.find((f) => f.name === name)];\r\n\r\n      const cols = {};\r\n      this.table.forEach((row) => {\r\n        doFields.forEach((field) => {\r\n          if (\r\n            row[field.name] &&\r\n            (!cols[field.name] || cols[field.name] < row[field.name].length)\r\n          )\r\n            cols[field.name] = row[field.name].length;\r\n        });\r\n      });\r\n      doFields.forEach((field) => {\r\n        let width = cols[field.name] * 12;\r\n        if (width > 450) width = 450;\r\n        field.width = width + \"px\";\r\n      });\r\n      // this.refresh()\r\n    },\r\n\r\n    /* *** Date Picker *********************************************************************************\r\n     */\r\n    showDatePickerDiv() {\r\n      if (!this.$refs.dpContainer) return;\r\n      const cellRect = this.currentCell.getBoundingClientRect();\r\n      this.$refs.dpContainer.style.left = cellRect.left + \"px\";\r\n      this.$refs.dpContainer.style.top = cellRect.bottom + \"px\";\r\n      this.inputDateTime = this.currentCell.textContent;\r\n      this.showDatePicker = true;\r\n      this.lazy(() => {\r\n        if (!this.$refs.dpContainer) return;\r\n        const r = this.$refs.dpContainer.getBoundingClientRect();\r\n        if (r.bottom > window.innerHeight)\r\n          this.$refs.dpContainer.style.top = cellRect.top - r.height + \"px\";\r\n        if (r.right > window.innerWidth)\r\n          this.$refs.dpContainer.style.left =\r\n            window.innerWidth - r.width + \"px\";\r\n      });\r\n    },\r\n    datepickerClick() {\r\n      this.inputBox.value = this.inputDateTime;\r\n      this.inputBoxShow = 0;\r\n      this.inputCellWrite(this.inputDateTime);\r\n      this.showDatePicker = false;\r\n      this.focused = true;\r\n    },\r\n\r\n    /* *** Vertical Scrollbar *********************************************************************************\r\n     */\r\n    calVScroll() {\r\n      let d = this.labelTr.getBoundingClientRect().height;\r\n      if (this.filterRow) d += 29;\r\n      this.vScroller.top = d;\r\n      if (!this.noFooter) d += 25;\r\n      if (this.summaryRow) d += 27;\r\n      const fullHeight = this.$el.getBoundingClientRect().height;\r\n      this.vScroller.height = fullHeight - d;\r\n      const ratio = this.vScroller.height / (this.table.length * 24);\r\n      this.vScroller.buttonHeight = Math.max(24, this.vScroller.height * ratio);\r\n      const prop =\r\n        (this.tableContent.scrollTop + this.pageTop * 24) /\r\n        (this.table.length * 24 - this.vScroller.height);\r\n      this.vScroller.buttonTop =\r\n        (this.vScroller.height - this.vScroller.buttonHeight) * prop;\r\n      this.$forceUpdate();\r\n    },\r\n    vsMouseDown(e) {\r\n      e.stopPropagation();\r\n      const pos = e.offsetY - this.vScroller.buttonHeight / 2;\r\n      let ratio = Math.max(0, pos);\r\n      ratio = Math.min(\r\n        ratio,\r\n        this.vScroller.height - this.vScroller.buttonHeight\r\n      );\r\n      ratio = ratio / (this.vScroller.height - this.vScroller.buttonHeight);\r\n      if (this.noPaging)\r\n        this.tableContent.scrollTo(\r\n          this.tableContent.scrollLeft,\r\n          this.table.length * 24 * ratio\r\n        );\r\n      else {\r\n        this.vScroller.buttonTop =\r\n          ratio * (this.vScroller.height - this.vScroller.buttonHeight);\r\n        this.$refs.vScrollButton.style.marginTop =\r\n          this.vScroller.buttonTop + \"px\";\r\n        this.pageTop = Math.round((this.table.length - this.pageSize) * ratio);\r\n      }\r\n    },\r\n    vsbMouseDown(e) {\r\n      e.stopPropagation();\r\n      if (!this.vScroller.mouseY) {\r\n        this.vScroller.saveButtonTop = this.vScroller.buttonTop;\r\n        this.vScroller.mouseY = e.clientY;\r\n        window.addEventListener(\"mousemove\", this.vsbMouseMove);\r\n        window.addEventListener(\"mouseup\", this.vsbMouseUp);\r\n        this.$refs.vScrollButton.classList.add(\"focus\");\r\n      }\r\n    },\r\n    vsbMouseUp() {\r\n      window.removeEventListener(\"mousemove\", this.vsbMouseMove);\r\n      window.removeEventListener(\"mouseup\", this.vsbMouseUp);\r\n      this.lazy(() => {\r\n        if (!this.$refs.vScrollButton) return;\r\n        this.$refs.vScrollButton.classList.remove(\"focus\");\r\n      });\r\n      this.vScroller.mouseY = 0;\r\n      if (!this.noPaging) {\r\n        const ratio =\r\n          this.vScroller.buttonTop /\r\n          (this.vScroller.height - this.vScroller.buttonHeight);\r\n        this.pageTop = Math.round((this.table.length - this.pageSize) * ratio);\r\n      }\r\n      this.vScroller.runner = \"\";\r\n      this.$forceUpdate();\r\n    },\r\n    vsbMouseMove(e) {\r\n      if (e.buttons === 0) this.vsbMouseUp();\r\n      else {\r\n        const diff = e.clientY - this.vScroller.mouseY;\r\n        if (this.noPaging) {\r\n          const ratio =\r\n            (this.vScroller.saveButtonTop + diff) /\r\n            (this.vScroller.height - this.vScroller.buttonHeight);\r\n          this.tableContent.scrollTo(\r\n            this.tableContent.scrollLeft,\r\n            this.table.length * 24 * ratio\r\n          );\r\n        } else {\r\n          this.vScroller.buttonTop = Math.max(\r\n            0,\r\n            Math.min(\r\n              this.vScroller.height - this.vScroller.buttonHeight,\r\n              this.vScroller.saveButtonTop + diff\r\n            )\r\n          );\r\n          this.$refs.vScrollButton.style.marginTop =\r\n            this.vScroller.buttonTop + \"px\";\r\n\r\n          const ratio =\r\n            this.vScroller.buttonTop /\r\n            (this.vScroller.height - this.vScroller.buttonHeight);\r\n          const recPos =\r\n            Math.round((this.table.length - this.pageSize) * ratio) + 1;\r\n          const rec = this.table[recPos];\r\n          this.vScroller.runner =\r\n            recPos +\r\n            \"<br>\" +\r\n            this.fields\r\n              .filter(\r\n                (field, i) =>\r\n                  field.keyField || field.sticky || this.sortPos === i\r\n              )\r\n              .map((field) => field.label + \": \" + rec[field.name])\r\n              .join(\"<br>\");\r\n          this.$forceUpdate();\r\n        }\r\n      }\r\n    },\r\n\r\n    /* *** Horizontal Scrollbar *********************************************************************************\r\n     */\r\n    ftMouseDown(e) {\r\n      const footerRect = this.footer.getBoundingClientRect();\r\n      const ratio = (e.x - footerRect.left - 40) / (footerRect.width - 40);\r\n      const fullWidth = this.systable.getBoundingClientRect().width;\r\n      const viewWidth = this.tableContent.getBoundingClientRect().width;\r\n      this.tableContent.scrollTo(\r\n        fullWidth * ratio - viewWidth / 2,\r\n        this.tableContent.scrollTop\r\n      );\r\n    },\r\n    sbMouseDown(e) {\r\n      e.stopPropagation();\r\n      if (!this.hScroller.mouseX) {\r\n        const sleft = this.$refs.hScroll.getBoundingClientRect().left;\r\n        const fleft = this.footer.getBoundingClientRect().left + 40;\r\n        this.hScroller.left = sleft - fleft;\r\n        this.hScroller.mouseX = e.clientX;\r\n        window.addEventListener(\"mousemove\", this.sbMouseMove);\r\n        window.addEventListener(\"mouseup\", this.sbMouseUp);\r\n        this.$refs.hScroll.classList.add(\"focus\");\r\n      }\r\n    },\r\n    sbMouseUp() {\r\n      window.removeEventListener(\"mousemove\", this.sbMouseMove);\r\n      window.removeEventListener(\"mouseup\", this.sbMouseUp);\r\n      this.lazy(() => {\r\n        if (!this.$refs.hScroll) return;\r\n        this.$refs.hScroll.classList.remove(\"focus\");\r\n      });\r\n      this.hScroller.mouseX = 0;\r\n      this.$forceUpdate();\r\n    },\r\n    sbMouseMove(e) {\r\n      if (e.buttons === 0) this.sbMouseUp();\r\n      else {\r\n        const diff = e.clientX - this.hScroller.mouseX;\r\n        const ratio =\r\n          (this.hScroller.left + diff) / this.hScroller.scrollerUnseenWidth;\r\n        this.tableContent.scrollTo(\r\n          this.hScroller.tableUnseenWidth * ratio,\r\n          this.tableContent.scrollTop\r\n        );\r\n      }\r\n    },\r\n\r\n    /* *** Window Event *******************************************************************************************\r\n     */\r\n    tableScroll() {\r\n      this.showDatePicker = false;\r\n      this.autocompleteInputs = [];\r\n      if (this.focused && this.currentField)\r\n        this.inputSquare.style.marginLeft =\r\n          (this.currentField.sticky\r\n            ? this.tableContent.scrollLeft - this.squareSavedLeft\r\n            : 0) + \"px\";\r\n\r\n      if (this.tableContent.scrollTop !== this.vScroller.lastTop) {\r\n        this.calVScroll();\r\n        if (this.$refs.vScrollButton) {\r\n          this.$refs.vScrollButton.classList.add(\"focus\");\r\n          this.lazy(\r\n            () => this.$refs.vScrollButton.classList.remove(\"focus\"),\r\n            1000\r\n          );\r\n        }\r\n      }\r\n      this.vScroller.lastTop = this.tableContent.scrollTop;\r\n\r\n      if (this.tableContent.scrollLeft !== this.hScroller.lastLeft) {\r\n        if (this.$refs.hScroll && this.hScroller.tableUnseenWidth) {\r\n          this.$refs.hScroll.classList.add(\"focus\");\r\n          this.lazy(() => this.$refs.hScroll.classList.remove(\"focus\"), 1000);\r\n          const ratio =\r\n            this.tableContent.scrollLeft / this.hScroller.tableUnseenWidth;\r\n          this.$refs.hScroll.style.left =\r\n            this.hScroller.scrollerUnseenWidth * ratio + \"px\";\r\n        }\r\n      }\r\n      this.hScroller.lastLeft = this.tableContent.scrollLeft;\r\n    },\r\n    winScroll() {\r\n      this.showDatePicker = false;\r\n      this.autocompleteInputs = [];\r\n    },\r\n    mousewheel(e) {\r\n      if (this.noMouseScroll || !this.mousein || !e.deltaY) return;\r\n      let adjust = 0;\r\n      if (e.deltaY > 30 && this.pageTop + this.pageSize < this.table.length)\r\n        adjust = 1;\r\n      else if (e.deltaY < -30 && this.pageTop > 0) adjust = -1;\r\n      if (adjust) {\r\n        this.pageTop += adjust;\r\n        setTimeout(this.calVScroll);\r\n        if (this.$refs.vScrollButton) {\r\n          this.$refs.vScrollButton.classList.add(\"focus\");\r\n          this.lazy(\r\n            () => this.$refs.vScrollButton.classList.remove(\"focus\"),\r\n            1000\r\n          );\r\n        }\r\n      }\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return false;\r\n    },\r\n    winResize() {\r\n      this.lazy(this.refreshPageSize, 200);\r\n    },\r\n    winPaste(e) {\r\n      if (e.target.tagName !== \"TEXTAREA\") return;\r\n      if (!this.mousein && !this.focused) return;\r\n      if (!this.currentField || this.currentField.readonly) return;\r\n      if (this.inputBoxShow) {\r\n        this.inputBoxChanged = true;\r\n        return;\r\n      }\r\n      const text = (e.originalEvent || e).clipboardData.getData(\"text/plain\");\r\n      this.inputCellWrite(text);\r\n      e.preventDefault();\r\n    },\r\n    winKeyup(e) {\r\n      if (!e.altKey) this.systable.classList.remove(\"alt\");\r\n    },\r\n    winKeydown(e) {\r\n      if (e.altKey) this.systable.classList.add(\"alt\");\r\n      if (!this.mousein && !this.focused) return;\r\n      if (e.ctrlKey || e.metaKey)\r\n        switch (e.keyCode) {\r\n          case 90: // z\r\n            this.undoTransaction();\r\n            e.preventDefault();\r\n            break;\r\n          case 65: // a\r\n            this.toggleSelectAllRecords();\r\n            e.preventDefault();\r\n            break;\r\n          case 67: // c\r\n            this.inputBox.value = this.currentCell.textContent;\r\n            this.inputBox.focus();\r\n            this.inputBox.select();\r\n            document.execCommand(\"copy\");\r\n            e.preventDefault();\r\n            break;\r\n          case 70: // f\r\n            if (!this.noFinding) {\r\n              this.$refs.panelFind.showPanel();\r\n              e.preventDefault();\r\n            }\r\n            break;\r\n          case 71: // g\r\n            if (!this.noFindingNext && this.inputFind !== \"\") {\r\n              this.doFindNext();\r\n              e.preventDefault();\r\n            }\r\n            break;\r\n          case 76: // l\r\n            e.preventDefault();\r\n            this.calAutocompleteList(true);\r\n            break;\r\n        }\r\n      else {\r\n        if (this.currentRowPos < 0) return;\r\n        switch (e.keyCode) {\r\n          case 37: // Left Arrow\r\n            if (!this.focused) return;\r\n            if (!this.inputBoxShow) {\r\n              this.moveWest(e);\r\n              e.preventDefault();\r\n            } else {\r\n              if (this.inputBox.selectionStart === 0) {\r\n                this.moveWest(e);\r\n                e.preventDefault();\r\n              }\r\n            }\r\n            break;\r\n          case 38: // Up Arrow\r\n            if (!this.focused) return;\r\n            e.preventDefault();\r\n            if (this.autocompleteInputs.length === 0) this.moveNorth();\r\n            else if (this.autocompleteSelect > 0) {\r\n              this.autocompleteSelect--;\r\n              const showTop = this.autocompleteSelect * 23;\r\n              if (showTop < this.$refs.autocomplete.scrollTop)\r\n                this.$refs.autocomplete.scrollTop = showTop;\r\n            } else if (this.autocompleteSelect === -1) {\r\n              this.autocompleteSelect = 0;\r\n              // this.autocompleteSelect = this.autocompleteInputs.length - 1\r\n            }\r\n            break;\r\n          case 9: // Tab\r\n            if (!this.focused) return;\r\n            if (e.shiftKey) {\r\n              if (!this.moveWest(e)) {\r\n                if (this.moveNorth(e)) this.moveToEast(e);\r\n                else return this.inputBoxBlur();\r\n              }\r\n            } else {\r\n              if (!this.moveEast(e)) {\r\n                if (this.moveSouth(e)) this.moveToWest(e);\r\n                else return this.inputBoxBlur();\r\n              }\r\n            }\r\n            e.preventDefault();\r\n            break;\r\n          case 39: // Right Arrow\r\n            if (!this.focused) return;\r\n            if (!this.inputBoxShow) {\r\n              this.moveEast(e);\r\n              e.preventDefault();\r\n            } else {\r\n              if (this.inputBox.selectionEnd === this.inputBox.value.length) {\r\n                this.moveEast(e);\r\n                e.preventDefault();\r\n              }\r\n            }\r\n            break;\r\n          case 40: // Down Arrow\r\n            if (!this.focused) return;\r\n            e.preventDefault();\r\n            if (this.autocompleteInputs.length === 0) this.moveSouth(e);\r\n            else if (\r\n              this.autocompleteSelect <\r\n              this.autocompleteInputs.length - 1\r\n            ) {\r\n              this.autocompleteSelect++;\r\n              if (this.autocompleteSelect >= 10) {\r\n                const showTop = this.autocompleteSelect * 23 - 206;\r\n                const scrollTop = this.$refs.autocomplete.scrollTop;\r\n                if (scrollTop < showTop)\r\n                  this.$refs.autocomplete.scrollTop = showTop;\r\n              }\r\n            }\r\n            break;\r\n          case 13: // Enter\r\n            if (!this.focused) return;\r\n            e.preventDefault();\r\n            if (\r\n              this.autocompleteInputs.length === 0 ||\r\n              this.autocompleteSelect === -1\r\n            ) {\r\n              if (this.enterToSouth) this.moveSouth(e);\r\n              else this.moveEast(e);\r\n            } else if (\r\n              this.autocompleteSelect !== -1 &&\r\n              this.autocompleteSelect < this.autocompleteInputs.length\r\n            ) {\r\n              this.inputAutocompleteText(\r\n                this.autocompleteInputs[this.autocompleteSelect]\r\n              );\r\n            } else {\r\n              this.inputBox.value = this.currentCell.textContent;\r\n              this.inputBoxShow = 0;\r\n              this.inputBoxChanged = false;\r\n            }\r\n            this.inputBoxComplete();\r\n            break;\r\n          case 27: // Esc\r\n            if (!this.focused) return;\r\n            this.showDatePicker = false;\r\n            this.autocompleteInputs = [];\r\n            this.autocompleteSelect = -1;\r\n            if (this.inputBoxShow) {\r\n              e.preventDefault();\r\n              this.inputBox.value = this.currentCell.textContent;\r\n              this.inputBoxShow = 0;\r\n              this.inputBoxChanged = false;\r\n            }\r\n            break;\r\n          case 33: // Page Up\r\n            this.prevPage();\r\n            e.preventDefault();\r\n            break;\r\n          case 34: // Page Down\r\n            this.nextPage();\r\n            e.preventDefault();\r\n            break;\r\n          case 8: // Delete\r\n          case 46: // BS\r\n            if (!this.focused) return;\r\n            if (this.inputBoxShow) {\r\n              this.inputBoxChanged = true;\r\n              setTimeout(() => this.calAutocompleteList(true));\r\n              return;\r\n            }\r\n            if (this.currentField.readonly) return;\r\n            if (this.autocompleteInputs.length) return;\r\n            this.inputBoxChanged = true;\r\n            this.inputBox.value = \"\";\r\n            this.inputBoxComplete();\r\n            break;\r\n          default:\r\n            if (!this.focused) return;\r\n            if (this.currentField.readonly) return;\r\n            if (e.altKey) return;\r\n            if (e.key !== \"Process\" && e.key.length > 1) return;\r\n            if (!this.inputBoxShow && this.currentField.type === \"date\") {\r\n              this.showDatePickerDiv();\r\n              return;\r\n            }\r\n            if (this.currentField.allowKeys) {\r\n              if (this.currentField.allowKeys.constructor.name === \"Function\") {\r\n                if (!this.currentField.allowKeys(e.key.toUpperCase()))\r\n                  return e.preventDefault();\r\n              } else if (\r\n                this.currentField.allowKeys.indexOf(e.key.toUpperCase()) === -1\r\n              )\r\n                return e.preventDefault();\r\n            }\r\n            if (\r\n              this.currentField.lengthLimit &&\r\n              this.inputBox.value.length > this.currentField.lengthLimit\r\n            )\r\n              return e.preventDefault();\r\n            if (!this.inputBoxShow) {\r\n              if (\r\n                this.currentField.type === \"select\" ||\r\n                this.currentField.type === \"map\"\r\n              ) {\r\n                setTimeout(() => this.calAutocompleteList(true));\r\n                if (e.keyCode === 32) return e.preventDefault();\r\n                this.inputBox.value = \"\";\r\n                this.inputBoxShow = 1;\r\n                this.inputBox.focus();\r\n                return;\r\n              }\r\n              this.inputBox.value = \"\";\r\n              this.inputBoxShow = 1;\r\n              this.inputBox.focus();\r\n              setTimeout(this.calAutocompleteList);\r\n            } else\r\n              setTimeout(() =>\r\n                this.calAutocompleteList(this.autocompleteInputs.length)\r\n              );\r\n            this.inputBoxChanged = true;\r\n            break;\r\n        }\r\n      }\r\n    },\r\n\r\n    /* *** Column Separator *******************************************************************************************\r\n     */\r\n    colSepMouseDown(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      if (this.allowAddCol && !e.target.classList.contains(\"col-sep\")) {\r\n        e.target.style.display = \"none\";\r\n        const me = e.target.parentElement.parentElement;\r\n        const pos = Array.from(me.parentElement.children).findIndex(\r\n          (td) => td === me\r\n        );\r\n        this.insertColumn(pos);\r\n      }\r\n      this.focused = false;\r\n      const getStyleVal = (elm, css) => {\r\n        window.getComputedStyle(elm, null).getPropertyValue(css);\r\n      };\r\n      this.sep = {};\r\n      this.sep.curCol = this.colgroupTr.children[\r\n        Array.from(this.labelTr.children).indexOf(e.target.parentElement)\r\n      ];\r\n      // this.sep.nxtCol = this.sep.curCol.nextElementSibling\r\n      this.sep.pageX = e.pageX;\r\n      let padding = 0;\r\n      if (getStyleVal(this.sep.curCol, \"box-sizing\") !== \"border-box\") {\r\n        const padLeft = getStyleVal(this.sep.curCol, \"padding-left\");\r\n        const padRight = getStyleVal(this.sep.curCol, \"padding-right\");\r\n        if (padLeft && padRight)\r\n          padding = parseInt(padLeft) + parseInt(padRight);\r\n      }\r\n      this.sep.curColWidth = e.target.parentElement.offsetWidth - padding;\r\n      // if (this.sep.nxtCol)\r\n      //   this.sep.nxtColWidth = this.sep.nxtCol.offsetWidth - padding\r\n      window.addEventListener(\"mousemove\", this.colSepMouseMove);\r\n      window.addEventListener(\"mouseup\", this.colSepMouseUp);\r\n    },\r\n    colSepMouseOver(e) {\r\n      if (e.target.classList.contains(\"col-sep\")) {\r\n        e.target.style.borderRight = \"5px solid #cccccc\";\r\n        e.target.style.height =\r\n          this.systable.getBoundingClientRect().height + \"px\";\r\n        if (this.allowAddCol) e.target.children[0].style.display = \"block\";\r\n      } else {\r\n        // add-col-btn\r\n        if (this.addColBtnTimeout) clearTimeout(this.addColBtnTimeout);\r\n        if (this.allowAddCol) e.target.style.display = \"block\";\r\n      }\r\n    },\r\n    colSepMouseOut(e) {\r\n      if (e.target.classList.contains(\"col-sep\")) {\r\n        e.target.style.borderRight = \"5px solid transparent\";\r\n        e.target.style.height = \"100%\";\r\n        this.addColBtnTimeout = setTimeout(() => {\r\n          e.target.children[0].style.display = \"none\";\r\n        }, 500);\r\n      } else {\r\n        // add-col-btn\r\n        e.target.style.display = \"none\";\r\n      }\r\n    },\r\n    colSepMouseMove(e) {\r\n      if (!this.sep || !this.sep.curCol) return;\r\n      const diffX = e.pageX - this.sep.pageX;\r\n      this.sep.curCol.style.width = this.sep.curColWidth + diffX + \"px\";\r\n      this.lazy(this.calStickyLeft, 200);\r\n    },\r\n    colSepMouseUp(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      delete this.sep;\r\n      window.removeEventListener(\"mousemove\", this.colSepMouseMove);\r\n      window.removeEventListener(\"mouseup\", this.colSepMouseUp);\r\n      const setting = this.getSetting();\r\n      if (this.remember)\r\n        localStorage[\r\n          window.location.pathname + \".\" + this.token\r\n        ] = JSON.stringify(setting);\r\n      this.$emit(\"setting\", setting);\r\n    },\r\n\r\n    /* *** Finder *******************************************************************************************\r\n     */\r\n    doFindNext() {\r\n      return this.doFind();\r\n    },\r\n    doFind(s) {\r\n      if (typeof s === \"undefined\") s = this.inputFind;\r\n      else this.inputFind = s;\r\n      s = s.toUpperCase();\r\n      const row = Math.max(0, this.currentRowPos);\r\n      for (let r = row + this.pageTop; r < this.table.length; r++) {\r\n        const rec = this.table[r];\r\n        for (\r\n          let c = r === row + this.pageTop ? this.currentColPos + 1 : 0;\r\n          c < this.fields.length;\r\n          c++\r\n        ) {\r\n          const field = this.fields[c].name;\r\n          if (\r\n            typeof rec[field] !== \"undefined\" &&\r\n            String(rec[field])\r\n              .toUpperCase()\r\n              .indexOf(s) >= 0\r\n          ) {\r\n            this.pageTop = this.findPageTop(r);\r\n            setTimeout(() => {\r\n              this.moveInputSquare(r - this.pageTop, c);\r\n              setTimeout(() => this.inputBox.focus());\r\n              this.focused = true;\r\n            });\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      for (let r = 0; r <= row + this.pageTop; r++) {\r\n        const rec = this.table[r];\r\n        for (\r\n          let c = 0;\r\n          c <\r\n          (r === row + this.pageTop ? this.currentColPos : this.fields.length);\r\n          c++\r\n        ) {\r\n          const field = this.fields[c].name;\r\n          if (\r\n            typeof rec[field] !== \"undefined\" &&\r\n            String(rec[field])\r\n              .toUpperCase()\r\n              .indexOf(s) >= 0\r\n          ) {\r\n            this.pageTop = this.findPageTop(r);\r\n            this.moveInputSquare(r - this.pageTop, c);\r\n            setTimeout(() => {\r\n              this.focused = true;\r\n            });\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      return false;\r\n    },\r\n    findPageTop(rowPos) {\r\n      for (let pt = this.pageTop; pt < this.table.length; pt += this.pageSize)\r\n        if (rowPos >= pt && rowPos < pt + this.pageSize) return pt;\r\n      for (let pt = this.pageTop; pt > 0; pt -= this.pageSize)\r\n        if (rowPos >= pt && rowPos < pt + this.pageSize) return pt;\r\n      return this.pageTop;\r\n    },\r\n\r\n    /* *** Sort *******************************************************************************************\r\n     */\r\n    headerClick(e, colPos) {\r\n      if (!this.noHeaderEdit && e.target.tagName === \"SPAN\") {\r\n        e.target.contentEditable = true;\r\n        e.target.addEventListener(\"focusout\", this.completeHeaderChange);\r\n        return;\r\n      }\r\n      if (e.which === 1) {\r\n        e.preventDefault();\r\n        if (this.sortPos === colPos && this.sortDir > 0) this.sort(-1, colPos);\r\n        else this.sort(1, colPos);\r\n      }\r\n    },\r\n    completeHeaderChange(e) {\r\n      const th = e.target.parentElement.parentElement;\r\n      const index = Array.from(th.parentElement.children).findIndex(\r\n        (v) => v === th\r\n      );\r\n      this.fields[index - 1].label = e.target.textContent;\r\n    },\r\n    sort(n, pos) {\r\n      this.processing = true;\r\n      const colPos =\r\n        typeof pos === \"undefined\" ? this.columnFilterRef.colPos : pos;\r\n      const field = this.fields[colPos];\r\n      const name = field.name;\r\n      setTimeout(() => {\r\n        let sorting = field.sort;\r\n        if (sorting === null) {\r\n          if (field.type === \"number\")\r\n            sorting = (a, b) => {\r\n              if (Number(a[name]) > Number(b[name])) return 1;\r\n              if (Number(a[name]) < Number(b[name])) return -1;\r\n              return 0;\r\n            };\r\n          else\r\n            sorting = (a, b) => {\r\n              return String(a[name]).localeCompare(String(b[name]));\r\n            };\r\n        }\r\n        this.value.sort((a, b) => {\r\n          return sorting(a, b) * n;\r\n        });\r\n        this.sortPos = colPos;\r\n        this.sortDir = n;\r\n        this.$forceUpdate();\r\n        this.processing = false;\r\n      }, 0);\r\n    },\r\n\r\n    /* *** Paging *******************************************************************************************\r\n     */\r\n    refreshPageSize() {\r\n      if (this.$refs.hScroll) {\r\n        const fullWidth = this.systable.getBoundingClientRect().width;\r\n        const viewWidth = this.tableContent.getBoundingClientRect().width;\r\n        this.hScroller.tableUnseenWidth = fullWidth - viewWidth;\r\n        this.$refs.hScroll.style.width = (100 * viewWidth) / fullWidth + \"%\";\r\n        const scrollerWidth = this.$refs.hScroll.getBoundingClientRect().width;\r\n        this.hScroller.scrollerUnseenWidth =\r\n          this.footer.getBoundingClientRect().width - 40 - scrollerWidth;\r\n      }\r\n      if (!this.noPaging) {\r\n        const offset = this.summaryRow ? 60 : 35;\r\n        let controlHeight =\r\n          window.innerHeight -\r\n          this.recordBody.getBoundingClientRect().top -\r\n          offset;\r\n        const height =\r\n          this.height.replace(/px/, \"\") * 1 +\r\n          this.systable.getBoundingClientRect().top -\r\n          this.recordBody.getBoundingClientRect().top;\r\n        if (this.height && controlHeight > height) controlHeight = height;\r\n        this.pageSize = this.page || Math.floor(controlHeight / 24);\r\n        // this.pageSize = this.page || Math.floor((this.systable.parentNode.style.height - this.recordBody.getBoundingClientRect().top - offset) / 24)\r\n      } else if (this.height === \"auto\") {\r\n        let h = Math.floor(\r\n          window.innerHeight -\r\n            this.tableContent.getBoundingClientRect().top -\r\n            25\r\n        );\r\n        let offset = 4;\r\n        if (this.filterRow) offset += 29;\r\n        if (this.summaryRow) offset += 25;\r\n        if (!this.footerRow) offset += 25;\r\n        h = Math.min(24 * (this.table.length - this.pageTop) + offset, h);\r\n        this.systable.parentNode.style.height = h + \"px\";\r\n      }\r\n      setTimeout(this.calVScroll);\r\n    },\r\n    firstPage(e) {\r\n      if (e) e.stopPropagation();\r\n      this.pageTop = 0;\r\n      this.calVScroll();\r\n      if (this.$refs.vScrollButton) {\r\n        setTimeout(() => {\r\n          this.$refs.vScrollButton.classList.add(\"focus\");\r\n          this.lazy(() => {\r\n            if (!this.$refs.vScrollButton) return;\r\n            this.$refs.vScrollButton.classList.remove(\"focus\");\r\n          }, 1000);\r\n        });\r\n      }\r\n    },\r\n    lastPage(e) {\r\n      if (e) e.stopPropagation();\r\n      this.pageTop =\r\n        this.table.length - this.pageSize < 0\r\n          ? 0\r\n          : this.table.length - this.pageSize;\r\n      this.calVScroll();\r\n      if (this.$refs.vScrollButton) {\r\n        setTimeout(() => {\r\n          this.$refs.vScrollButton.classList.add(\"focus\");\r\n          this.lazy(() => {\r\n            if (!this.$refs.vScrollButton) return;\r\n            this.$refs.vScrollButton.classList.remove(\"focus\");\r\n          }, 1000);\r\n        });\r\n      }\r\n    },\r\n    prevPage(e) {\r\n      if (e) e.stopPropagation();\r\n      this.pageTop =\r\n        this.pageTop < this.pageSize ? 0 : this.pageTop - this.pageSize;\r\n      this.calVScroll();\r\n      if (this.$refs.vScrollButton) {\r\n        setTimeout(() => {\r\n          this.$refs.vScrollButton.classList.add(\"focus\");\r\n          this.lazy(() => {\r\n            if (!this.$refs.vScrollButton) return;\r\n            this.$refs.vScrollButton.classList.remove(\"focus\");\r\n          }, 1000);\r\n        });\r\n      }\r\n    },\r\n    nextPage(e) {\r\n      if (e) e.stopPropagation();\r\n      if (this.pageTop + this.pageSize < this.table.length)\r\n        this.pageTop = Math.min(\r\n          this.pageTop + this.pageSize,\r\n          this.table.length - this.pageSize\r\n        );\r\n      this.calVScroll();\r\n      if (this.$refs.vScrollButton) {\r\n        setTimeout(() => {\r\n          this.$refs.vScrollButton.classList.add(\"focus\");\r\n          this.lazy(() => {\r\n            if (!this.$refs.vScrollButton) return;\r\n            this.$refs.vScrollButton.classList.remove(\"focus\");\r\n          }, 1000);\r\n        });\r\n      }\r\n    },\r\n\r\n    /* *** Setting *******************************************************************************************\r\n     */\r\n    getSetting() {\r\n      const colWidth = Array.from(this.colgroupTr.children).map(\r\n        (col) => col.style.width\r\n      );\r\n      const fields = this.fields.map((field, i) => {\r\n        return {\r\n          name: field.name,\r\n          invisible: field.invisible,\r\n          width: colWidth[i + 1],\r\n          label: field.label,\r\n        };\r\n      });\r\n      return {\r\n        colHash: this.colHash,\r\n        fields: fields,\r\n      };\r\n    },\r\n\r\n    settingClick() {\r\n      if (!this.disablePanelSetting) this.$refs.panelSetting.showPanel();\r\n    },\r\n\r\n    panelFilterClick(item) {\r\n      if (!this.disablePanelFilter)\r\n        this.$refs.panelFilter.showPanel(this.$refs[`filter-${item.name}`][0]);\r\n    },\r\n\r\n    /* *** Import/Export ************************************************************************************\r\n     */\r\n    importTable(cb, errCb) {\r\n      this.$refs.importFile.click();\r\n      this.importCallback = cb;\r\n      this.importErrorCallback = errCb;\r\n    },\r\n    doImport(e) {\r\n      this.processing = true;\r\n      // this.refresh()\r\n      this.clearAllSelected();\r\n      setTimeout(() => {\r\n        const files = e.target.files;\r\n        if (!files || files.length === 0) return;\r\n        const file = files[0];\r\n\r\n        const fileReader = new FileReader();\r\n        fileReader.onload = async (e) => {\r\n          try {\r\n            const data = e.target.result;\r\n            const wb = XLSX.read(data, {\r\n              type: \"binary\",\r\n              cellDates: true,\r\n              cellStyle: false,\r\n            });\r\n            const sheet = wb.SheetNames[0];\r\n            let importData = XLSX.utils.sheet_to_row_object_array(\r\n              wb.Sheets[sheet]\r\n            );\r\n            importData = importData\r\n              .filter((rec) => Object.keys(rec).length > 0)\r\n              .map((rec) => {\r\n                if (rec.key_1) {\r\n                  rec.key = rec.key_1; // Fixed the XLSX issue where key is set to be reserved word\r\n                  delete rec.key_1;\r\n                }\r\n                Object.keys(rec).forEach((k) => {\r\n                  if (typeof rec[k] === \"string\")\r\n                    rec[k] = rec[k].replace(/[ \\r\\n\\t]+$/g, \"\");\r\n                });\r\n                return rec;\r\n              });\r\n            const keyStart = String(new Date().getTime() % 1e8);\r\n            if (importData.length === 0) {\r\n              if (this.importErrorCallback)\r\n                this.importErrorCallback(\"noRecordIsRead\");\r\n              throw new Error(\r\n                \"VueExcelEditor: \" + this.localizedLabel.noRecordIsRead\r\n              );\r\n            }\r\n            if (\r\n              this.fields\r\n                .filter((f) => f.keyField)\r\n                .filter(\r\n                  (f) =>\r\n                    typeof importData[0][f.name] === \"undefined\" &&\r\n                    typeof importData[0][f.label] === \"undefined\"\r\n                ).length > 0\r\n            ) {\r\n              if (this.importErrorCallback)\r\n                this.importErrorCallback(\"missingKeyColumn\");\r\n              throw new Error(\r\n                `VueExcelEditor: ${this.localizedLabel.missingKeyColumn}`\r\n              );\r\n            }\r\n\r\n            let pass = 0;\r\n            let inserted = 0;\r\n            let updated = 0;\r\n            while (pass < 2) {\r\n              const keys = this.fields.filter((f) => f.keyField);\r\n              let uniqueKeys = [];\r\n              await Promise.all(\r\n                importData.map(async (line, i) => {\r\n                  let rowPos = -1;\r\n                  if (keys.length) {\r\n                    // locate match record\r\n                    rowPos = this.table.findIndex(\r\n                      (v) =>\r\n                        keys.filter(\r\n                          (f) =>\r\n                            typeof v[f.name] !== \"undefined\" &&\r\n                            (v[f.name] === line[f.name] ||\r\n                              v[f.name] === line[f.label])\r\n                        ).length === keys.length\r\n                    );\r\n                    if (rowPos === -1) {\r\n                      // If this is a new line, avoid the line with duplicate key\r\n                      const linekey = keys\r\n                        .map((k) => line[k.name] || line[k.label])\r\n                        .join(\":\");\r\n                      if (linekey) {\r\n                        if (uniqueKeys.includes(linekey)) return;\r\n                        uniqueKeys.push(linekey);\r\n                      }\r\n                    }\r\n                  }\r\n\r\n                  // if no match found, find an empty record\r\n                  if (rowPos === -1)\r\n                    rowPos = this.table.findIndex(\r\n                      (v) =>\r\n                        Object.keys(v).filter((f) => !f.startsWith(\"$\"))\r\n                          .length === 0\r\n                    );\r\n\r\n                  const rec = {\r\n                    $id:\r\n                      typeof line.$id === \"undefined\"\r\n                        ? keyStart + \"-\" + (\"000000\" + i).slice(-7)\r\n                        : line.$id,\r\n                  };\r\n\r\n                  // Raise exception if readonly not not pass validation\r\n                  await Promise.all(\r\n                    this.fields.map(async (field) => {\r\n                      if (field.name.startsWith(\"$\")) return;\r\n                      let val = line[field.name];\r\n                      if (typeof val === \"undefined\") val = line[field.label];\r\n                      if (typeof val === \"undefined\") val = null;\r\n                      else {\r\n                        if (field.readonly) {\r\n                          if (this.importErrorCallback)\r\n                            this.importErrorCallback(\r\n                              \"readonlyColumnDetected\",\r\n                              i + 1\r\n                            );\r\n                          throw new Error(\r\n                            `VueExcelEditor: [row=${i + 1}] ` +\r\n                              this.localizedLabel.readonlyColumnDetected +\r\n                              \": \" +\r\n                              field.name\r\n                          );\r\n                        }\r\n                        if (field.change) {\r\n                          let result = await field.change(\r\n                            val,\r\n                            rec[field.name],\r\n                            rec,\r\n                            field\r\n                          );\r\n                          if (result === false) {\r\n                            if (this.importErrorCallback)\r\n                              this.importErrorCallback(\r\n                                \"columnHasValidationError\",\r\n                                i + 1\r\n                              );\r\n                            throw new Error(\r\n                              `VueExcelEditor: [row=${i + 1}, val=${val}] ` +\r\n                                this.localizedLabel.columnHasValidationError(\r\n                                  field.name,\r\n                                  \"\"\r\n                                )\r\n                            );\r\n                          }\r\n                        }\r\n                        if (field.validate) {\r\n                          let err;\r\n                          if (\r\n                            (err = field.validate(\r\n                              val,\r\n                              rec[field.name],\r\n                              rec,\r\n                              field\r\n                            ))\r\n                          ) {\r\n                            if (this.importErrorCallback)\r\n                              this.importErrorCallback(\r\n                                \"columnHasValidationError\",\r\n                                i + 1,\r\n                                val\r\n                              );\r\n                            throw new Error(\r\n                              `VueExcelEditor: [row=${i + 1}, val=${val}] ` +\r\n                                this.localizedLabel.columnHasValidationError(\r\n                                  field.name,\r\n                                  err\r\n                                )\r\n                            );\r\n                          }\r\n                        }\r\n                        if (this.validate) {\r\n                          let err;\r\n                          if (\r\n                            (err = this.validate(\r\n                              val,\r\n                              rec[field.name],\r\n                              rec,\r\n                              field\r\n                            ))\r\n                          ) {\r\n                            if (this.importErrorCallback)\r\n                              this.importErrorCallback(\r\n                                \"rowHasValidationError\",\r\n                                i + 1,\r\n                                val\r\n                              );\r\n                            throw new Error(\r\n                              `VueExcelEditor: [row=${i + 1}, val=${val}] ` +\r\n                                this.localizedLabel.rowHasValidationError(\r\n                                  i + 1,\r\n                                  field.name,\r\n                                  err\r\n                                )\r\n                            );\r\n                          }\r\n                        }\r\n                      }\r\n                      if (val !== null) rec[field.name] = val;\r\n                      else if (field.mandatory) {\r\n                        if (this.importErrorCallback)\r\n                          this.importErrorCallback(field.mandatory, i + 1, val);\r\n                        throw new Error(\r\n                          `VueExcelEdutor: [row=${i + 1}, val=${val}] ` +\r\n                            field.mandatory\r\n                        );\r\n                      }\r\n                    })\r\n                  );\r\n\r\n                  // Do actual insert/update if 2nd pass\r\n                  if (pass === 1) {\r\n                    if (rowPos >= 0) {\r\n                      updated++;\r\n                      Object.keys(rec).forEach((name) => {\r\n                        if (name.startsWith(\"$\")) return;\r\n                        this.updateCell(rowPos, name, rec[name]);\r\n                      });\r\n                      this.selected[rowPos] = this.table[rowPos].$id;\r\n                    } else {\r\n                      this.newRecord(rec, true);\r\n                      inserted++;\r\n                    }\r\n                  }\r\n                })\r\n              );\r\n              pass++;\r\n            }\r\n            if (pass === 2 && this.importCallback) {\r\n              this.importCallback({\r\n                inserted: inserted,\r\n                updated: updated,\r\n                recordAffected: inserted + updated,\r\n              });\r\n            }\r\n          } catch (e) {\r\n            if (this.importErrorCallback) this.importErrorCallback(e.message);\r\n            throw new Error(\"VueExcelEditor: \" + e.stack);\r\n          } finally {\r\n            this.processing = false;\r\n            this.$refs.importFile.value = \"\";\r\n          }\r\n        };\r\n        fileReader.onerror = (e) => {\r\n          this.processing = false;\r\n          this.$refs.importFile.value = \"\";\r\n          if (this.importErrorCallback) this.importErrorCallback(e.message);\r\n          throw new Error(\"VueExcelEditor: \" + e.stack);\r\n        };\r\n        fileReader.readAsBinaryString(file);\r\n      }, 500);\r\n    },\r\n    exportTable(format, selectedOnly, filename) {\r\n      this.processing = true;\r\n      setTimeout(() => {\r\n        const wb = XLSX.utils.book_new();\r\n        let ws1 = null;\r\n        let data = this.table;\r\n        if (selectedOnly)\r\n          data = this.table.filter((rec, i) => this.selected[i]);\r\n        const mapped = data.map((rec) => {\r\n          const conv = {};\r\n          this.fields.forEach((field) => (conv[field.name] = rec[field.name]));\r\n          return conv;\r\n        });\r\n        ws1 = XLSX.utils.json_to_sheet(mapped, {\r\n          header: this.fields.map((field) => field.name),\r\n        });\r\n        const labels = Array.from(this.labelTr.children)\r\n          .slice(1)\r\n          .map((t) => t.children[0].innerText);\r\n        XLSX.utils.sheet_add_aoa(ws1, [labels], { origin: 0 });\r\n        ws1[\"!cols\"] = Array.from(this.labelTr.children)\r\n          .slice(1)\r\n          .map((t) => {\r\n            return {\r\n              width: t.getBoundingClientRect().width / 6.5,\r\n            };\r\n          });\r\n        XLSX.utils.book_append_sheet(wb, ws1, \"Sheet1\");\r\n        filename = filename || \"export\";\r\n        switch (format) {\r\n          case \"csv\":\r\n            if (!filename.endsWith(\".csv\")) filename = filename + \".csv\";\r\n            break;\r\n          case \"xls\":\r\n            if (!filename.endsWith(\".xls\")) filename = filename + \".xls\";\r\n            break;\r\n          case \"xlsx\":\r\n          case \"excel\":\r\n          default:\r\n            if (!filename.endsWith(\".xlsx\")) filename = filename + \".xlsx\";\r\n            break;\r\n        }\r\n        if (filename.endsWith(\".xlsx\"))\r\n          XLSX.writeFile(wb, filename, {\r\n            compression: \"DEFLATE\",\r\n            compressionOptions: {\r\n              level: 6,\r\n            },\r\n          });\r\n        else XLSX.writeFile(wb, filename);\r\n\r\n        this.processing = false;\r\n      }, 500);\r\n    },\r\n\r\n    /* *** Select *******************************************************************************************\r\n     */\r\n    getSelectedRecords() {\r\n      return this.table.filter((rec, i) => this.selected[i]);\r\n    },\r\n    /*\r\n    deleteSelectedRecords () {\r\n      this.table = this.table.filter((rec, i) => typeof this.selected[i] === 'undefined')\r\n      this.selected = {}\r\n      this.selectedCount = 0\r\n    },\r\n    */\r\n    rowLabelClick(e) {\r\n      let target = e.target;\r\n      while (target.tagName !== \"TD\") target = target.parentNode;\r\n      const rowPos = Number(target.getAttribute(\"pos\")) + this.pageTop;\r\n      if (e.shiftKey) {\r\n        document.getSelection().removeAllRanges();\r\n        if (this.prevSelect !== -1 && this.prevSelect !== rowPos) {\r\n          e.preventDefault();\r\n          if (rowPos > this.prevSelect)\r\n            for (let i = this.prevSelect; i <= rowPos; i++)\r\n              this.selectRecord(i);\r\n          else\r\n            for (let i = rowPos; i <= this.prevSelect; i++)\r\n              this.selectRecord(i);\r\n        }\r\n      } else {\r\n        const selected = this.selected[rowPos];\r\n        if (!this.freeSelect && !(e.ctrlKey || e.metaKey))\r\n          this.clearAllSelected();\r\n        if (!selected) this.selectRecord(rowPos);\r\n        else this.unSelectRecord(rowPos);\r\n      }\r\n      this.prevSelect = rowPos;\r\n    },\r\n    selectAllClick() {\r\n      this.toggleSelectAllRecords();\r\n    },\r\n    reviseSelectedAfterTableChange() {\r\n      this.rowIndex = {};\r\n      this.table.forEach((rec, i) => (this.rowIndex[rec.$id] = i));\r\n      const temp = Object.assign(this.selected);\r\n      this.selected = {};\r\n      Object.keys(temp).forEach((p) => {\r\n        const id = temp[p];\r\n        if (typeof this.rowIndex[id] !== \"undefined\")\r\n          this.selected[this.rowIndex[id]] = id;\r\n      });\r\n      this.selectedCount = Object.keys(this.selected).length;\r\n    },\r\n    toggleSelectRecord(rowPos) {\r\n      if (typeof this.selected[rowPos] !== \"undefined\")\r\n        this.unSelectRecord(rowPos);\r\n      else this.selectRecord(rowPos);\r\n    },\r\n    selectRecord(rowPos) {\r\n      if (typeof this.selected[rowPos] === \"undefined\") {\r\n        this.selectedCount++;\r\n        this.selected[rowPos] = this.table[rowPos].$id;\r\n        if (this.recordBody.children[rowPos - this.pageTop])\r\n          this.recordBody.children[rowPos - this.pageTop].classList.add(\r\n            \"select\"\r\n          );\r\n        this.lazy(rowPos, (buf) => {\r\n          this.$emit(\"select\", buf, true);\r\n        });\r\n      }\r\n    },\r\n    selectRecordByKeys(keys) {\r\n      const rowPos = this.table.findIndex(\r\n        (v) =>\r\n          this.fields\r\n            .filter((f) => f.keyField)\r\n            .filter((f) => v[f.name] === keys[f.name]).length === keys.length\r\n      );\r\n      if (rowPos >= 0) this.selectRecord(rowPos);\r\n    },\r\n    selectRecordById(id) {\r\n      const rowPos = this.table.findIndex((v) => v.$id === id);\r\n      if (rowPos >= 0) this.selectRecord(rowPos);\r\n    },\r\n    unSelectRecord(rowPos) {\r\n      if (typeof this.selected[rowPos] !== \"undefined\") {\r\n        delete this.selected[rowPos];\r\n        this.selectedCount--;\r\n        if (this.recordBody.children[rowPos - this.pageTop])\r\n          this.recordBody.children[rowPos - this.pageTop].classList.remove(\r\n            \"select\"\r\n          );\r\n        this.lazy(rowPos, (buf) => {\r\n          this.$emit(\"select\", buf, false);\r\n        });\r\n      }\r\n    },\r\n    toggleSelectAllRecords(e) {\r\n      if (e) e.preventDefault();\r\n      if (this.selectedCount > 0) this.clearAllSelected();\r\n      else {\r\n        for (let i = 0; i < this.table.length; i++) this.selectRecord(i);\r\n        this.selectedCount = this.table.length;\r\n      }\r\n    },\r\n    clearAllSelected() {\r\n      // for (let i = 0; i < this.$refs.systable.children[2].children.length; i++)\r\n      //  this.unSelectRecord(this.pageTop + i)\r\n      if (this.selectedCount > 0)\r\n        this.$emit(\r\n          \"select\",\r\n          Object.keys(this.selected).map((rowPos) => Number(rowPos)),\r\n          false\r\n        );\r\n      this.selected = {};\r\n      this.selectedCount = 0;\r\n    },\r\n\r\n    /* *** Cursor *******************************************************************************************\r\n     */\r\n    moveTo(rowPos, colPos) {\r\n      colPos = colPos || 0;\r\n      const done = this.moveInputSquare(rowPos - this.pageTop, colPos);\r\n      this.focused = true;\r\n      setTimeout(() => this.inputBox.focus());\r\n      return done;\r\n    },\r\n    moveToNorthWest() {\r\n      let goColPos = 0;\r\n      while (\r\n        this.fields[goColPos].invisible &&\r\n        goColPos < this.fields.length - 1\r\n      )\r\n        goColPos++;\r\n      return this.moveTo(0, goColPos);\r\n    },\r\n    moveToNorthEast() {\r\n      let goColPos = this.fields.length - 1;\r\n      while (this.fields[goColPos].invisible && goColPos > 0) goColPos--;\r\n      return this.moveTo(0, goColPos);\r\n    },\r\n    moveToSouthWest() {\r\n      let goRowPos = this.table.length - 1;\r\n      let goColPos = 0;\r\n      while (\r\n        this.fields[goColPos].invisible &&\r\n        goColPos < this.fields.length - 1\r\n      )\r\n        goColPos++;\r\n      return this.moveTo(goRowPos, goColPos);\r\n    },\r\n    moveToSouthEast() {\r\n      let goRowPos = this.table.length - 1;\r\n      let goColPos = this.fields.length - 1;\r\n      while (this.fields[goColPos].invisible && goColPos > 0) goColPos--;\r\n      return this.moveTo(goRowPos, goColPos);\r\n    },\r\n    moveToWest() {\r\n      let goRowPos = this.currentRowPos;\r\n      let goColPos = 0;\r\n      while (\r\n        this.fields[goColPos].invisible &&\r\n        goColPos < this.fields.length - 1\r\n      )\r\n        goColPos++;\r\n      return this.moveTo(goRowPos, goColPos);\r\n    },\r\n    moveToEast() {\r\n      let goRowPos = this.currentRowPos;\r\n      let goColPos = this.fields.length - 1;\r\n      while (this.fields[goColPos].invisible && goColPos > 0) goColPos--;\r\n      return this.moveTo(goRowPos, goColPos);\r\n    },\r\n    moveWest() {\r\n      if (this.focused && this.currentColPos > 0) {\r\n        let goColPos = this.currentColPos - 1;\r\n        while (this.fields[goColPos].invisible && goColPos > 0) goColPos--;\r\n        if (goColPos === -1 || this.fields[goColPos].invisible) return false;\r\n        return this.moveInputSquare(this.currentRowPos, goColPos);\r\n      }\r\n      return false;\r\n    },\r\n    moveEast() {\r\n      if (this.focused && this.currentColPos < this.fields.length - 1) {\r\n        let goColPos = this.currentColPos + 1;\r\n        while (\r\n          this.fields[goColPos].invisible &&\r\n          goColPos < this.fields.length - 1\r\n        )\r\n          goColPos++;\r\n        if (goColPos === this.fields.length || this.fields[goColPos].invisible)\r\n          return false;\r\n        return this.moveInputSquare(this.currentRowPos, goColPos);\r\n      }\r\n      return false;\r\n    },\r\n    moveNorth() {\r\n      if (this.focused) {\r\n        const done = this.moveInputSquare(\r\n          this.currentRowPos - 1,\r\n          this.currentColPos\r\n        );\r\n        this.calVScroll();\r\n        if (this.$refs.vScrollButton) {\r\n          setTimeout(() => {\r\n            this.$refs.vScrollButton.classList.add(\"focus\");\r\n            this.lazy(() => {\r\n              if (!this.$refs.vScrollButton) return;\r\n              this.$refs.vScrollButton.classList.remove(\"focus\");\r\n            }, 1000);\r\n          });\r\n        }\r\n        return done;\r\n      }\r\n      return false;\r\n    },\r\n    moveSouth() {\r\n      if (this.focused) {\r\n        if (this.currentRowPos + 1 >= this.table.length) {\r\n          if (this.readonly) return false;\r\n          if (!this.newIfBottom) return false;\r\n          this.newRecord({}, false, true);\r\n          setTimeout(this.moveSouth, 0);\r\n          return true;\r\n        }\r\n        const done = this.moveInputSquare(\r\n          this.currentRowPos + 1,\r\n          this.currentColPos\r\n        );\r\n        this.calVScroll();\r\n        if (this.$refs.vScrollButton) {\r\n          setTimeout(() => {\r\n            this.$refs.vScrollButton.classList.add(\"focus\");\r\n            this.lazy(() => {\r\n              if (!this.$refs.vScrollButton) return;\r\n              this.$refs.vScrollButton.classList.remove(\"focus\");\r\n            }, 1000);\r\n          });\r\n        }\r\n        return done;\r\n      }\r\n      return false;\r\n    },\r\n    mouseDown(e) {\r\n      if (\r\n        e.target.parentNode.parentNode.tagName === \"TBODY\" &&\r\n        !e.target.classList.contains(\"first-col\")\r\n      ) {\r\n        e.preventDefault();\r\n        setTimeout(() => this.inputBox.focus());\r\n        this.focused = true;\r\n        const row = e.target.parentNode;\r\n        const colPos = Array.from(row.children).indexOf(e.target) - 1;\r\n        const rowPos = Array.from(row.parentNode.children).indexOf(row);\r\n        this.$emit(\"cell-click\", { rowPos, colPos });\r\n        this.moveInputSquare(rowPos, colPos);\r\n        if (this.currentField && this.currentField.link && e.altKey)\r\n          setTimeout(() =>\r\n            this.currentField.link(\r\n              this.currentCell.textContent,\r\n              this.currentRecord,\r\n              rowPos,\r\n              colPos,\r\n              this.currentField,\r\n              this\r\n            )\r\n          );\r\n        if (e.target.offsetWidth - e.offsetX > 15) return;\r\n        if (this.currentField.readonly) return;\r\n        this.inputBox.value = this.currentCell.textContent;\r\n        if (e.target.classList.contains(\"select\"))\r\n          this.calAutocompleteList(true);\r\n        if (e.target.classList.contains(\"datepick\")) this.showDatePickerDiv();\r\n      }\r\n    },\r\n    cellMouseMove(e) {\r\n      let cursor = \"cell\";\r\n      if (this.inputBoxShow) cursor = \"default\";\r\n      if (\r\n        !e.target.classList.contains(\"readonly\") &&\r\n        (e.target.classList.contains(\"select\") ||\r\n          e.target.classList.contains(\"datepick\")) &&\r\n        e.target.offsetWidth - e.offsetX < 15\r\n      )\r\n        cursor = \"pointer\";\r\n      e.target.style.cursor = cursor;\r\n    },\r\n    cellMouseOver(e) {\r\n      const cell = e.target;\r\n      if (!cell.classList.contains(\"error\")) return;\r\n      if (this.tipTimeout) clearTimeout(this.tipTimeout);\r\n      if ((this.tip = this.errmsg[cell.getAttribute(\"id\")]) === \"\") return;\r\n      const rect = cell.getBoundingClientRect();\r\n      this.$refs.tooltip.style.top = rect.top - 14 + \"px\";\r\n      this.$refs.tooltip.style.left = rect.right + 8 + \"px\";\r\n      cell.addEventListener(\"mouseout\", this.cellMouseOut);\r\n    },\r\n    numcolMouseOver(e) {\r\n      const cell = e.target;\r\n      if (!cell.classList.contains(\"error\")) return;\r\n      if (this.tipTimeout) clearTimeout(this.tipTimeout);\r\n      if ((this.tip = this.rowerr[cell.getAttribute(\"id\")]) === \"\") return;\r\n      const rect = cell.getBoundingClientRect();\r\n      this.$refs.tooltip.style.top = rect.top - 14 + \"px\";\r\n      this.$refs.tooltip.style.left = rect.right + 8 + \"px\";\r\n      cell.addEventListener(\"mouseout\", this.cellMouseOut);\r\n    },\r\n    cellMouseOut(e) {\r\n      this.tipTimeout = setTimeout(() => {\r\n        this.tip = \"\";\r\n      }, 1000);\r\n      e.target.removeEventListener(e.type, this.cellMouseOut);\r\n    },\r\n    mouseOver() {\r\n      this.mousein = true;\r\n      this.systable.classList.add(\"mouseover\");\r\n    },\r\n    mouseOut() {\r\n      this.mousein = false;\r\n      this.systable.classList.remove(\"mouseover\");\r\n    },\r\n\r\n    /* *** InputBox *****************************************************************************************\r\n     */\r\n    moveInputSquare(rowPos, colPos) {\r\n      if (colPos < 0) return false;\r\n      const top = this.pageTop;\r\n      let row = this.recordBody.children[rowPos];\r\n      if (!row) {\r\n        if (rowPos > this.currentRowPos) {\r\n          // move the whole page down 1 record\r\n          if (this.pageTop + this.pageSize < this.table.length)\r\n            this.pageTop += 1;\r\n          else return false;\r\n          row = this.recordBody.children[--rowPos];\r\n        } else {\r\n          // move the whole page up 1 record\r\n          if (this.pageTop - 1 >= 0) this.pageTop -= 1;\r\n          else return false;\r\n          row = this.recordBody.children[++rowPos];\r\n        }\r\n      }\r\n\r\n      // Clear the label markers\r\n      this.labelTr.children[this.currentColPos + 1].classList.remove(\"focus\");\r\n      if (\r\n        this.currentRowPos >= 0 &&\r\n        this.currentRowPos < this.pagingTable.length\r\n      )\r\n        this.recordBody.children[\r\n          this.currentRowPos\r\n        ].children[0].classList.remove(\"focus\");\r\n\r\n      // Off the textarea when moving, write to value if changed\r\n      if (this.inputBoxShow) this.inputBoxShow = 0;\r\n      if (this.inputBoxChanged) {\r\n        this.inputCellWrite(\r\n          this.inputBox.value,\r\n          this.currentColPos,\r\n          top + this.currentRowPos\r\n        );\r\n        this.inputBoxChanged = false;\r\n      }\r\n\r\n      // Relocate the inputSquare\r\n      const cell = row.children[colPos + 1];\r\n      if (!cell) return false;\r\n      this.currentField = this.fields[colPos];\r\n      const cellRect = cell.getBoundingClientRect();\r\n      const tableRect = this.systable.getBoundingClientRect();\r\n      this.squareSavedLeft = this.tableContent.scrollLeft;\r\n      this.inputSquare.style.marginLeft = 0;\r\n      this.inputSquare.style.left = cellRect.left - tableRect.left - 1 + \"px\";\r\n      this.inputSquare.style.top = cellRect.top - tableRect.top - 1 + \"px\";\r\n      this.inputSquare.style.width = cellRect.width + 1 + \"px\";\r\n      this.inputSquare.style.height = cellRect.height + 1 + \"px\";\r\n      this.inputSquare.style.zIndex = this.currentField.sticky ? 3 : 1;\r\n\r\n      // Adjust the scrolling to display the whole focusing cell\r\n      if (!this.currentField.sticky) {\r\n        const boundRect = this.$el.getBoundingClientRect();\r\n        if (cellRect.right >= boundRect.right - 12)\r\n          this.tableContent.scrollBy(cellRect.right - boundRect.right + 13, 0);\r\n        if (cellRect.left <= boundRect.left + this.leftMost)\r\n          this.tableContent.scrollBy(\r\n            cellRect.left - boundRect.left - this.leftMost - 1,\r\n            0\r\n          );\r\n      }\r\n\r\n      this.currentRowPos = rowPos;\r\n      this.currentColPos = colPos;\r\n      this.currentCell = cell;\r\n      this.currentRecord = this.table[top + rowPos];\r\n\r\n      this.$emit(\"cell-focus\", {\r\n        rowPos,\r\n        colPos,\r\n        cell,\r\n        record: this.currentRecord,\r\n      });\r\n\r\n      // Off all editors\r\n      if (this.showDatePicker) this.showDatePicker = false;\r\n      if (this.autocompleteInputs.length) {\r\n        this.autocompleteInputs = [];\r\n        this.autocompleteSelect = -1;\r\n      }\r\n      if (this.recalAutoCompleteList) clearTimeout(this.recalAutoCompleteList);\r\n\r\n      // set the label markers\r\n      if (\r\n        this.currentRowPos >= 0 &&\r\n        this.currentRowPos < this.pagingTable.length\r\n      ) {\r\n        this.inputBox.value = this.currentCell.textContent;\r\n        this.inputBox.focus();\r\n        this.focused = true;\r\n        row.children[0].classList.add(\"focus\");\r\n        this.labelTr.children[colPos + 1].classList.add(\"focus\");\r\n      }\r\n      return true;\r\n    },\r\n    inputSquareClick() {\r\n      if (\r\n        !this.currentField.readonly &&\r\n        !this.inputBoxShow &&\r\n        this.currentField.type !== \"select\"\r\n      ) {\r\n        this.inputBox.value = this.currentCell.textContent;\r\n        this.inputBoxShow = 1;\r\n        this.inputBox.focus();\r\n        this.inputBoxChanged = false;\r\n        this.focused = true;\r\n      }\r\n    },\r\n    inputBoxMouseMove(e) {\r\n      let cursor = \"text\";\r\n      if (\r\n        !this.currentField.readonly &&\r\n        (this.currentField.options || this.currentField.type === \"date\") &&\r\n        e.target.offsetWidth - e.offsetX < 15\r\n      )\r\n        cursor = \"pointer\";\r\n      e.target.style.cursor = cursor;\r\n    },\r\n    inputBoxMouseDown(e) {\r\n      if (e.target.offsetWidth - e.offsetX > 15) return;\r\n      if (this.currentField.readonly) return;\r\n      if (this.currentField.options) {\r\n        e.preventDefault();\r\n        this.calAutocompleteList(true);\r\n      }\r\n      if (this.currentField.type === \"date\") {\r\n        e.preventDefault();\r\n        this.showDatePickerDiv();\r\n      }\r\n    },\r\n    inputCellWrite(setText, colPos, recPos) {\r\n      let field = this.currentField;\r\n      if (typeof colPos !== \"undefined\") field = this.fields[colPos];\r\n      if (typeof recPos === \"undefined\")\r\n        recPos = this.pageTop + this.currentRowPos;\r\n      if (typeof this.selected[recPos] !== \"undefined\")\r\n        this.updateSelectedRows(field, field.toValue(setText));\r\n      else this.updateCell(recPos, field, field.toValue(setText));\r\n    },\r\n    inputBoxBlur() {\r\n      if (!this.$refs.dpContainer) return;\r\n      if (this.$refs.dpContainer.querySelector(\":hover\")) return;\r\n      this.inputBoxComplete();\r\n      this.focused = false;\r\n      if (\r\n        this.currentRowPos !== -1 &&\r\n        this.currentRowPos < this.recordBody.children.length\r\n      ) {\r\n        this.recordBody.children[\r\n          this.currentRowPos\r\n        ].children[0].classList.remove(\"focus\");\r\n        this.labelTr.children[this.currentColPos + 1].classList.remove(\"focus\");\r\n      }\r\n    },\r\n    inputBoxComplete() {\r\n      if (this.inputBoxChanged) {\r\n        this.inputCellWrite(this.inputBox.value);\r\n        this.inputBoxChanged = false;\r\n      }\r\n      this.inputBoxShow = 0;\r\n      this.showDatePicker = false;\r\n      // Without this, the cell cannot refresh, dont know why\r\n      this.focused = false;\r\n      this.focused = true;\r\n    },\r\n\r\n    /* *** Update *******************************************************************************************\r\n     */\r\n    undoTransaction(e) {\r\n      if (e) e.preventDefault();\r\n      if (this.redo.length === 0) return;\r\n      const transaction = this.redo.pop();\r\n      transaction.every((t) => {\r\n        try {\r\n          if (t.type === \"d\") {\r\n            // deleteRecord() transaction\r\n            this.newRecord(t.rec, false, true, true);\r\n          } else if (\r\n            t.field &&\r\n            t.field.keyField &&\r\n            t.oldKeys.includes(t.newVal)\r\n          ) {\r\n            // newRecord() transaction\r\n            const valueRowPos = this.value.findIndex((v) => v.$id === t.$id);\r\n            if (valueRowPos >= 0) {\r\n              this.deleteRecord(valueRowPos, true);\r\n              // return false\r\n            }\r\n          } else this.updateCell(t.$id, t.field.name, t.oldVal, true);\r\n\r\n          return true;\r\n        } catch (e) {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    newRecord(rec, selectAfterDone, noLastPage, isUndo) {\r\n      if (typeof rec === \"undefined\") rec = {};\r\n      this.fields.map((f) => {\r\n        if (typeof rec[f.name] === \"undefined\") {\r\n          if (f.keyField) rec[f.name] = \"\xA7\" + this.tempKey();\r\n          else rec[f.name] = null;\r\n        }\r\n      });\r\n      const id = rec.$id || this.tempKey();\r\n      rec.$id = id;\r\n      this.value.push(rec);\r\n      const rowPos = this.table.push(rec) - 1;\r\n      if (selectAfterDone) this.selected[rowPos] = id;\r\n      Object.keys(rec).forEach((name) => {\r\n        const field = this.fields.find((f) => f.name === name);\r\n        if (field) this.updateCell(rec, field, rec[name], isUndo);\r\n      });\r\n      // this.refresh()\r\n      if (!noLastPage)\r\n        this.lazy(() => {\r\n          this.lastPage();\r\n          this.moveToSouthWest();\r\n        });\r\n      return rec;\r\n    },\r\n    deleteSelectedRecords() {\r\n      Object.values(this.selected).forEach((id) => {\r\n        const valueRowPos = this.value.findIndex((v) => v.$id === id);\r\n        if (valueRowPos >= 0) this.deleteRecord(valueRowPos);\r\n      });\r\n      this.selected = {};\r\n      this.selectedCount = 0;\r\n    },\r\n    deleteRecord(valueRowPos, isUndo) {\r\n      if (this.currentRowPos === valueRowPos) this.moveNorth();\r\n      const rec = this.value.splice(valueRowPos, 1)[0];\r\n      setTimeout(() => {\r\n        this.lazy(rec, (buf) => {\r\n          this.$emit(\"delete\", buf);\r\n          if (!isUndo)\r\n            this.redo.push(\r\n              buf.map((t) => ({\r\n                type: \"d\",\r\n                rec: t,\r\n              }))\r\n            );\r\n        });\r\n      }, 100);\r\n    },\r\n    async updateCell(row, field, newVal, isUndo) {\r\n      switch (row.constructor.name) {\r\n        case \"String\": // $id\r\n          row = this.value.find((r) => r.$id === row); // id\r\n          break;\r\n        case \"Number\":\r\n          row = this.table[row]; // tablePos\r\n          break;\r\n        case \"Object\": // record object\r\n          break;\r\n        default:\r\n          throw new Error(\"Invalid row argument type\");\r\n      }\r\n      switch (field.constructor.name) {\r\n        case \"String\": // field name\r\n          field = this.fields.find((f) => f.name === field);\r\n          break;\r\n        case \"Number\": // field pos\r\n          field = this.fields[field];\r\n          break;\r\n        case \"Object\": // field object\r\n          break;\r\n        default:\r\n          throw new Error(\"Invalid field argument type\");\r\n      }\r\n      if (!field) throw new Error(\"Invalid field argument\");\r\n      if (!row) return; // No row is found\r\n\r\n      const oldVal = row[field.name];\r\n      const oldKeys = this.getKeys(row);\r\n\r\n      if (field.change) {\r\n        let result = await field.change(newVal, oldVal, row, field);\r\n        if (result === false) return;\r\n      }\r\n\r\n      row[field.name] = newVal;\r\n\r\n      setTimeout(() => {\r\n        const transaction = {\r\n          $id: row.$id,\r\n          keys: this.getKeys(row),\r\n          oldKeys: oldKeys,\r\n          name: field.name,\r\n          field: field,\r\n          oldVal: typeof oldVal !== \"undefined\" ? oldVal : \"\",\r\n          newVal: newVal,\r\n          err: \"\",\r\n        };\r\n\r\n        const id = `id-${row.$id}-${field.name}`;\r\n        if (field.validate !== null)\r\n          transaction.err = field.validate(newVal, oldVal, row, field);\r\n        if (field.mandatory && newVal === \"\")\r\n          transaction.err += (transaction.err ? \"\\n\" : \"\") + field.mandatory;\r\n\r\n        if (transaction.err) {\r\n          this.errmsg[id] = transaction.err;\r\n          const selector = this.systable.querySelector(\"td#\" + id);\r\n          if (selector) selector.classList.add(\"error\");\r\n        } else if (this.errmsg[id]) {\r\n          delete this.errmsg[id];\r\n          const selector = this.systable.querySelector(\"td#\" + id);\r\n          if (selector) selector.classList.remove(\"error\");\r\n        }\r\n\r\n        if (this.validate !== null) {\r\n          const rid = `rid-${row.$id}`;\r\n          transaction.rowerr = this.validate(newVal, oldVal, row, field);\r\n          if (transaction.rowerr) {\r\n            this.rowerr[rid] = transaction.rowerr;\r\n            const selector = this.systable.querySelector(\"td#\" + rid);\r\n            if (selector) selector.classList.add(\"error\");\r\n          } else if (this.rowerr[rid]) {\r\n            delete this.rowerr[rid];\r\n            const selector = this.systable.querySelector(\"td#\" + rid);\r\n            if (selector) selector.classList.remove(\"error\");\r\n          }\r\n        }\r\n\r\n        if (field.summary) this.calSummary(field.name);\r\n\r\n        this.lazy(\r\n          transaction,\r\n          (buf) => {\r\n            this.$emit(\"update\", buf);\r\n            if (!isUndo) this.redo.push(buf);\r\n          },\r\n          50\r\n        );\r\n      });\r\n    },\r\n    updateSelectedRows(field, content) {\r\n      this.processing = true;\r\n      setTimeout(() => {\r\n        Object.keys(this.selected).forEach((recPos) =>\r\n          this.updateCell(parseInt(recPos), field, content)\r\n        );\r\n        this.processing = false;\r\n      }, 0);\r\n    },\r\n\r\n    /* *** Autocomplete ****************************************************************************************\r\n     */\r\n    async calAutocompleteList(force) {\r\n      if (!force && !this.currentField.autocomplete) return;\r\n      if (force || (this.inputBoxChanged && this.inputBox.value.length > 0)) {\r\n        if (typeof this.recalAutoCompleteList !== \"undefined\")\r\n          clearTimeout(this.recalAutoCompleteList);\r\n        const doList = async () => {\r\n          if (!force) {\r\n            if (\r\n              !this.focused ||\r\n              !this.inputBoxShow ||\r\n              !this.inputBoxChanged ||\r\n              !this.inputBox.value.length\r\n            ) {\r\n              this.autocompleteInputs = [];\r\n              return;\r\n            }\r\n          }\r\n          const field = this.currentField;\r\n          const name = field.name;\r\n          const value = this.inputBox.value.toUpperCase();\r\n          const listCount = this.autocompleteCount;\r\n          let list = [];\r\n          if (field.options) {\r\n            if (field.options.constructor.name.endsWith(\"Function\")) {\r\n              list = await field.options(value, this.currentRecord);\r\n              if (field.type === \"map\") list = Object.values(list);\r\n              else list = list.slice();\r\n              if (this.inputBoxShow)\r\n                list = list.filter((element) =>\r\n                  element.toUpperCase().includes(value)\r\n                );\r\n              list.sort().splice(listCount);\r\n              // this.autocompleteSelect = list.findIndex(element => element.toUpperCase().includes(value))\r\n            } else if (Object.values(field.options).length > 0) {\r\n              list = field.options;\r\n              if (field.type === \"map\") list = Object.values(list);\r\n              else list = list.slice();\r\n              if (this.inputBoxShow)\r\n                list = list.filter((element) =>\r\n                  element.toUpperCase().includes(value)\r\n                );\r\n              list.sort().splice(listCount);\r\n              // this.autocompleteSelect = list.findIndex(element => element.toUpperCase().includes(value))\r\n            }\r\n          } else {\r\n            for (let i = 0; i < this.value.length; i++) {\r\n              const rec = this.value[i];\r\n              if (\r\n                typeof rec[name] !== \"undefined\" &&\r\n                rec[name]\r\n                  .toString()\r\n                  .toUpperCase()\r\n                  .startsWith(value) &&\r\n                list.indexOf(rec[name]) === -1\r\n              )\r\n                list.push(rec[name]);\r\n              if (list.length >= listCount) break;\r\n            }\r\n            list.sort();\r\n          }\r\n          this.autocompleteSelect = list.findIndex((element) =>\r\n            element.toUpperCase().includes(value)\r\n          );\r\n          this.autocompleteInputs = list;\r\n          const rect = this.currentCell.getBoundingClientRect();\r\n          this.lazy(() => {\r\n            if (!this.$refs.autocomplete) return;\r\n            this.$refs.autocomplete.style.minWidth = rect.width + \"px\";\r\n            const r = this.$refs.autocomplete.getBoundingClientRect();\r\n            if (rect.bottom + r.height > window.innerHeight) {\r\n              // show at top\r\n              this.autocompleteInputs.reverse();\r\n              this.autocompleteSelect =\r\n                this.autocompleteInputs.length - this.autocompleteSelect - 1;\r\n              this.$refs.autocomplete.style.top = rect.top - r.height + \"px\";\r\n            } else {\r\n              this.$refs.autocomplete.style.top = rect.bottom + \"px\";\r\n            }\r\n            if (rect.left + r.width > window.innerWidth)\r\n              this.$refs.autocomplete.style.top =\r\n                window.innerWidth - r.width + \"px\";\r\n            else this.$refs.autocomplete.style.left = rect.left + \"px\";\r\n            const showTop = this.autocompleteSelect * 23 - 206;\r\n            this.$refs.autocomplete.scrollTop = showTop > 0 ? showTop : 0;\r\n          });\r\n          return this.autocompleteSelect;\r\n        };\r\n        if (force) doList();\r\n        else this.lazy(doList, 700);\r\n      }\r\n    },\r\n    inputAutocompleteText(text, e) {\r\n      if (e) e.preventDefault();\r\n      this.autocompleteInputs = [];\r\n      this.autocompleteSelect = -1;\r\n      this.inputBoxShow = 0;\r\n      this.inputBoxChanged = false;\r\n      setTimeout(() => {\r\n        this.inputCellWrite(text);\r\n      });\r\n    },\r\n\r\n    /* *** Helper ****************************************************************************************\r\n     */\r\n    tempKey() {\r\n      return (\r\n        (new Date().getTime() % 1e8) +\r\n        \"-\" +\r\n        Math.random()\r\n          .toString()\r\n          .slice(2, 7)\r\n      );\r\n    },\r\n    hashCode(s) {\r\n      return s.split(\"\").reduce((a, b) => {\r\n        return (a = ((a << 5) - a + b.charCodeAt(0)) | 0);\r\n      }, 0);\r\n    },\r\n    lazy(p, delay, p1) {\r\n      if (typeof p !== \"function\") return this.lazyBuf(p, delay, p1);\r\n      if (!delay) delay = 20;\r\n      const hash = this.hashCode(p.name + p.toString());\r\n      if (this.lazyTimeout[hash]) clearTimeout(this.lazyTimeout[hash]);\r\n      this.lazyTimeout[hash] = setTimeout(() => {\r\n        p();\r\n        delete this.lazyTimeout[hash];\r\n      }, delay);\r\n    },\r\n    lazyBuf(item, p, delay) {\r\n      if (!delay) delay = 20;\r\n      const hash = this.hashCode(p.name + p.toString());\r\n      if (this.lazyBuffer[hash]) this.lazyBuffer[hash].push(item);\r\n      else this.lazyBuffer[hash] = [item];\r\n\r\n      if (this.lazyTimeout[hash]) clearTimeout(this.lazyTimeout[hash]);\r\n      this.lazyTimeout[hash] = setTimeout(() => {\r\n        Vue.nextTick(() => {\r\n          p(this.lazyBuffer[hash]);\r\n          delete this.lazyTimeout[hash];\r\n          delete this.lazyBuffer[hash];\r\n        });\r\n      }, delay);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\ninput:focus,\r\ninput:active:focus,\r\ninput.active:focus {\r\n  outline: none;\r\n  box-shadow: inset 0 -1px 0 #ddd;\r\n}\r\n*,\r\n*::before,\r\n*::after {\r\n  box-sizing: border-box;\r\n}\r\n.input-square {\r\n  position: absolute;\r\n  padding: 0;\r\n  z-index: 4;\r\n  border: 2px solid rgb(108, 143, 108);\r\n  /* transition: all 0.04s linear; */\r\n}\r\n.no-transition {\r\n  transition: none !important;\r\n}\r\n.autocomplete-results {\r\n  z-index: 15;\r\n  position: fixed;\r\n  padding: 3px;\r\n  margin: -1px;\r\n  background-color: lightyellow;\r\n  border: 1px solid rgb(108, 143, 108);\r\n  /*height: fit-content;*/\r\n  overflow-y: scroll;\r\n  font-size: 0.88rem;\r\n  max-width: 300px;\r\n  max-height: 235px;\r\n}\r\n.autocomplete-result {\r\n  list-style: none;\r\n  text-align: left;\r\n  padding: 4px 2px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  cursor: pointer;\r\n}\r\n.autocomplete-result.select {\r\n  background-color: lightsteelblue;\r\n}\r\n.rb-square {\r\n  width: 9px;\r\n  height: 9px;\r\n  border-top: 2px solid white;\r\n  border-left: 2px solid white;\r\n  border-bottom: 0;\r\n  border-right: 0;\r\n  background-color: rgb(108, 143, 108);\r\n  position: absolute;\r\n  bottom: -3px;\r\n  right: -2px;\r\n  cursor: crosshair;\r\n}\r\n.input-box {\r\n  opacity: 0;\r\n  font-family: inherit;\r\n  color: inherit;\r\n  text-shadow: inherit;\r\n  font-size: 0.88rem;\r\n  width: 100%;\r\n  height: 100%;\r\n  border: 0;\r\n  resize: none;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  background: white;\r\n}\r\n.component-content {\r\n  display: flex;\r\n  flex-flow: column;\r\n  position: relative;\r\n  max-width: fit-content;\r\n  word-spacing: 0.02rem;\r\n  line-height: 1.1;\r\n  overflow: hidden;\r\n  border: 1px solid lightgray;\r\n}\r\n.center-text {\r\n  text-align: center;\r\n}\r\n.table-content {\r\n  flex: 1 1 auto;\r\n  font-size: 1rem;\r\n  text-shadow: 0.3px 0.3px 1px #ccc;\r\n  overflow: scroll;\r\n  -webkit-touch-callout: none;\r\n  -webkit-user-select: none;\r\n  -khtml-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n  position: relative;\r\n  width: 100%;\r\n  scrollbar-width: none;\r\n}\r\n.table-content :focus {\r\n  outline: none;\r\n}\r\n.table-content::-webkit-scrollbar {\r\n  background: white;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n.table-content.no-footer {\r\n  border-bottom: 0;\r\n}\r\n.table-content.no-footer::-webkit-scrollbar {\r\n  height: 0;\r\n}\r\n.table-content::-webkit-scrollbar-thumb {\r\n  background: #eeee;\r\n}\r\n.table-content::-webkit-scrollbar-thumb:hover {\r\n  background: #9999;\r\n}\r\n.table-col-header {\r\n  cursor: text;\r\n}\r\n.systable {\r\n  z-index: -1;\r\n  width: fit-content;\r\n  border: 0;\r\n  border-collapse: separate;\r\n  border-spacing: 0;\r\n  /*\r\n  margin-bottom: -1px;\r\n  border-bottom: 1px solid lightgray;\r\n  */\r\n}\r\n.systable .last-col {\r\n  width: 12px;\r\n}\r\n.systable.no-number {\r\n  margin-left: 0 !important;\r\n}\r\n.systable tbody tr {\r\n  background-color: white;\r\n  text-align: left;\r\n}\r\n.systable tr.select td {\r\n  background-color: #bbb !important;\r\n}\r\n.systable th,\r\n.systable td {\r\n  vertical-align: bottom;\r\n  padding: 0.2rem 0.3rem;\r\n  font-size: 0.88rem;\r\n  height: 24px;\r\n  border-top: 0;\r\n  border-left: 0;\r\n}\r\n.systable th:not(:last-child) {\r\n  border-right: 1px solid lightgray;\r\n}\r\n.systable tbody td {\r\n  cursor: cell;\r\n  white-space: nowrap;\r\n  overflow-x: hidden;\r\n  text-overflow: ellipsis;\r\n  /* animation: fadein 0.2s; */\r\n}\r\n.systable.alt tbody td.link:hover {\r\n  color: blue;\r\n  text-decoration: underline;\r\n  cursor: pointer !important;\r\n}\r\n.systable tbody td.error {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAAAGZJREFUOBGlzjsOgDAMA9CwcQSO0PtP3K64Qyugv8S2ZMXTUw5DstmFk8qWAuhEbzSzbQ+oWIPKULAPpGAdxGJDiMGmUBRbQhFsC3kxF+TB3NAOC0ErLAzNMAoaYTT0xyTojclQxR5H5B1HhuS+WAAAAABJRU5ErkJggg==\") !important;\r\n  background-repeat: no-repeat !important;\r\n  background-size: 8px 8px !important;\r\n  background-position: right 0px top 0px !important;\r\n}\r\n.systable tbody tr:not(:last-child) td {\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n.systable tbody tr:last-child td {\r\n  border-bottom: 1px solid transparent;\r\n}\r\n.systable td:not(:last-child) {\r\n  border-right: 1px solid lightgray;\r\n}\r\n.systable thead th,\r\n.systable thead td {\r\n  padding: 0.4rem 0.3rem;\r\n  font-weight: 400;\r\n  top: 0;\r\n  height: 29px;\r\n  position: sticky;\r\n  z-index: 5;\r\n  border-bottom: 1px solid lightgray;\r\n}\r\n.systable thead th {\r\n  background-color: #e9ecef;\r\n  cursor: s-resize;\r\n  z-index: 6;\r\n}\r\n.systable thead td.column-filter {\r\n  text-align: left;\r\n  background-color: #fffff2;\r\n  white-space: nowrap;\r\n  overflow-x: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n.systable th.focus {\r\n  border-bottom: 1px solid rgb(61, 85, 61) !important;\r\n}\r\n.systable td.first-col.focus {\r\n  border-right: 1px solid rgb(61, 85, 61) !important;\r\n}\r\n.systable tbody td.select:not(.readonly) {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC\");\r\n  background-repeat: no-repeat;\r\n  background-size: 8px 8px;\r\n  background-position: right 5px top 8px;\r\n}\r\n.systable tbody td.datepick:not(.readonly) {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC\");\r\n  background-repeat: no-repeat;\r\n  background-size: 8px 8px;\r\n  background-position: right 5px top 8px;\r\n}\r\n.systable .first-col {\r\n  background: #e9ecef;\r\n  width: 40px;\r\n  position: sticky;\r\n  left: 0;\r\n  top: auto;\r\n  cursor: e-resize !important;\r\n  text-overflow: inherit !important;\r\n  text-align: center;\r\n  padding-left: 0;\r\n  padding-right: 0;\r\n  overflow: hidden;\r\n  z-index: 5;\r\n}\r\n.systable .sticky-column {\r\n  position: sticky;\r\n  z-index: 2;\r\n}\r\n.systable tbody td.sticky-column {\r\n  background-color: white;\r\n}\r\n.systable thead th.sticky-column {\r\n  z-index: 7;\r\n}\r\n.systable thead td.sticky-column {\r\n  z-index: 6;\r\n}\r\n.systable thead td.first-col,\r\n.systable thead th.first-col {\r\n  cursor: pointer !important;\r\n  z-index: 10;\r\n}\r\n.systable tfoot .row-summary {\r\n  height: 25px;\r\n  border-right: 0;\r\n  border-top: 1px solid lightgray;\r\n  position: sticky;\r\n  bottom: 0;\r\n  z-index: 4;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  background: #fffff2;\r\n}\r\n.systable tfoot .row-summary.sticky-column {\r\n  z-index: 5;\r\n}\r\n.systable tfoot .row-summary.summary-column1 {\r\n  border-right: 1px solid lightgray;\r\n}\r\n.systable tfoot .row-summary.summary-column2 {\r\n  border-right: 1px solid lightgray;\r\n  background: white;\r\n}\r\n.systable tfoot .row-summary:last-child {\r\n  border-right: 0 !important;\r\n}\r\n.systable tfoot .row-summary.first-col {\r\n  height: 25px;\r\n  border-top: 1px solid lightgray;\r\n  border-right: 1px solid lightgray;\r\n  background: #e9ecef;\r\n  position: sticky;\r\n  left: 0;\r\n  top: auto;\r\n  z-index: 6;\r\n}\r\n.footer {\r\n  z-index: 5;\r\n  padding: 0;\r\n  font-size: 12px;\r\n  color: dimgray;\r\n  background-color: white;\r\n  width: 100%;\r\n  height: 25px;\r\n  line-height: 2.3;\r\n  border-top: 1px solid lightgray;\r\n  user-select: none;\r\n}\r\n.footer .left-block {\r\n  position: absolute;\r\n  left: 0;\r\n  height: 25px;\r\n  width: 40px;\r\n  background-color: #e9ecef;\r\n  border-right: 1px solid lightgray;\r\n}\r\n.h-scroll {\r\n  z-index: -1;\r\n  position: absolute;\r\n  background-color: #f4f6f9;\r\n  height: 25px;\r\n  margin-left: 40px;\r\n  width: 65%;\r\n  cursor: pointer;\r\n}\r\n.h-scroll:hover,\r\n.h-scroll.focus,\r\n.footer:hover .h-scroll {\r\n  background-color: lightgray;\r\n}\r\n\r\n.footer a {\r\n  cursor: pointer;\r\n  color: #007bff;\r\n}\r\n.footer a.disabled {\r\n  cursor: not-allowed;\r\n  color: gray;\r\n  pointer-events: none;\r\n}\r\n.footer a:hover {\r\n  text-decoration: underline;\r\n}\r\n.v-scroll {\r\n  display: inline-block;\r\n  position: absolute;\r\n  right: 0;\r\n  width: 13px;\r\n  z-index: 5;\r\n  background-color: white;\r\n  border-left: 1px solid lightgray;\r\n  user-select: none;\r\n}\r\n.v-scroll-button {\r\n  position: relative;\r\n  display: inline-block;\r\n  width: 100%;\r\n  z-index: 10;\r\n  background-color: #f4f6f9;\r\n  cursor: pointer;\r\n}\r\n.v-scroll-button.focus,\r\n.v-scroll-button:hover,\r\n.v-scroll:hover .v-scroll-button {\r\n  background-color: lightgray;\r\n}\r\n.runner {\r\n  font-size: 0.88rem;\r\n  padding: 0.5rem;\r\n  position: absolute;\r\n  right: 23px;\r\n  top: 4px;\r\n  display: inline-block;\r\n  width: fit-content;\r\n  z-index: 10;\r\n  background-color: #e9ecef;\r\n  border-radius: 3px;\r\n  white-space: nowrap;\r\n}\r\n.runner:before {\r\n  content: \"\";\r\n  display: block;\r\n  width: 0;\r\n  height: 0;\r\n  position: absolute;\r\n  border-top: 4px solid transparent;\r\n  border-bottom: 8px solid transparent;\r\n  border-left: 8px solid #e9ecef;\r\n  right: -8px;\r\n  top: 4px;\r\n}\r\n\r\n.front-drop {\r\n  position: fixed;\r\n  opacity: 0.4;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: #55555555;\r\n  color: white;\r\n  z-index: 1000;\r\n}\r\na:disabled {\r\n  cursor: not-allowed;\r\n  color: gray;\r\n  pointer-events: none;\r\n}\r\n.col-sep {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  border-right: 5px solid transparent;\r\n  width: 5px;\r\n  cursor: col-resize;\r\n  height: 100%;\r\n  z-index: 15;\r\n}\r\n.add-col-btn {\r\n  display: none;\r\n  position: absolute;\r\n  top: 12px;\r\n  right: 8px;\r\n  width: 20px;\r\n  height: 20px;\r\n  background-color: #2222;\r\n  z-index: 15;\r\n  border: solid 1px #2222;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  color: white;\r\n}\r\n.add-col-btn:hover {\r\n  background-color: #7777;\r\n}\r\n.sort-asc-sign {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAMAAADzN3VRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAeUExURQAAAK+np6+qqq+rq62pqa+rq6+rq6+srK+rq6+rq2v5ERwAAAAJdFJOUwAgYHCAv8/f71KXockAAAAJcEhZcwAAFxEAABcRAcom8z8AAABNSURBVChT7clRAoAgCATRtTLq/hcuBEN0j9B8zoNV76j6s37hsh+a+NWknQ3l8pGTAk4KlAwIdVgoYKIREmUYaIaPVnBi0IjDS2cA8AC8JAq/VhDqzAAAAABJRU5ErkJggg==\");\r\n  background-repeat: no-repeat;\r\n  background-size: 9px 9px;\r\n  background-position: right 5px top 3px;\r\n}\r\n.sort-des-sign {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAYCAMAAAA4a6b0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAkUExURQAAAK+np6+qqq+rq6+pqa+qqq+rq6+rq6+rq6+srK+rq6+rqzDc2iQAAAALdFJOUwAgMEBQYHC/z9/v4u0IugAAAAlwSFlzAAAXEQAAFxEByibzPwAAAFVJREFUKFPtyVEWgCAIRFHC1HL2v98o53SEWELvC+bK0nYor5CeGCkZICUdBhkRjAoX9oLlqCzgyAOwc5caAKgT2gdIGQDNgGfM6Knzv+vcZr8kInIBUrIMxVKQeVsAAAAASUVORK5CYII=\");\r\n  background-repeat: no-repeat;\r\n  background-size: 9px 9px;\r\n  background-position: right 5px top 3px;\r\n}\r\n.filter-sign {\r\n  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAlCAMAAABiU6n+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAhUExURQAAAK+vr6+np6+qqq+pqa+qqq2pqa+srK+srK+rq6+rq01/tHwAAAAKdFJOUwAQIDBQYICv3+8SoWj4AAAACXBIWXMAABcRAAAXEQHKJvM/AAAAiUlEQVQ4T+3OOxaAMAhEUfwmsv8FazLjMRBiZ+er4ExzJelLSSZeUccisvMO2uUq8+nKU5lXfl1bWWWkS1gHuuJCoa66UKCDCwU6ulCnu13I6x4XcrrGhYyudSGjMy7U6KwLPTrvQhwDV42jaueqcVTl7+L4zzaO386Zv+teZ/6u9xXzcK2zXUVOdLIT4IImCksAAAAASUVORK5CYII=\");\r\n  background-repeat: no-repeat;\r\n  background-size: 9px 9px;\r\n  background-position: right 0px bottom 0px;\r\n}\r\n.hide {\r\n  display: none !important;\r\n}\r\n@keyframes fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n.fa-spin {\r\n  -webkit-animation: fa-spin 2s infinite linear;\r\n  animation: fa-spin 2s infinite linear;\r\n}\r\n.svg-inline--fa.fa-w-14 {\r\n  width: 0.875em;\r\n}\r\n.svg-inline--fa.fa-w-16 {\r\n  width: 1em;\r\n}\r\n.svg-inline--fa.fa-fw {\r\n  width: 1.25em;\r\n}\r\n.svg-inline--fa {\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  height: 1em;\r\n  overflow: visible;\r\n  vertical-align: -0.125em;\r\n}\r\n.fa-fw {\r\n  text-align: center;\r\n  width: 1.25em;\r\n}\r\n.fa-xs {\r\n  font-size: 0.75em;\r\n}\r\n.fa-sm {\r\n  font-size: 0.875em;\r\n}\r\n.fa-3x {\r\n  font-size: 3em;\r\n}\r\n.tool-tip {\r\n  display: inline-block;\r\n  position: fixed;\r\n  color: white;\r\n  background-color: red;\r\n  padding: 0.5rem;\r\n  min-height: 1rem;\r\n  max-width: 200px;\r\n  word-wrap: break-word;\r\n  border-radius: 4px;\r\n  z-index: 50;\r\n}\r\n.tool-tip:before {\r\n  content: \"\";\r\n  display: block;\r\n  width: 0;\r\n  height: 0;\r\n  position: absolute;\r\n  border-top: 8px solid transparent;\r\n  border-bottom: 8px solid transparent;\r\n  border-right: 8px solid red;\r\n  left: -8px;\r\n  top: 8px;\r\n}\r\n.norecord {\r\n  z-index: 1;\r\n  font-size: smaller;\r\n  position: absolute;\r\n  left: 50%;\r\n  transform: translate(-50%, 0%);\r\n}\r\n</style>\r\n"]},media:void 0})},od,"data-v-1f0c18b7",!1,void 0,!1,zi,void 0,void 0);/* scoped */var ld={props:{field:{type:String,default:""},label:{type:String,default:null},type:{type:String,default:"string"},initStyle:{type:Object,default(){return{}}},width:{type:String,default:"100px"},invisible:{type:Boolean,default:!1},readonly:{type:Boolean,default:null},textTransform:{type:String,default:null},textAlign:{type:String,default:null},keyField:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},validate:{type:Function,default:null},change:{type:Function,default:null},link:{type:Function,default:null},allowKeys:{type:[Array,Function],default(){return null}},mandatory:{type:String,default:""},lengthLimit:{type:Number,default:0},autocomplete:{type:Boolean,default:null},pos:{type:Number,default:0},options:{type:[Array,Object,Function],default(){return null}},summary:{type:String,default:null},sort:{type:Function,default:null},toValue:{type:Function,default(e){switch(this.textTransform){case"uppercase":e=e.toUpperCase();break;case"lowercase":e=e.toLowerCase();}switch(this.type){case"datetick":return i(e,"YYYY-MM-DD").valueOf();case"datetimetick":return i(e,"YYYY-MM-DD HH:mm").valueOf();case"datetimesectick":return i(e,"YYYY-MM-DD HH:mm:ss").valueOf();case"check10":case"checkYN":case"checkTF":return e.toUpperCase();case"map":if(this.options.constructor.name.endsWith("Function")){const t=this.options(e);return Object.keys(t).find(o=>t[o]===e)}return Object.keys(this.options).find(t=>this.options[t]===e);default:return e;}}},toText:{type:Function,default(e){if(this.keyField&&e&&e.toString().startsWith("\xA7"))return"";switch(this.type){case"date":return e?i(e).format("YYYY-MM-DD"):"";case"datetick":return e?i(+e).format("YYYY-MM-DD"):"";case"datetimetick":return e?i(+e).format("YYYY-MM-DD HH:mm"):"";case"datetimesectick":return e?e?i(+e).format("YYYY-MM-DD HH:mm:ss"):"":"";case"map":return this.options.constructor.name.endsWith("Function")?this.options(e)[e]:this.options[e];default:return e;}}},register:{type:Function,default:null}},created(){this.init()},methods:{init(){const e=this;let t=this.initStyle,o=this.validate,a=this.allowKeys,l=this.lengthLimit;switch(this.type){case"number":t.textAlign="right",a=a||["0","1","2","3","4","5","6","7","8","9",".","-"];break;case"date":a=a||["0","1","2","3","4","5","6","7","8","9","-"],o||(o=e=>""===e?"":i(e,"YYYY-MM-DD",!0).isValid()?"":this.$parent.localizedLabel.invalidInputValue);break;case"datetime":a=a||["0","1","2","3","4","5","6","7","8","9","-"," ",":"],o||(o=e=>""===e?"":i(e,"YY-MM-DD hh:mm",!0).isValid()?"":this.$parent.localizedLabel.invalidInputValue);break;case"datetimesec":a=a||["0","1","2","3","4","5","6","7","8","9","-"," ",":"],o||(o=e=>""===e?"":i(e,"YY-MM-DD hh:mm:ss",!0).isValid()?"":this.$parent.localizedLabel.invalidInputValue);break;case"datetick":a=a||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"datetimetick":a=a||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"datetimesectick":a=a||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"check10":t.textAlign="center",t.textTransform="uppercase",a=a||["0","1"],l=l||1;break;case"checkYN":t.textAlign="center",t.textTransform="uppercase",a=a||["Y","N"],l=l||1;break;case"checkTF":t.textAlign="center",t.textTransform="uppercase",a=a||["T","F"],l=l||1;break;case"map":if("AsyncFunction"===this.options.constructor.name)throw new Error("VueExcelColumn: Map does not support Async Function");break;case"select":break;case"string":break;default:throw new Error("VueExcelColumn: Not supported type:"+this.type);}this.textTransform&&(t.textTransform=this.textTransform),this.textAlign&&(t.textAlign=this.textAlign),this._autocomplete=e.autocomplete,this._readonly=e.readonly,this.$parent.registerColumn({name:this.field,label:null===this.label?this.field:this.label,type:this.type,width:this.width,validate:o,change:this.change,link:this.link,sort:this.sort,keyField:this.keyField,sticky:this.sticky,allowKeys:a,mandatory:this.mandatory,lengthLimit:+l,textTransform:this.textTransform,get autocomplete(){return null===e._autocomplete?e.$parent.autocomplete:e._autocomplete},set autocomplete(t){e._autocomplete=t},initStyle:t,invisible:this.invisible,get readonly(){return null===e._readonly?e.$parent.readonly:e._readonly},set readonly(t){e._readonly=t},pos:+this.pos,options:this.options,summary:this.summary,toValue:this.toValue,toText:this.toText,register:this.register})}}};/* script */ /* template */var nd=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e._t("default")],2)};nd._withStripped=!0;/* style */const sd=/*#__PURE__*/Fi({render:nd,staticRenderFns:[]},void 0,ld,void 0,!1,void 0,!1,void 0,void 0,void 0);/* scoped */return e.default={install(e){e.component("vue-excel-editor",ad),e.component("vue-excel-column",sd),e.mixin({created(){}})}},e}({},vuedraggable,XLSX,moment);
